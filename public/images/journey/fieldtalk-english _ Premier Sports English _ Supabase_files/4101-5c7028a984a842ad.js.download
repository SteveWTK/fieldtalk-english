try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="73f0e839-21ad-4ce6-ae0d-1be98b63ea87",e._sentryDebugIdIdentifier="sentry-dbid-73f0e839-21ad-4ce6-ae0d-1be98b63ea87")}()}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4101],{10021:(e,t,a)=>{a.d(t,{OJ:()=>j,Pl:()=>S,Pq:()=>g,Q5:()=>M,RK:()=>_,a0:()=>w,ag:()=>k,hm:()=>y,i9:()=>N,qP:()=>b,ue:()=>v});var n=a(80263),l=a(72343),r=a(21749),s=a(27969),i=a(24572),o=a(93749),c=a.n(o),d=a(53239),u=a(76602),m=a(80127),p=a(68872),h=a(20838),x=a(64495),f=a(35741);let y=(0,d.forwardRef)((e,t)=>{let{...a}=e;return(0,n.jsx)(u.Nt,{ref:t,...a,className:(0,m.cn)("w-full px-2 group",a.className)})}),g=(0,d.forwardRef)((e,t)=>{let{...a}=e;return(0,n.jsxs)(u.R6,{ref:t,...a,className:(0,m.cn)("w-full flex gap-1 items-center group px-3 text-sm font-normal font-mono uppercase text-lighter tracking-wide",a.className),children:[(0,n.jsx)(l.A,{className:"transition-all text-foreground-muted group-data-[state=open]:rotate-90",size:16,strokeWidth:1.5}),(0,n.jsx)("span",{className:"group-hover:not-disabled:text-foreground",children:a.title})]})}),b=(0,d.forwardRef)((e,t)=>{let{...a}=e;return(0,n.jsx)(u.Ke,{ref:t,...a,className:(0,m.cn)("w-full flex flex-col gap-0",a.className)})}),j=(0,d.forwardRef)((e,t)=>(0,n.jsx)("div",{ref:t,...e,className:(0,m.cn)("h-px bg-border-muted",e.className)})),v=(0,d.forwardRef)((e,t)=>{let{className:a,isActive:l,forceHoverState:r,...s}=e;return(0,n.jsx)(c(),{ref:t,...s,"aria-current":l,className:(0,m.cn)("text-sm","h-7 pl-3 pr-2","flex items-center justify-between rounded-md group relative",l?"bg-selection":"hover:bg-surface-200",r&&"bg-surface-200",l?"text-foreground":"text-foreground-light hover:text-foreground",a)})}),k=(0,d.forwardRef)((e,t)=>{let{isActive:a=!0,forceHoverState:l,isPreview:r,isOpened:s=!0,...i}=e;return(0,n.jsxs)(c(),{ref:t,...i,"aria-current":a,className:(0,m.cn)((0,p.u2)({isSelected:a&&!r,isOpened:s&&!r,isPreview:r}),"px-4",i.className),children:[!r&&a&&(0,n.jsx)("div",{className:"absolute left-0 h-full w-0.5 bg-foreground"}),i.children]})}),w=(0,d.forwardRef)((e,t)=>(0,n.jsx)("div",{ref:t,...e,className:(0,m.cn)("flex px-2 gap-2 items-center",e.className)})),_=(0,d.forwardRef)((e,t)=>{let{children:a,isLoading:l=!1,...i}=e;return(0,n.jsxs)("label",{htmlFor:i.name,className:"relative w-full",children:[(0,n.jsx)("span",{className:"sr-only",children:i["aria-labelledby"]}),(0,n.jsx)(h.p,{ref:t,type:"text",className:(0,m.cn)("h-[32px] md:h-[28px] w-full","text-base md:text-xs","pl-7","pr-7","w-full","rounded",i.className),...i}),a,l?(0,n.jsx)(r.A,{className:"animate-spin absolute left-2 text-foreground-muted",style:{top:7},size:14,strokeWidth:1.5}):(0,n.jsx)(s.A,{className:"absolute left-2 top-2 text-foreground-muted",size:14,strokeWidth:1.5})]})}),N=(0,d.forwardRef)((e,t)=>{let{value:a,onValueChange:l,contentClassName:r,triggerClassName:s,...o}=e;return(0,n.jsxs)(x.rI,{modal:!1,children:[(0,n.jsxs)(f.m_,{delayDuration:0,children:[(0,n.jsx)(x.ty,{asChild:!0,className:(0,m.cn)("absolute right-1 top-[.4rem] md:top-[.3rem]","text-foreground transition-colors hover:text-foreground data-[state=open]:text-foreground",s),children:(0,n.jsx)(f.k$,{children:(0,n.jsx)(i.A,{size:18,strokeWidth:1})})}),(0,n.jsx)(f.ZI,{side:"bottom",children:"Sort By"})]}),(0,n.jsx)(x.SQ,{side:"bottom",align:"end",className:(0,m.cn)("w-48",r),children:(0,n.jsx)(x.Hr,{value:a,onValueChange:l,children:o.children})})]})}),S=(0,d.forwardRef)((e,t)=>(0,n.jsx)(x.Ht,{ref:t,...e})),M=(0,d.forwardRef)((e,t)=>{let{illustration:a,title:l,description:r,actions:s,...i}=e;return(0,n.jsx)("div",{ref:t,...i,className:(0,m.cn)("border border-muted bg-surface-100 dark:bg-surface-75 flex flex-col gap-y-3 items-center justify-center rounded-md px-5 py-4",i.className),children:(0,n.jsxs)("div",{className:"w-full flex flex-col gap-y-1 items-center",children:[a,l&&(0,n.jsx)("p",{className:"text-xs text-foreground-light",children:l}),r&&(0,n.jsx)("p",{className:"text-xs text-foreground-lighter text-center",children:r}),s&&(0,n.jsx)("div",{className:"mt-2",children:s}),i.children]})})})},14101:(e,t,a)=>{a.d(t,{A:()=>eA});var n=a(80263),l=a(53239),r=a(93749),s=a.n(r),i=a(67908),o=a(46491),c=a(32981),d=a(52793),u=a.n(d),m=a(96196),p=a(83759),h=a(87494),x=a(73969),f=a(19686),y=a(28320),g=a(15378),b=a(89422),j=a(68061),v=a(32144),k=a(80251),w=a(70938),_=a(89357);async function N(e){let{projectRef:t,id:a,type:n,isPublic:l,file_size_limit:r,allowed_mime_types:s}=e;if(!t)throw Error("projectRef is required");if(!a)throw Error("Bucket name is required");let i={id:a,type:n,public:l};"STANDARD"===n&&(r&&(i.file_size_limit=r),s&&(i.allowed_mime_types=s));let{data:o,error:c}=await (0,w.bE)("/platform/storage/{ref}/buckets",{params:{path:{ref:t}},body:i});return c&&(0,w.H4)(c),o}let S=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,v.jE)();return(0,k.n)(e=>N(e),{async onSuccess(t,a,l){let{projectRef:r}=a;await n.invalidateQueries(_.w.buckets(r)),await (null==e?void 0:e(t,a,l))},async onError(e,a,n){void 0===t?x.oR.error("Failed to create bucket: ".concat(e.message)):t(e,a,n)},...a})};var M=a(65321),A=a(86992),C=a(52445),B=a(74144),E=a(19506),z=a(20704),T=a(20838),R=a(9794),D=a(68506),I=a(75118),P=a(76602),F=a(80127),L=a(59130),q=a(77376),O=a(38112),G=a(22554),Y=a(50922),U=a(57374),H=a(8926),W=a(84558),Q=a(60045),J=a(89878),V=a(75831);let $=f.Ay.object({name:f.Ay.string().trim().min(1,"Please provide a name for your bucket").max(100,"Bucket name should be below 100 characters").refine(e=>!e.endsWith(" "),"The name of the bucket cannot end with a whitespace").refine(e=>"public"!==e,'"public" is a reserved name. Please choose another name'),type:f.Ay.enum(["STANDARD","ANALYTICS"]).default("STANDARD"),public:f.Ay.boolean().default(!1),has_file_size_limit:f.Ay.boolean().default(!1),formatted_size_limit:f.Ay.coerce.number().min(0,"File size upload limit has to be at least 0").default(0),allowed_mime_types:f.Ay.string().trim().default("")}).superRefine((e,t)=>{if(!H.Bt.test(e.name)){var a;let[n]=null!=(a=e.name.match(H.$P))?a:[];t.addIssue({path:["name"],code:f.Ay.ZodIssueCode.custom,message:n?'Bucket name cannot contain the "'.concat(n,'" character'):"Bucket name contains an invalid special character"})}}),Z="create-storage-bucket-form",K=()=>{var e,t,a;let[r,d]=(0,l.useState)(!1),{ref:f}=(0,o.g)(),{data:v}=(0,C.s)(),{mutate:k}=(0,A.h)(),w=(0,i.useRouter)(),{can:_}=(0,V.hl)(Q.aG.STORAGE_WRITE,"*"),{mutateAsync:N,isLoading:H}=S({onError:()=>{}}),{mutateAsync:K,isLoading:X}=(0,M.Z)(),{data:ee}=(0,j.I)({projectRef:f},{enabled:B.pe}),{value:et,unit:ea}=(0,J.Jb)(null!=(a=null==ee?void 0:ee.fileSizeLimit)?a:0),en="".concat(et," ").concat(ea),[el,er]=(0,l.useState)(g.s2.BYTES),[es,ei]=(0,l.useState)(!1),eo=(0,h.mN)({resolver:(0,c.u)($),defaultValues:{name:"",public:!1,type:"STANDARD",has_file_size_limit:!1,formatted_size_limit:0,allowed_mime_types:""}}),ec=u()(eo.watch("name")),ed=eo.watch("public"),eu="STANDARD"===eo.watch("type"),em=eo.watch("has_file_size_limit"),ep=eo.watch("formatted_size_limit"),eh=(0,y.P)(),ex=null==ee||null==(t=ee.features)||null==(e=t.icebergCatalog)?void 0:e.enabled,ef=async e=>{if(!f)return console.error("Project ref is required");if("ANALYTICS"===e.type&&!ex)return void x.oR.error("The Analytics catalog feature is not enabled for your project. Please contact support to enable it.");try{var t;let a=e.has_file_size_limit?(0,J.OG)(e.formatted_size_limit,el):void 0,n=e.allowed_mime_types.length>0?e.allowed_mime_types.split(",").map(e=>e.trim()):void 0;await N({projectRef:f,id:e.name,type:e.type,isPublic:e.public,file_size_limit:a,allowed_mime_types:n}),k({action:"storage_bucket_created",properties:{bucketType:e.type},groups:{project:null!=f?f:"Unknown",organization:null!=(t=null==v?void 0:v.slug)?t:"Unknown"}}),"ANALYTICS"===e.type&&"installed"===eh&&await K({bucketName:e.name}),eo.reset(),er(g.s2.BYTES),ei(!1),d(!1),x.oR.success("Successfully created bucket ".concat(e.name)),w.push("/project/".concat(f,"/storage/buckets/").concat(e.name))}catch(e){console.error(e),x.oR.error("Failed to create bucket")}},ey=()=>{eo.reset(),er(g.s2.BYTES),ei(!1),d(!1)};return(0,n.jsxs)(E.lG,{open:r,onOpenChange:e=>{e||ey()},"data-sentry-element":"Dialog","data-sentry-component":"CreateBucketModal","data-sentry-source-file":"CreateBucketModal.tsx",children:[(0,n.jsx)(E.zM,{asChild:!0,"data-sentry-element":"DialogTrigger","data-sentry-source-file":"CreateBucketModal.tsx",children:(0,n.jsx)(W.G,{block:!0,type:"default",icon:(0,n.jsx)(m.A,{}),disabled:!_,style:{justifyContent:"start"},onClick:()=>d(!0),tooltip:{content:{side:"bottom",text:_?void 0:"You need additional permissions to create buckets"}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"CreateBucketModal.tsx",children:"New bucket"})}),(0,n.jsxs)(E.Cf,{"data-sentry-element":"DialogContent","data-sentry-source-file":"CreateBucketModal.tsx",children:[(0,n.jsx)(E.c7,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"CreateBucketModal.tsx",children:(0,n.jsx)(E.L3,{"data-sentry-element":"DialogTitle","data-sentry-source-file":"CreateBucketModal.tsx",children:"Create storage bucket"})}),(0,n.jsx)(E.pf,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"CreateBucketModal.tsx"}),(0,n.jsx)(E.OO,{"data-sentry-element":"DialogSection","data-sentry-source-file":"CreateBucketModal.tsx",children:(0,n.jsx)(z.lV,{...eo,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"CreateBucketModal.tsx",children:(0,n.jsxs)("form",{id:Z,className:"flex flex-col gap-4",onSubmit:eo.handleSubmit(ef),children:[(0,n.jsx)(z.zB,{name:"name",control:eo.control,render:e=>{let{field:t}=e;return(0,n.jsx)(U.M,{name:"name",label:"Name of bucket",labelOptional:"Buckets cannot be renamed once created.",children:(0,n.jsx)(z.MJ,{children:(0,n.jsx)(T.p,{id:"name",...t,placeholder:"Enter bucket name"})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreateBucketModal.tsx"},"name"),(0,n.jsx)(z.zB,{name:"type",control:eo.control,render:e=>{let{field:t}=e;return(0,n.jsx)(U.M,{label:"Bucket type",children:(0,n.jsx)(z.MJ,{children:(0,n.jsxs)(R.s,{id:"type",value:t.value,onValueChange:e=>t.onChange(e),children:[(0,n.jsx)(R.v,{id:"STANDARD",value:"STANDARD",label:"Standard bucket",description:"Compatible with S3 buckets.",showIndicator:!1}),B.pe&&(0,n.jsx)(R.v,{id:"ANALYTICS",value:"ANALYTICS",label:"Analytics bucket",showIndicator:!1,disabled:!ex,children:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"text-foreground-light text-left",children:"Stores Iceberg files and is optimized for analytical workloads."}),ex?null:(0,n.jsxs)("div",{className:"w-full flex gap-x-2 py-2 items-center",children:[(0,n.jsx)(D.id,{}),(0,n.jsxs)("span",{className:"text-xs text-left",children:["This feature is currently in alpha and not yet enabled for your project. Sign up"," ",(0,n.jsx)(b.g,{href:"https://forms.supabase.com/analytics-buckets",children:"here"}),"."]})]})]})})]})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreateBucketModal.tsx"},"type"),(0,n.jsx)(E.pf,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"CreateBucketModal.tsx"}),eu?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(z.zB,{name:"public",control:eo.control,render:e=>{let{field:t}=e;return(0,n.jsx)(U.M,{name:"public",label:"Public bucket",description:"Anyone can read any object without any authorization",layout:"flex",children:(0,n.jsx)(z.MJ,{children:(0,n.jsx)(I.d,{id:"public",size:"large",checked:t.value,onCheckedChange:t.onChange})})})}},"public"),ed&&(0,n.jsx)(Y.Z,{type:"warning",className:"rounded-none border-x-0 border-b-0 mb-0 pb-0 px-0 [&>svg]:left-0 [&>div>p]:!leading-normal",title:"Public buckets are not protected",description:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"mb-2",children:"Users can read objects in public buckets without any authorization."}),(0,n.jsx)("p",{children:"Row level security (RLS) policies are still required for other operations such as object uploads and deletes."})]})}),(0,n.jsxs)(P.Nt,{open:es,onOpenChange:()=>ei(!es),children:[(0,n.jsx)(P.R6,{asChild:!0,children:(0,n.jsxs)("button",{className:"w-full cursor-pointer py-3 flex items-center justify-between border-t border-default",children:[(0,n.jsx)("p",{className:"text-sm",children:"Additional configuration"}),(0,n.jsx)(p.A,{size:18,strokeWidth:2,className:(0,F.cn)("text-foreground-light",es&&"rotate-180")})]})}),(0,n.jsxs)(P.Ke,{className:"py-4 space-y-4",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(z.zB,{name:"has_file_size_limit",control:eo.control,render:e=>{let{field:t}=e;return(0,n.jsx)(U.M,{name:"has_file_size_limit",label:"Restrict file upload size for bucket",description:"Prevent uploading of file sizes greater than a specified limit",layout:"flex",children:(0,n.jsx)(z.MJ,{children:(0,n.jsx)(I.d,{id:"has_file_size_limit",size:"large",checked:t.value,onCheckedChange:t.onChange})})})}},"has_file_size_limit"),em&&(0,n.jsxs)("div",{className:"grid grid-cols-12 col-span-12 gap-x-2 gap-y-1",children:[(0,n.jsx)("div",{className:"col-span-8",children:(0,n.jsx)(z.zB,{name:"formatted_size_limit",control:eo.control,render:e=>{let{field:t}=e;return(0,n.jsx)(U.M,{name:"formatted_size_limit",description:"Equivalent to ".concat((0,J.OG)(ep,el).toLocaleString()," bytes."),children:(0,n.jsx)(z.MJ,{children:(0,n.jsx)(T.p,{id:"formatted_size_limit","aria-label":"File size limit",type:"number",min:0,...t})})})}},"formatted_size_limit")}),(0,n.jsxs)(L.l6,{value:el,onValueChange:er,children:[(0,n.jsx)(L.bq,{"aria-label":"File size limit unit",size:"small",className:"col-span-4",children:(0,n.jsx)(L.yv,{asChild:!0,children:(0,n.jsx)(n.Fragment,{children:el})})}),(0,n.jsx)(L.gC,{children:Object.values(g.s2).map(e=>(0,n.jsx)(L.eb,{value:e,className:"text-xs",children:(0,n.jsx)("div",{children:e})},e))})]}),B.pe&&(0,n.jsx)("div",{className:"col-span-12",children:(0,n.jsxs)("p",{className:"text-foreground-light text-sm",children:["Note: Individual bucket uploads will still be capped at the"," ",(0,n.jsx)(s(),{href:"/project/".concat(f,"/settings/storage"),className:"font-bold underline",children:"global upload limit"})," ","of ",en]})})]})]}),(0,n.jsx)(z.zB,{name:"allowed_mime_types",control:eo.control,render:e=>{let{field:t}=e;return(0,n.jsx)(U.M,{name:"allowed_mime_types",label:"Allowed MIME types",labelOptional:"Comma separated values",description:"Wildcards are allowed, e.g. image/*. Leave blank to allow any MIME type.",children:(0,n.jsx)(z.MJ,{children:(0,n.jsx)(T.p,{id:"allowed_mime_types",...t,placeholder:"e.g image/jpeg, image/png, audio/mpeg, video/mp4, etc"})})})}},"allowed_mime_types")]})]})]}):(0,n.jsx)(n.Fragment,{children:"installed"===eh?(0,n.jsxs)(q.J,{className:"text-foreground-lighter leading-1 flex flex-col gap-y-2",children:[(0,n.jsxs)("p",{children:[(0,n.jsx)("span",{children:"Supabase will setup a "}),(0,n.jsxs)("a",{href:"".concat(B.o2,"/project/").concat(f,"/integrations/iceberg_wrapper/overview"),target:"_blank",className:"underline text-foreground-light",children:["foreign data wrapper",ec&&(0,n.jsxs)("span",{className:"text-brand",children:[" ","".concat(ec,"_fdw")]})]}),(0,n.jsxs)("span",{children:[" ","for easier access to the data. This action will also create"," ",(0,n.jsxs)("a",{href:"".concat(B.o2,"/project/").concat(f,"/storage/access-keys"),target:"_blank",className:"underline text-foreground-light",children:["S3 Access Keys",ec&&(0,n.jsxs)(n.Fragment,{children:[" ","named ",(0,n.jsxs)("span",{className:"text-brand",children:[" ","".concat(ec,"_keys")]})]})]}),(0,n.jsx)("span",{children:" and "}),(0,n.jsxs)("a",{href:"".concat(B.o2,"/project/").concat(f,"/integrations/vault/secrets"),target:"_blank",className:"underline text-foreground-light",children:["four Vault Secrets",ec&&(0,n.jsxs)(n.Fragment,{children:[" ","prefixed with"," ",(0,n.jsxs)("span",{className:"text-brand",children:[" ","".concat(ec,"_vault_")]})]})]}),"."]})]}),(0,n.jsxs)("p",{children:["As a final step, you'll need to create an"," ",(0,n.jsx)("span",{className:"text-foreground-light",children:"Iceberg namespace"})," before you connect the Iceberg data to your database."]})]}):(0,n.jsxs)(O.Fc,{variant:"warning",children:[(0,n.jsx)(D.id,{}),(0,n.jsx)(O.XL,{children:"You need to install the Iceberg wrapper extension to connect your Analytic bucket to your database."}),(0,n.jsx)(O.TN,{className:"flex flex-col gap-y-2",children:(0,n.jsxs)("p",{children:["You need to install the ",(0,n.jsx)("span",{className:"text-brand",children:"wrappers"})," ","extension (with the minimum version of ",(0,n.jsx)("span",{children:"0.5.3"}),") if you want to connect your Analytics bucket to your database."]})})]})})]})})}),(0,n.jsxs)(E.Es,{"data-sentry-element":"DialogFooter","data-sentry-source-file":"CreateBucketModal.tsx",children:[(0,n.jsx)(G.$,{type:"default",disabled:H||X,onClick:()=>d(!1),"data-sentry-element":"Button","data-sentry-source-file":"CreateBucketModal.tsx",children:"Cancel"}),(0,n.jsx)(G.$,{form:Z,htmlType:"submit",loading:H||X,disabled:H||X,"data-sentry-element":"Button","data-sentry-source-file":"CreateBucketModal.tsx",children:"Create"})]})]})]})};var X=a(14132),ee=a(38937),et=a(16703),ea=a(8313),en=a(98615),el=a(10021),er=a(36628),es=a(32615),ei=a(50932),eo=a(39476),ec=a(80949),ed=a(10663);async function eu(e){let{projectRef:t,id:a,isPublic:n,file_size_limit:l,allowed_mime_types:r}=e;if(!t)throw Error("projectRef is required");if(!a)throw Error("Bucket name is requried");let s={public:n};void 0!==l&&(s.file_size_limit=l),void 0!==r&&(s.allowed_mime_types=r);let{data:i,error:o}=await (0,w.F6)("/platform/storage/{ref}/buckets/{id}",{params:{path:{id:a,ref:t}},body:s});return o&&(0,w.H4)(o),i}let em=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,v.jE)();return(0,k.n)(e=>eu(e),{async onSuccess(t,a,l){let{projectRef:r}=a;await n.invalidateQueries(_.w.buckets(r)),await (null==e?void 0:e(t,a,l))},async onError(e,a,n){void 0===t?x.oR.error("Failed to update bucket: ".concat(e.message)):t(e,a,n)},...a})},ep=e=>null!=e,eh=ed.Ik({name:ed.Yj(),public:ed.zM().default(!1),has_file_size_limit:ed.zM().default(!1),formatted_size_limit:ed.au.number().min(0,"File size upload limit has to be at least 0").default(0),allowed_mime_types:ed.Yj().trim().default("")}),ex="edit-storage-bucket-form",ef=e=>{var t,a,r,i,d,u;let{visible:m,bucket:f,onClose:y}=e,{ref:v}=(0,o.g)(),{mutate:k,isLoading:w}=em(),{data:_}=(0,j.I)({projectRef:v},{enabled:B.pe}),{value:N,unit:S}=(0,J.Jb)(null!=(t=null==_?void 0:_.fileSizeLimit)?t:0),M="".concat(N," ").concat(S),[A,C]=(0,l.useState)(g.s2.BYTES),[R,D]=(0,l.useState)(!1),{value:q}=(0,J.Jb)(null!=(a=null==f?void 0:f.file_size_limit)?a:0),O=(0,h.mN)({resolver:(0,c.u)(eh),defaultValues:{name:null!=(r=null==f?void 0:f.name)?r:"",public:null==f?void 0:f.public,has_file_size_limit:ep(null==f?void 0:f.file_size_limit),formatted_size_limit:null!=q?q:0,allowed_mime_types:(null!=(i=null==f?void 0:f.allowed_mime_types)?i:[]).join(", ")},values:{name:null!=(d=null==f?void 0:f.name)?d:"",public:null==f?void 0:f.public,has_file_size_limit:ep(null==f?void 0:f.file_size_limit),formatted_size_limit:null!=q?q:0,allowed_mime_types:(null!=(u=null==f?void 0:f.allowed_mime_types)?u:[]).join(", ")},mode:"onSubmit"}),H=O.watch("public"),W=O.watch("has_file_size_limit"),Q=O.watch("formatted_size_limit"),V=(null==f?void 0:f.public)!==H,$=(null==f?void 0:f.public)&&!H,Z=!(null==f?void 0:f.public)&&H,K=async e=>void 0===f?console.error("Bucket is required"):void 0===v?console.error("Project ref is required"):void k({projectRef:v,id:f.id,isPublic:e.public,file_size_limit:e.has_file_size_limit?(0,J.OG)(e.formatted_size_limit,A):null,allowed_mime_types:e.allowed_mime_types.length>0?e.allowed_mime_types.split(",").map(e=>e.trim()):null},{onSuccess:()=>{x.oR.success('Successfully updated bucket "'.concat(null==f?void 0:f.name,'"')),y()}});return(0,n.jsx)(E.lG,{open:m,onOpenChange:e=>{e||(O.reset(),y())},"data-sentry-element":"Dialog","data-sentry-component":"EditBucketModal","data-sentry-source-file":"EditBucketModal.tsx",children:(0,n.jsxs)(E.Cf,{"data-sentry-element":"DialogContent","data-sentry-source-file":"EditBucketModal.tsx",children:[(0,n.jsx)(E.c7,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"EditBucketModal.tsx",children:(0,n.jsx)(E.L3,{"data-sentry-element":"DialogTitle","data-sentry-source-file":"EditBucketModal.tsx",children:'Edit bucket "'.concat(null==f?void 0:f.name,'"')})}),(0,n.jsx)(E.pf,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"EditBucketModal.tsx"}),(0,n.jsx)(E.OO,{"data-sentry-element":"DialogSection","data-sentry-source-file":"EditBucketModal.tsx",children:(0,n.jsx)(z.lV,{...O,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"EditBucketModal.tsx",children:(0,n.jsxs)("form",{id:ex,className:"flex flex-col gap-4",onSubmit:O.handleSubmit(K),children:[(0,n.jsx)(z.zB,{name:"name",control:O.control,render:e=>{let{field:t}=e;return(0,n.jsx)(U.M,{name:"name",label:"Name of bucket",labelOptional:"Buckets cannot be renamed once created.",children:(0,n.jsx)(z.MJ,{children:(0,n.jsx)(T.p,{id:"name",...t,disabled:!0})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"EditBucketModal.tsx"},"name"),(0,n.jsx)(z.zB,{name:"public",control:O.control,render:e=>{let{field:t}=e;return(0,n.jsx)(U.M,{name:"public",label:"Public bucket",description:"Anyone can read any object without any authorization",layout:"flex",children:(0,n.jsx)(z.MJ,{children:(0,n.jsx)(I.d,{id:"public",size:"large",checked:t.value,onCheckedChange:t.onChange})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"EditBucketModal.tsx"},"public"),V&&(0,n.jsx)(Y.Z,{type:"warning",className:"rounded-none border-x-0 border-b-0 mb-0 pb-0 px-0 [&>svg]:left-0 [&>div>p]:!leading-normal",title:Z?"Warning: Making bucket public":$?"Warning: Making bucket private":"",description:(0,n.jsxs)(n.Fragment,{children:[Z?(0,n.jsx)("p",{children:"`This will make all objects in your bucket publicly accessible.`"}):$?(0,n.jsx)("p",{children:"`All objects in your bucket will be private and only accessible via signed URLs, or downloaded with the right authorisation headers.`"}):null,$&&(0,n.jsxs)("p",{children:["Assets cached in the CDN may still be publicly accessible. You can consider ",(0,n.jsx)(b.g,{href:"https://supabase.com/docs/guides/storage/cdn/smart-cdn#cache-eviction",children:"purging the cache"})," or moving your assets to a new bucket."]})]})}),(0,n.jsxs)(P.Nt,{open:R,onOpenChange:()=>D(!R),"data-sentry-element":"Collapsible_Shadcn_","data-sentry-source-file":"EditBucketModal.tsx",children:[(0,n.jsx)(P.R6,{asChild:!0,"data-sentry-element":"CollapsibleTrigger_Shadcn_","data-sentry-source-file":"EditBucketModal.tsx",children:(0,n.jsxs)("button",{className:"w-full cursor-pointer py-3 flex items-center justify-between border-t border-default",children:[(0,n.jsx)("p",{className:"text-sm",children:"Additional configuration"}),(0,n.jsx)(p.A,{size:18,strokeWidth:2,className:(0,F.cn)("text-foreground-light",R&&"rotate-180"),"data-sentry-element":"ChevronDown","data-sentry-source-file":"EditBucketModal.tsx"})]})}),(0,n.jsxs)(P.Ke,{className:"py-4 space-y-4","data-sentry-element":"CollapsibleContent_Shadcn_","data-sentry-source-file":"EditBucketModal.tsx",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(z.zB,{name:"has_file_size_limit",control:O.control,render:e=>{let{field:t}=e;return(0,n.jsx)(U.M,{name:"has_file_size_limit",label:"Restrict file upload size for bucket",description:"Prevent uploading of file sizes greater than a specified limit",layout:"flex",children:(0,n.jsx)(z.MJ,{children:(0,n.jsx)(I.d,{id:"has_file_size_limit",size:"large",checked:t.value,onCheckedChange:t.onChange})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"EditBucketModal.tsx"},"has_file_size_limit"),W&&(0,n.jsxs)("div",{className:"grid grid-cols-12 col-span-12 gap-x-2 gap-y-1",children:[(0,n.jsx)("div",{className:"col-span-8",children:(0,n.jsx)(z.zB,{name:"formatted_size_limit",control:O.control,render:e=>{let{field:t}=e;return(0,n.jsx)(U.M,{name:"formatted_size_limit",description:"Equivalent to ".concat((0,J.OG)(Q,A).toLocaleString()," bytes."),children:(0,n.jsx)(z.MJ,{children:(0,n.jsx)(T.p,{id:"formatted_size_limit","aria-label":"File size limit",type:"number",min:0,...t})})})}},"formatted_size_limit")}),(0,n.jsxs)(L.l6,{value:A,onValueChange:C,children:[(0,n.jsx)(L.bq,{"aria-label":"File size limit unit",size:"small",className:"col-span-4",children:(0,n.jsx)(L.yv,{asChild:!0,children:(0,n.jsx)(n.Fragment,{children:A})})}),(0,n.jsx)(L.gC,{children:Object.values(g.s2).map(e=>(0,n.jsx)(L.eb,{value:e,className:"text-xs",children:(0,n.jsx)("div",{children:e})},e))})]}),B.pe&&(0,n.jsx)("div",{className:"col-span-12 mt-2",children:(0,n.jsxs)("p",{className:"text-foreground-light text-sm",children:["Note: Individual bucket upload will still be capped at the"," ",(0,n.jsx)(s(),{href:"/project/".concat(v,"/settings/storage"),className:"font-bold underline",children:"global upload limit"})," ","of ",M]})})]})]}),(0,n.jsx)(z.zB,{name:"allowed_mime_types",control:O.control,render:e=>{let{field:t}=e;return(0,n.jsx)(U.M,{name:"allowed_mime_types",label:"Allowed MIME types",labelOptional:"Comma separated values",description:"Wildcards are allowed, e.g. image/*. Leave blank to allow any MIME type.",children:(0,n.jsx)(z.MJ,{children:(0,n.jsx)(T.p,{id:"allowed_mime_types",...t,placeholder:"e.g image/jpeg, image/png, audio/mpeg, video/mp4, etc"})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"EditBucketModal.tsx"},"allowed_mime_types")]})]})]})})}),(0,n.jsxs)(E.Es,{"data-sentry-element":"DialogFooter","data-sentry-source-file":"EditBucketModal.tsx",children:[(0,n.jsx)(G.$,{type:"default",disabled:w,onClick:()=>{O.reset(),y()},"data-sentry-element":"Button","data-sentry-source-file":"EditBucketModal.tsx",children:"Cancel"}),(0,n.jsx)(G.$,{form:ex,htmlType:"submit",loading:w,"data-sentry-element":"Button","data-sentry-source-file":"EditBucketModal.tsx",children:"Save"})]})]})})};var ey=a(54838);async function eg(e){let{projectRef:t,id:a}=e;if(!t)throw Error("projectRef is required");if(!a)throw Error("Bucket name is requried");let{data:n,error:l}=await (0,w.bE)("/platform/storage/{ref}/buckets/{id}/empty",{params:{path:{id:a,ref:t}}});return l&&(0,w.H4)(l),n}let eb=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,v.jE)();return(0,k.n)(e=>eg(e),{async onSuccess(t,a,l){let{projectRef:r}=a;await n.invalidateQueries(_.w.buckets(r)),await (null==e?void 0:e(t,a,l))},async onError(e,a,n){void 0===t?x.oR.error("Failed to empty bucket: ".concat(e.message)):t(e,a,n)},...a})},ej=e=>{let{visible:t,bucket:a,onClose:l}=e,{ref:r}=(0,o.g)(),{fetchFolderContents:s}=(0,ea.$)(),{mutate:i,isLoading:c}=eb({onSuccess:async()=>{void 0!==a&&(await s({bucketId:a.id,folderId:a.id,folderName:a.name,index:-1}),x.oR.success("Successfully deleted bucket ".concat(a.name)),l())}}),d=async()=>r?a?void i({projectRef:r,id:a.id}):console.error("No bucket is selected"):console.error("Project ref is required");return(0,n.jsx)(E.lG,{open:t,onOpenChange:e=>{e||l()},"data-sentry-element":"Dialog","data-sentry-component":"EmptyBucketModal","data-sentry-source-file":"EmptyBucketModal.tsx",children:(0,n.jsxs)(E.Cf,{"data-sentry-element":"DialogContent","data-sentry-source-file":"EmptyBucketModal.tsx",children:[(0,n.jsx)(E.c7,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"EmptyBucketModal.tsx",children:(0,n.jsx)(E.L3,{"data-sentry-element":"DialogTitle","data-sentry-source-file":"EmptyBucketModal.tsx",children:"Confirm to delete all contents from ".concat(null==a?void 0:a.name)})}),(0,n.jsx)(E.pf,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"EmptyBucketModal.tsx"}),(0,n.jsxs)(E.OO,{className:"flex flex-col gap-4","data-sentry-element":"DialogSection","data-sentry-source-file":"EmptyBucketModal.tsx",children:[(0,n.jsx)(Y.Z,{type:"destructive",title:"This action cannot be undone",description:"The contents of your bucket cannot be recovered once deleted.","data-sentry-element":"Admonition","data-sentry-source-file":"EmptyBucketModal.tsx"}),(0,n.jsxs)("p",{className:"text-sm",children:['Are you sure you want to empty the bucket "',null==a?void 0:a.name,'"?']})]}),(0,n.jsxs)(E.Es,{"data-sentry-element":"DialogFooter","data-sentry-source-file":"EmptyBucketModal.tsx",children:[(0,n.jsx)(G.$,{type:"default",disabled:c,onClick:l,"data-sentry-element":"Button","data-sentry-source-file":"EmptyBucketModal.tsx",children:"Cancel"}),(0,n.jsx)(G.$,{type:"danger",loading:c,onClick:d,"data-sentry-element":"Button","data-sentry-source-file":"EmptyBucketModal.tsx",children:"Empty Bucket"})]})]})})};var ev=a(34531),ek=a(35741),ew=a(64495);let e_=e=>{let{bucket:t,projectRef:a="",isSelected:r=!1}=e,{can:i}=(0,V.hl)(Q.aG.STORAGE_WRITE,"*"),[o,c]=(0,l.useState)(null),d=()=>c(null);return(0,n.jsxs)("div",{className:(0,F.cn)("group flex items-center justify-between rounded-md",r&&"text-foreground bg-surface-100"),"data-sentry-component":"BucketRow","data-sentry-source-file":"BucketRow.tsx",children:[(0,n.jsx)(s(),{href:"/project/".concat(a,"/storage/buckets/").concat(encodeURIComponent(t.id)),className:"py-1 px-3 grow","data-sentry-element":"Link","data-sentry-source-file":"BucketRow.tsx",children:(0,n.jsxs)("div",{className:"flex items-center justify-between space-x-2 truncate w-full",children:[(0,n.jsx)("p",{className:"text-sm group-hover:text-foreground transition truncate ".concat(r?"text-foreground":"text-foreground-light"),title:t.name,children:t.name}),t.public&&(0,n.jsx)(ev.E,{variant:"warning",children:"Public"}),"ANALYTICS"===t.type&&(0,n.jsxs)(ek.m_,{children:[(0,n.jsx)(ek.k$,{asChild:!0,children:(0,n.jsx)(er.A,{className:"text-foreground-lighter",size:"20"})}),(0,n.jsx)(ek.ZI,{children:(0,n.jsx)("p",{children:"Analytics bucket"})})]})]})}),i&&r?(0,n.jsxs)(ew.rI,{children:[(0,n.jsx)(ew.ty,{asChild:!0,children:(0,n.jsx)(G.$,{type:"text",icon:(0,n.jsx)(es.A,{}),className:"mr-1 h-6 w-6"})}),(0,n.jsxs)(ew.SQ,{side:"bottom",align:"start",children:["ANALYTICS"!==t.type&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(ew._2,{className:"space-x-2",onClick:()=>c("edit"),children:[(0,n.jsx)(ei.A,{size:14}),(0,n.jsx)("p",{children:"Edit bucket"})]},"toggle-private"),(0,n.jsx)(ew.mB,{}),(0,n.jsxs)(ew._2,{className:"space-x-2",onClick:()=>c("empty"),children:[(0,n.jsx)(eo.A,{size:14}),(0,n.jsx)("p",{children:"Empty bucket"})]},"empty-bucket")]}),(0,n.jsxs)(ew._2,{className:"space-x-2",onClick:()=>c("delete"),children:[(0,n.jsx)(ec.A,{size:14}),(0,n.jsx)("p",{children:"Delete bucket"})]},"delete-bucket")]})]}):(0,n.jsx)("div",{className:"w-7 mr-1"}),(0,n.jsx)(ef,{visible:"edit"===o,bucket:t,onClose:d,"data-sentry-element":"EditBucketModal","data-sentry-source-file":"BucketRow.tsx"}),(0,n.jsx)(ej,{visible:"empty"===o,bucket:t,onClose:d,"data-sentry-element":"EmptyBucketModal","data-sentry-source-file":"BucketRow.tsx"}),(0,n.jsx)(ey.A,{visible:"delete"===o,bucket:t,onClose:d,"data-sentry-element":"DeleteBucketModal","data-sentry-source-file":"BucketRow.tsx"})]},t.id)},eN=()=>{let e=(0,i.useRouter)(),{ref:t,bucketId:a}=(0,o.g)(),{data:r}=(0,et.YA)(),c=(0,ea.$)(),d=(null==r?void 0:r.parent_project_ref)!==void 0,[u,m]=(0,l.useState)(""),p=e.pathname.split("/")[4],{data:h=[],error:x,isLoading:f,isError:y,isSuccess:g}=(0,ee.p)({projectRef:t}),b="alphabetical"===c.sortBucket?h.sort((e,t)=>e.name.toLowerCase().trim().localeCompare(t.name.toLowerCase().trim())):h.sort((e,t)=>new Date(t.created_at)>new Date(e.created_at)?-1:1),j=u.length>1?b.filter(e=>e.name.includes(u.trim())):b,v=(null==x?void 0:x.message.includes("Tenant config"))&&d;return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(en.Ay,{type:"pills",className:"mt-6 flex flex-grow flex-col","data-sentry-element":"Menu","data-sentry-source-file":"StorageMenu.tsx",children:[(0,n.jsxs)("div",{className:"mb-6 mx-5 flex flex-col gap-y-1.5",children:[(0,n.jsx)(K,{"data-sentry-element":"CreateBucketModal","data-sentry-source-file":"StorageMenu.tsx"}),(0,n.jsx)(el.a0,{className:"px-0","data-sentry-element":"InnerSideBarFilters","data-sentry-source-file":"StorageMenu.tsx",children:(0,n.jsx)(el.RK,{name:"search-buckets","aria-labelledby":"Search buckets",placeholder:"Search buckets...",value:u,onChange:e=>{m(e.target.value)},"data-sentry-element":"InnerSideBarFilterSearchInput","data-sentry-source-file":"StorageMenu.tsx",children:(0,n.jsxs)(el.i9,{value:c.sortBucket,onValueChange:e=>c.setSortBucket(e),"data-sentry-element":"InnerSideBarFilterSortDropdown","data-sentry-source-file":"StorageMenu.tsx",children:[(0,n.jsx)(el.Pl,{value:"alphabetical",className:"flex gap-2","data-sentry-element":"InnerSideBarFilterSortDropdownItem","data-sentry-source-file":"StorageMenu.tsx",children:"Alphabetical"},"alphabetical"),(0,n.jsx)(el.Pl,{value:"created-at","data-sentry-element":"InnerSideBarFilterSortDropdownItem","data-sentry-source-file":"StorageMenu.tsx",children:"Created at"},"created-at")]})})})]}),(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"mx-3",children:[(0,n.jsx)(en.Ay.Group,{title:(0,n.jsx)("span",{className:"uppercase font-mono",children:"All buckets"}),"data-sentry-element":"Menu.Group","data-sentry-source-file":"StorageMenu.tsx"}),f&&(0,n.jsxs)("div",{className:"space-y-2 mx-2",children:[(0,n.jsx)(X.A,{className:"!py-2.5"}),(0,n.jsx)(X.A,{className:"!py-2.5"}),(0,n.jsx)(X.A,{className:"!py-2.5"})]}),y&&(0,n.jsx)("div",{className:"px-2",children:(0,n.jsxs)(O.Fc,{variant:v?"default":"warning",children:[(0,n.jsx)(O.XL,{className:"text-xs tracking-normal",children:v?"Storage is not available on preview branches for now":"Failed to fetch buckets"}),(0,n.jsx)(O.TN,{className:"text-xs",children:v?"We're actively looking into making this available on preview branches":"Please refresh to try again"})]})}),g&&(0,n.jsxs)(n.Fragment,{children:[0===h.length&&(0,n.jsx)(el.Q5,{className:"mx-2",title:"No buckets available",description:"Buckets that you create will appear here"}),u.length>0&&0===j.length&&(0,n.jsx)(el.Q5,{className:"mx-2",title:"No results found",description:'Your search for "'.concat(u,'" did not return any results')}),j.map((e,l)=>{let r=a===e.id;return(0,n.jsx)(e_,{bucket:e,projectRef:t,isSelected:r},"".concat(l,"_").concat(e.id))})]})]}),(0,n.jsxs)("div",{className:"w-full bg-dash-sidebar px-3 py-6 sticky bottom-0 border-t border-border",children:[(0,n.jsx)(en.Ay.Group,{title:(0,n.jsx)("span",{className:"uppercase font-mono",children:"Configuration"}),"data-sentry-element":"Menu.Group","data-sentry-source-file":"StorageMenu.tsx"}),(0,n.jsx)(s(),{href:"/project/".concat(t,"/storage/policies"),"data-sentry-element":"Link","data-sentry-source-file":"StorageMenu.tsx",children:(0,n.jsx)(en.Ay.Item,{rounded:!0,active:"policies"===p,"data-sentry-element":"Menu.Item","data-sentry-source-file":"StorageMenu.tsx",children:(0,n.jsx)("p",{className:"truncate",children:"Policies"})})}),(0,n.jsx)(s(),{href:"/project/".concat(t,"/storage/settings"),"data-sentry-element":"Link","data-sentry-source-file":"StorageMenu.tsx",children:(0,n.jsx)(en.Ay.Item,{rounded:!0,active:"settings"===p,"data-sentry-element":"Menu.Item","data-sentry-source-file":"StorageMenu.tsx",children:(0,n.jsx)("p",{className:"truncate",children:"Settings"})})})]})]})]})})};var eS=a(53405),eM=a(33444);let eA=(0,eS.r)(e=>{let{title:t,children:a}=e;return(0,n.jsx)(eM.A,{stickySidebarBottom:!0,title:t||"Storage",product:"Storage",productMenu:(0,n.jsx)(eN,{}),"data-sentry-element":"ProjectLayout","data-sentry-component":"StorageLayout","data-sentry-source-file":"StorageLayout.tsx",children:a})})},17573:(e,t,a)=>{a.d(t,{A:()=>n});let n={credentials:e=>["projects",e,"storage-credentials"]}},25779:(e,t,a)=>{a.d(t,{j:()=>d});var n=a(56947),l=a(23879),r=a(70938),s=a(16703),i=a(74144),o=a(55492);async function c(e,t,a){let{projectRef:n,connectionString:s,schema:i}=e;if(!n)throw Error("projectRef is required");let o=new Headers(a);s&&o.set("x-connection-encrypted",s);let{data:c,error:d}=await (0,r.Jt)("/platform/pg-meta/{ref}/policies",{params:{header:{"x-connection-encrypted":s,"x-pg-application-name":l.r},path:{ref:n},query:{included_schemas:i||"",excluded_schemas:""}},headers:o,signal:t});return d&&(0,r.H4)(d),c}let d=function(e){let{projectRef:t,connectionString:a,schema:l}=e,{enabled:r=!0,...d}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:u}=(0,s.YA)(),m=(null==u?void 0:u.status)===i.BU.ACTIVE_HEALTHY;return(0,n.I)(o.S.list(t,l),e=>{let{signal:n}=e;return c({projectRef:t,connectionString:a,schema:l},n)},{enabled:r&&void 0!==t&&m,...d})}},28320:(e,t,a)=>{a.d(t,{P:()=>s});var n=a(60882),l=a(43631),r=a(16703);let s=()=>{var e,t;let{data:a}=(0,r.YA)(),{data:s,isLoading:i}=(0,l.z)({projectRef:null==a?void 0:a.ref,connectionString:null==a?void 0:a.connectionString}),o=n.o.find(e=>"iceberg_wrapper"===e.id);if(!o||"wrapper"!==o.type)return"not-found";let c=o.meta,d=null==s?void 0:s.find(e=>"wrappers"===e.name),u=!!(null==d?void 0:d.installed_version),m=(null!=(e=null==d?void 0:d.installed_version)?e:"")>=(null!=(t=null==c?void 0:c.minimumExtensionVersion)?t:"");return i?"loading":u?m?"installed":"needs-upgrade":"not-installed"}},41807:(e,t,a)=>{a.d(t,{A:()=>l});var n=a(80263);a(53239);let l=function(e){let{children:t,target:a="_blank",href:l,className:r,onClick:s,style:i}=e;return(0,n.jsx)("a",{onClick:s,href:l,target:a,rel:"noopener noreferrer",style:i,"data-sentry-component":"Link","data-sentry-source-file":"Link.tsx",children:t})}},43631:(e,t,a)=>{a.d(t,{z:()=>d});var n=a(23879),l=a(56947),r=a(70938),s=a(16703),i=a(74144),o=a(55784);async function c(e,t,a){let{projectRef:l,connectionString:s}=e;if(!l)throw Error("projectRef is required");let i=new Headers(a);s&&i.set("x-connection-encrypted",s);let{data:o,error:c}=await (0,r.Jt)("/platform/pg-meta/{ref}/extensions",{params:{header:{"x-connection-encrypted":s,"x-pg-application-name":n.r},path:{ref:l}},headers:i,signal:t});return c&&(0,r.H4)(c),o}let d=function(e){let{projectRef:t,connectionString:a}=e,{enabled:n=!0,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:d}=(0,s.YA)(),u=(null==d?void 0:d.status)===i.BU.ACTIVE_HEALTHY;return(0,l.I)(o.I.list(t),e=>{let{signal:n}=e;return c({projectRef:t,connectionString:a},n)},{enabled:n&&void 0!==t&&u,...r})}},54838:(e,t,a)=>{a.d(t,{A:()=>z});var n=a(80263),l=a(26089),r=a.n(l),s=a(48388),i=a.n(s),o=a(67908),c=a(87494),d=a(32981),u=a(19686),m=a(73969),p=a(46491),h=a(25779),x=a(86974),f=a(32144),y=a(80251),g=a(70938),b=a(89357);async function j(e){let{projectRef:t,id:a,type:n}=e;if(!t)throw Error("projectRef is required");if(!a)throw Error("Bucket name is requried");if("ANALYTICS"!==n){let{error:e}=await (0,g.bE)("/platform/storage/{ref}/buckets/{id}/empty",{params:{path:{ref:t,id:a}}});e&&(0,g.H4)(e)}let{data:l,error:r}=await (0,g.yH)("/platform/storage/{ref}/buckets/{id}",{params:{path:{ref:t,id:a},query:{type:n}}});return r&&(0,g.H4)(r),l}let v=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,f.jE)();return(0,y.n)(e=>j(e),{async onSuccess(t,a,l){let{projectRef:r}=a;await n.invalidateQueries(b.w.buckets(r)),await (null==e?void 0:e(t,a,l))},async onError(e,a,n){void 0===t?m.oR.error("Failed to delete bucket: ".concat(e.message)):t(e,a,n)},...a})};var k=a(38937),w=a(16703),_=a(84592),N=a(19506),S=a(20704),M=a(20838),A=a(22554),C=a(50922),B=a(57374);let E="delete-storage-bucket-form",z=e=>{let{visible:t,bucket:a,onClose:l}=e,s=(0,o.useRouter)(),{ref:f}=(0,p.g)(),{data:y}=(0,w.YA)(),g=u.Ay.object({confirm:u.Ay.literal(a.name,{errorMap:()=>({message:'Please enter "'.concat(a.name,'" to confirm')})})}),b=(0,c.mN)({resolver:(0,d.u)(g)}),{data:j}=(0,k.p)({projectRef:f}),{data:z}=(0,h.j)({projectRef:null==y?void 0:y.ref,connectionString:null==y?void 0:y.connectionString,schema:"storage"}),{mutateAsync:T}=(0,x.f)(),{mutate:R,isLoading:D}=v({onSuccess:async()=>{if(!y)return console.error("Project is required");let e=(null!=z?z:[]).filter(e=>"objects"===e.table),t=(0,_._S)(I,e),n=r()(i()(t,{name:a.name}),["policies"],[]);try{await Promise.all(n.map(e=>T({projectRef:null==y?void 0:y.ref,connectionString:null==y?void 0:y.connectionString,originalPolicy:e}))),m.oR.success("Successfully deleted bucket ".concat(a.name)),s.push("/project/".concat(f,"/storage/buckets")),l()}catch(e){m.oR.success("Successfully deleted bucket ".concat(a.name,". However, there was a problem deleting the policies tied to the bucket. Please review them in the storage policies section"))}}}),I=null!=j?j:[],P=async()=>f?a?void R({projectRef:f,id:a.id,type:a.type}):console.error("No bucket is selected"):console.error("Project ref is required");return(0,n.jsx)(N.lG,{open:t,onOpenChange:e=>{e||l()},"data-sentry-element":"Dialog","data-sentry-component":"DeleteBucketModal","data-sentry-source-file":"DeleteBucketModal.tsx",children:(0,n.jsxs)(N.Cf,{"data-sentry-element":"DialogContent","data-sentry-source-file":"DeleteBucketModal.tsx",children:[(0,n.jsx)(N.c7,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"DeleteBucketModal.tsx",children:(0,n.jsx)(N.L3,{"data-sentry-element":"DialogTitle","data-sentry-source-file":"DeleteBucketModal.tsx",children:"Confirm deletion of ".concat(a.name)})}),(0,n.jsx)(N.pf,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"DeleteBucketModal.tsx"}),(0,n.jsxs)(N.OO,{className:"flex flex-col gap-4","data-sentry-element":"DialogSection","data-sentry-source-file":"DeleteBucketModal.tsx",children:[(0,n.jsx)(C.Z,{type:"destructive",title:"You cannot recover this bucket once deleted.",description:"All bucket data will be lost.","data-sentry-element":"Admonition","data-sentry-source-file":"DeleteBucketModal.tsx"}),(0,n.jsxs)("p",{children:["Your bucket ",(0,n.jsx)("span",{className:"font-bold text-foreground",children:a.name})," and all its contents will be permanently deleted."]})]}),(0,n.jsx)(N.pf,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"DeleteBucketModal.tsx"}),(0,n.jsx)(N.OO,{"data-sentry-element":"DialogSection","data-sentry-source-file":"DeleteBucketModal.tsx",children:(0,n.jsx)(S.lV,{...b,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"DeleteBucketModal.tsx",children:(0,n.jsx)("form",{id:E,className:"flex flex-col gap-4",onSubmit:b.handleSubmit(P),children:(0,n.jsx)(S.zB,{name:"confirm",control:b.control,render:e=>{let{field:t}=e;return(0,n.jsx)(B.M,{name:"confirm",label:(0,n.jsxs)(n.Fragment,{children:["Type ",(0,n.jsx)("span",{className:"font-bold text-foreground",children:a.name})," to confirm."]}),children:(0,n.jsx)(S.MJ,{children:(0,n.jsx)(M.p,{id:"confirm",autoComplete:"off",...t,placeholder:"Type in name of bucket"})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"DeleteBucketModal.tsx"},"confirm")})})}),(0,n.jsxs)(N.Es,{"data-sentry-element":"DialogFooter","data-sentry-source-file":"DeleteBucketModal.tsx",children:[(0,n.jsx)(A.$,{type:"default",disabled:D,onClick:l,"data-sentry-element":"Button","data-sentry-source-file":"DeleteBucketModal.tsx",children:"Cancel"}),(0,n.jsx)(A.$,{form:E,htmlType:"submit",type:"danger",loading:D,"data-sentry-element":"Button","data-sentry-source-file":"DeleteBucketModal.tsx",children:"Delete Bucket"})]})]})})}},60882:(e,t,a)=>{a.d(t,{o:()=>S});var n=a(80263),l=a(39251),r=a(83671),s=a(23478),i=a(63675),o=a(99506),c=a(74686),d=a.n(c),u=a(64718),m=a.n(u),p=a(14132),h=a(74144),x=a(80127),f=a(93749),y=a.n(f),g=a(16703),b=a(22554),j=a(50922);let v=e=>{let{minimumVersion:t="15.6"}=e,{data:a}=(0,g.YA)();return(0,n.jsxs)(j.Z,{type:"warning",className:"mt-4",title:"Database upgrade needed",childProps:{description:{className:"flex flex-col gap-y-2"}},"data-sentry-element":"Admonition","data-sentry-component":"UpgradeDatabaseAlert","data-sentry-source-file":"UpgradeDatabaseAlert.tsx",children:[(0,n.jsx)("div",{className:"prose text-sm max-w-full",children:(0,n.jsxs)("p",{children:["This integration requires the ",(0,n.jsx)("code",{children:"pgmq"})," extension which is not available on this version of Postgres. The extension is available on version ",t," and higher."]})}),(0,n.jsx)(b.$,{color:"primary",className:"w-fit","data-sentry-element":"Button","data-sentry-source-file":"UpgradeDatabaseAlert.tsx",children:(0,n.jsx)(y(),{href:"/project/".concat(null==a?void 0:a.ref,"/settings/infrastructure"),"data-sentry-element":"Link","data-sentry-source-file":"UpgradeDatabaseAlert.tsx",children:"Upgrade database"})})]})};var k=a(6409);let w=()=>(0,n.jsx)("div",{className:"p-10","data-sentry-component":"Loading","data-sentry-source-file":"Integrations.constants.tsx",children:(0,n.jsx)(p.y,{"data-sentry-element":"GenericSkeletonLoader","data-sentry-source-file":"Integrations.constants.tsx"})}),_={name:"Supabase",websiteUrl:"https://supabase.com"},N=[{id:"queues",type:"postgres_extension",requiredExtensions:["pgmq"],missingExtensionsAlert:(0,n.jsx)(v,{minimumVersion:"15.6.1.143"}),name:"Queues",icon:function(){let{className:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.jsx)(l.A,{className:(0,x.cn)("inset-0 p-2 text-black w-full h-full",e),...t})},description:"Lightweight message queue in Postgres",docsUrl:"https://github.com/tembo-io/pgmq",author:{name:"pgmq",websiteUrl:"https://github.com/tembo-io/pgmq"},navigation:[{route:"overview",label:"Overview"},{route:"queues",label:"Queues",hasChild:!0,childIcon:(0,n.jsx)(l.A,{size:12,strokeWidth:1.5,className:(0,x.cn)("text-foreground w-full h-full")})},{route:"settings",label:"Settings"}],navigate:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"overview",n=arguments.length>2?arguments[2]:void 0;if(n)return d()(()=>Promise.all([a.e(6266),a.e(89),a.e(673),a.e(7494),a.e(726),a.e(7074),a.e(4560),a.e(8444),a.e(3895),a.e(7795),a.e(4654),a.e(3144),a.e(6692),a.e(6616),a.e(4049),a.e(3792),a.e(6482),a.e(7716)]).then(a.bind(a,7522)).then(e=>e.QueueTab),{loadableGenerated:{webpack:()=>[7522]},loading:w});switch(t){case"overview":return d()(()=>Promise.all([a.e(673),a.e(726),a.e(6616),a.e(8542),a.e(6870)]).then(a.bind(a,86870)).then(e=>e.QueuesOverviewTab),{loadableGenerated:{webpack:()=>[86870]},loading:w});case"queues":return d()(()=>Promise.all([a.e(7494),a.e(6616),a.e(6850)]).then(a.bind(a,36850)).then(e=>e.QueuesTab),{loadableGenerated:{webpack:()=>[36850]},loading:w});case"settings":return d()(()=>Promise.all([a.e(7494),a.e(6616),a.e(5515)]).then(a.bind(a,55515)).then(e=>e.QueuesSettings),{loadableGenerated:{webpack:()=>[55515]},loading:w})}return null}},{id:"cron",type:"postgres_extension",requiredExtensions:["pg_cron"],name:"Cron",icon:function(){let{className:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.jsx)(r.A,{className:(0,x.cn)("inset-0 p-2 text-black w-full h-full",e),...t})},description:"Schedule recurring Jobs in Postgres.",docsUrl:"https://github.com/citusdata/pg_cron",author:{name:"Citus Data",websiteUrl:"https://github.com/citusdata/pg_cron"},navigation:[{route:"overview",label:"Overview"},{route:"jobs",label:"Jobs",hasChild:!0,childIcon:(0,n.jsx)(s.A,{size:12,strokeWidth:1.5,className:(0,x.cn)("text-foreground w-full h-full")})}],navigate:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"overview",n=arguments.length>2?arguments[2]:void 0;if(n)return d()(()=>Promise.all([a.e(8199),a.e(673),a.e(726),a.e(4560),a.e(3895),a.e(5175),a.e(106),a.e(4352),a.e(4123),a.e(4794)]).then(a.bind(a,4794)).then(e=>e.PreviousRunsTab),{loadableGenerated:{webpack:()=>[4794]},loading:w});switch(t){case"overview":return d()(()=>Promise.all([a.e(673),a.e(726),a.e(8542)]).then(a.bind(a,48542)).then(e=>e.IntegrationOverviewTab),{loadableGenerated:{webpack:()=>[48542]},loading:w});case"jobs":return d()(()=>Promise.all([a.e(6266),a.e(89),a.e(8199),a.e(673),a.e(7494),a.e(726),a.e(7074),a.e(4560),a.e(8444),a.e(3895),a.e(7795),a.e(106),a.e(1619),a.e(4352),a.e(4123),a.e(339)]).then(a.bind(a,80339)).then(e=>e.CronjobsTab),{loadableGenerated:{webpack:()=>[80339]},loading:w})}return null}},{id:"vault",type:"postgres_extension",requiredExtensions:["supabase_vault"],missingExtensionsAlert:(0,n.jsx)(v,{}),name:"Vault",status:"alpha",icon:function(){let{className:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.jsx)(i.A,{className:(0,x.cn)("inset-0 p-2 text-black w-full h-full",e),...t})},description:"Application level encryption for your project",docsUrl:"https://supabase.com/docs",author:_,navigation:[{route:"overview",label:"Overview"},{route:"secrets",label:"Secrets"}],navigate:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"overview";switch(arguments.length>2&&arguments[2],t){case"overview":return d()(()=>Promise.all([a.e(673),a.e(726),a.e(8542)]).then(a.bind(a,48542)).then(e=>e.IntegrationOverviewTab),{loadableGenerated:{webpack:()=>[48542]},loading:w});case"secrets":return d()(()=>Promise.all([a.e(673),a.e(7494),a.e(726),a.e(4560),a.e(8444),a.e(6477),a.e(221)]).then(a.bind(a,80221)).then(e=>e.SecretsManagement),{loadableGenerated:{webpack:()=>[80221]},loading:w})}return null}},{id:"webhooks",type:"postgres_extension",name:"Database Webhooks",icon:function(){let{className:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.jsx)(o.A,{className:(0,x.cn)("inset-0 p-2 text-black w-full h-full",e),...t})},description:"Send real-time data from your database to another system when a table event occurs",docsUrl:"https://supabase.com/docs",author:_,requiredExtensions:[],navigation:[{route:"overview",label:"Overview"},{route:"webhooks",label:"Webhooks"}],navigate:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"overview";switch(arguments.length>2&&arguments[2],t){case"overview":return d()(()=>Promise.all([a.e(673),a.e(726),a.e(8542),a.e(2881)]).then(a.bind(a,82881)).then(e=>e.WebhooksOverviewTab),{loadableGenerated:{webpack:()=>[82881]},loading:w});case"webhooks":return d()(()=>Promise.all([a.e(673),a.e(7494),a.e(726),a.e(5476),a.e(6616),a.e(6477),a.e(8017)]).then(a.bind(a,40398)).then(e=>e.WebhooksListTab),{loadableGenerated:{webpack:()=>[40398]},loading:w})}return null}},{id:"graphiql",type:"postgres_extension",requiredExtensions:["pg_graphql"],name:"GraphQL",icon:function(){let{className:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.jsx)(m(),{fill:!0,src:"".concat(h.o2,"/img/graphql.svg"),alt:"GraphiQL",className:(0,x.cn)("p-2",e),...t})},description:"Run GraphQL queries through our interactive in-browser IDE",docsUrl:"https://supabase.com/docs",author:_,navigation:[{route:"overview",label:"Overview"},{route:"graphiql",label:"GraphiQL"}],navigate:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"overview";switch(arguments.length>2&&arguments[2],t){case"overview":return d()(()=>Promise.all([a.e(673),a.e(726),a.e(8542)]).then(a.bind(a,48542)).then(e=>e.IntegrationOverviewTab),{loadableGenerated:{webpack:()=>[48542]},loading:w});case"graphiql":return d()(()=>Promise.all([a.e(3456),a.e(6266),a.e(673),a.e(726),a.e(7074),a.e(4560),a.e(3895),a.e(6692),a.e(695),a.e(3792),a.e(8587),a.e(2155)]).then(a.bind(a,61991)).then(e=>e.GraphiQLTab),{loadableGenerated:{webpack:()=>[61991]},loading:w})}return null}}],S=[...k.V.map(e=>({id:e.name,type:"wrapper",name:"".concat(e.label," Wrapper"),icon:function(){let{className:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.jsx)(m(),{fill:!0,src:e.icon,alt:e.name,className:(0,x.cn)("p-2",t),...a})},requiredExtensions:["wrappers","supabase_vault"],description:e.description,docsUrl:e.docsUrl,meta:e,author:_,navigation:[{route:"overview",label:"Overview"},{route:"wrappers",label:"Wrappers"}],navigate:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"overview";switch(arguments.length>2&&arguments[2],t){case"overview":return d()(()=>Promise.all([a.e(6266),a.e(673),a.e(726),a.e(7074),a.e(8542),a.e(6951),a.e(9034)]).then(a.bind(a,39034)).then(e=>e.WrapperOverviewTab),{loadableGenerated:{webpack:()=>[39034]},loading:w});case"wrappers":return d()(()=>Promise.all([a.e(6266),a.e(673),a.e(726),a.e(7074),a.e(6951),a.e(1863)]).then(a.bind(a,20337)).then(e=>e.WrappersTab),{loadableGenerated:{webpack:()=>[20337]},loading:w})}return null}})),...N]},65321:(e,t,a)=>{a.d(t,{Z:()=>h});var n=a(60045),l=a(52793),r=a.n(l),s=a(6409),i=a(89878),o=a(72135),c=a(38651),d=a(52895),u=a(75831),m=a(16703),p=a(85435);let h=()=>{var e,t,a,l,h,x;let{data:f}=(0,m.YA)(),{data:y}=(0,o.I)({projectRef:null==f?void 0:f.ref,reveal:!0}),{secretKey:g,serviceKey:b}=(0,o.x)(y),{data:j}=(0,c.G)({projectRef:null==f?void 0:f.ref}),v=null!=(l=null==j||null==(e=j.app_config)?void 0:e.protocol)?l:"https",k=(null==j||null==(t=j.app_config)?void 0:t.storage_endpoint)||(null==j||null==(a=j.app_config)?void 0:a.endpoint),w=null!=(x=null!=(h=null==g?void 0:g.api_key)?h:null==b?void 0:b.api_key)?x:"SUPABASE_CLIENT_API_KEY",_=s.V.find(e=>"iceberg_wrapper"===e.name),N=(0,u.SE)(n.aG.STORAGE_ADMIN_WRITE,"*"),{mutateAsync:S,isLoading:M}=(0,p.S)(),{mutateAsync:A,isLoading:C}=(0,d.m_)();return{mutateAsync:async e=>{var t,a;let{bucketName:n}=e,l=await S({projectRef:null==f?void 0:f.ref,description:"".concat(r()(n),"_keys")}),s="".concat(r()(n),"_fdw"),o={projectRef:null==f?void 0:f.ref,connectionString:null==f?void 0:f.connectionString,wrapperMeta:_,formState:{wrapper_name:s,server_name:"".concat(s,"_server"),vault_aws_access_key_id:null==l?void 0:l.access_key,vault_aws_secret_access_key:null==l?void 0:l.secret_key,vault_token:w,warehouse:n,"s3.endpoint":(0,i.yO)(null!=(t=null==f?void 0:f.ref)?t:"",v,k),catalog_uri:(0,i.Uj)(null!=(a=null==f?void 0:f.ref)?a:"",v,k)},mode:"skip",tables:[],sourceSchema:"",targetSchema:""};await A(o)},isLoading:C||M,hasPermission:N}}},68061:(e,t,a)=>{a.d(t,{I:()=>o});var n=a(56947),l=a(70938),r=a(41742),s=a(74144);async function i(e,t){let{projectRef:a}=e;if(!a)throw Error("projectRef is required");let{data:n,error:r}=await (0,l.Jt)("/platform/projects/{ref}/config/storage",{params:{path:{ref:a}},signal:t});return r&&(0,l.H4)(r),n}let o=function(e){let{projectRef:t}=e,{enabled:a=!0,...l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,n.I)(r.n.storage(t),e=>{let{signal:a}=e;return i({projectRef:t},a)},{enabled:a&&s.pe&&void 0!==t,...l})}},84592:(e,t,a)=>{a.d(t,{EQ:()=>g,Xn:()=>y,_S:()=>c,kg:()=>p,wS:()=>x});var n=a(107),l=a.n(n),r=a(42092),s=a.n(r),i=a(6400);let o=e=>{let t=0;for(let a=0;a<e.length;a++)t=(t<<5)-t+e.charCodeAt(a),t&=t;return new Uint32Array([t])[0].toString(36)},c=(e,t)=>0===t.length?t:m(d(e,t)),d=(e,t)=>{let a=e.map(e=>e.name);return t.map(e=>{let{definition:t,check:n}=e,l=null!==t?u(t):u(n);return l&&a.includes(l)?{...e,bucket:l}:{...e,bucket:"Ungrouped"}})},u=e=>{var t;let[a]=(null!=(t=null==e?void 0:e.split(" AND "))?t:[]).filter(e=>e.includes("bucket_id"));return a?a.split("'")[1]:null},m=e=>{let t=l()(e,"bucket");return Object.keys(t).map(e=>({name:e,policies:t[e]}))},p=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,a=!(arguments.length>2)||void 0===arguments[2]||arguments[2],{name:n,definition:l,allowedOperations:r,roles:s}=t,i=l?l.replace(/\s+/g," ").trim():"";return r.map((t,l)=>h(l,e,n,i,t,s,a))},h=(e,t,a,n,l,r,s)=>{let i=o(t);return{name:s?"".concat(a," ").concat(i,"_").concat(e):a,definition:"INSERT"===l?void 0:"(".concat(n,")"),action:"PERMISSIVE",check:"INSERT"===l?"(".concat(n,")"):void 0,command:l,schema:"storage",table:"objects",roles:r.length>0?r:void 0}},x=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object.keys(i.Uw).filter(t=>{let a=i.Uw[t];if(0===s()(a,e).length)return t})},f=(e,t,a,n,l,r,s)=>{let i=o(t),c=s?"".concat(a," ").concat(i,"_").concat(e):a,d="Add policy for the ".concat(l,' operation under the policy "').concat(a,'"'),u=0===r.length?["public"]:r;return{description:d,statement:'\n    CREATE POLICY "'.concat(c,'"\n    ON storage.objects\n    FOR ').concat(l,"\n    TO ").concat(u.join(", "),"\n    ").concat("INSERT"===l?"WITH CHECK":"USING"," (").concat(n,");\n").replace(/\s+/g," ").trim()}},y=function(e,t){let a=!(arguments.length>2)||void 0===arguments[2]||arguments[2],{name:n,definition:l,allowedOperations:r,roles:s}=t;return r.map((t,r)=>f(r,e,n,l||"",t,s,a))},g=(e,t)=>e.replace("{bucket_id}","'".concat(t,"'"))},85435:(e,t,a)=>{a.d(t,{S:()=>c});var n=a(32144),l=a(80251),r=a(73969),s=a(70938),i=a(17573);let o=async e=>{let{description:t,projectRef:a}=e;if(!a)throw Error("projectRef is required");let{data:n,error:l}=await (0,s.bE)("/platform/storage/{ref}/credentials",{params:{path:{ref:a}},body:{description:t}});return l&&(0,s.H4)(l),n};function c(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,n.jE)();return(0,l.n)(e=>o(e),{async onSuccess(t,a,n){let{projectRef:l}=a;await s.invalidateQueries(i.A.credentials(l)),await (null==e?void 0:e(t,a,n))},async onError(e,a,n){void 0===t?r.oR.error("Failed to create S3 access key: ".concat(e.message)):t(e,a,n)},...a})}},86974:(e,t,a)=>{a.d(t,{f:()=>d});var n=a(22990),l=a(32144),r=a(80251),s=a(73969),i=a(20305),o=a(55492);async function c(e){let{projectRef:t,connectionString:a,originalPolicy:l}=e,r=new Headers;a&&r.set("x-connection-encrypted",a);let{sql:s}=n.A.policies.remove(l),{result:o}=await (0,i.E)({projectRef:t,connectionString:a,sql:s,queryKey:["policy","delete",l.id]});return o}let d=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,l.jE)();return(0,r.n)(e=>c(e),{async onSuccess(t,a,l){let{projectRef:r}=a;await n.invalidateQueries(o.S.list(r)),await (null==e?void 0:e(t,a,l))},async onError(e,a,n){void 0===t?s.oR.error("Failed to delete database policy: ".concat(e.message)):t(e,a,n)},...a})}},98615:(e,t,a)=>{a.d(t,{Ay:()=>p});var n=a(80263),l=a(53239),r=a(92413),s=a(80127),i=a(41807);function o(e){let{children:t,className:a,tag:l="div",style:r}=e;return(0,n.jsx)("".concat(l),{style:r,"data-sentry-element":"CustomTag","data-sentry-component":"Typography","data-sentry-source-file":"Typography.tsx",children:t})}o.Title=function(e){let{className:t,level:a=1,children:l,style:r}=e;return(0,n.jsx)("h".concat(a),{style:r,"data-sentry-element":"CustomTag","data-sentry-component":"Title","data-sentry-source-file":"Title.tsx",children:l})},o.Text=function(e){let{className:t,children:a,style:l,type:r,disabled:s,mark:i,code:o,keyboard:c,underline:d,strikethrough:u,strong:m,small:p}=e;return o?(0,n.jsx)("code",{style:l,children:a}):i?(0,n.jsx)("mark",{style:l,children:a}):c?(0,n.jsx)("kbd",{style:l,children:a}):m?(0,n.jsx)("strong",{style:l,children:a}):(0,n.jsx)("span",{style:l,"data-sentry-component":"Text","data-sentry-source-file":"Text.tsx",children:a})},o.Link=i.A;let c=(0,l.createContext)({type:"text"}),d=e=>{let{type:t}=e;return(0,n.jsx)(c.Provider,{value:{type:t},"data-sentry-element":"MenuContext.Provider","data-sentry-component":"MenuContextProvider","data-sentry-source-file":"MenuContext.tsx",children:e.children})},u=()=>{let e=(0,l.useContext)(c);if(void 0===e)throw Error("MenuContext must be used within a MenuContextProvider.");return e};function m(e){let{children:t,className:a,ulClassName:l,style:r,type:s="text"}=e;return(0,n.jsx)("nav",{role:"menu","aria-label":"Sidebar","aria-orientation":"vertical","aria-labelledby":"options-menu",className:a,style:r,"data-sentry-component":"Menu","data-sentry-source-file":"Menu.tsx",children:(0,n.jsx)(d,{type:s,"data-sentry-element":"MenuContextProvider","data-sentry-source-file":"Menu.tsx",children:(0,n.jsx)("ul",{className:l,children:t})})})}m.Item=function(e){let{children:t,icon:a,active:l,rounded:i,onClick:o,doNotCloseOverlay:c=!1,showActiveBar:d=!1,style:m}=e,p=(0,r.A)("menu"),{type:h}=u(),x=[p.item.base];x.push(p.item.variants[h].base),l?x.push(p.item.variants[h].active):x.push(p.item.variants[h].normal);let f=[p.item.content.base];l?f.push(p.item.content.active):f.push(p.item.content.normal);let y=[p.item.icon.base];return l?y.push(p.item.icon.active):y.push(p.item.icon.normal),(0,n.jsxs)("li",{role:"menuitem",className:(0,s.cn)("outline-none",x),style:m,onClick:o,"aria-current":l?"page":void 0,"data-sentry-component":"Item","data-sentry-source-file":"Menu.tsx",children:[a&&(0,n.jsx)("div",{className:"".concat(y.join(" ")," min-w-fit"),children:a}),(0,n.jsx)("span",{className:f.join(" "),children:t})]})},m.Group=function(e){let{children:t,icon:a,title:l}=e,s=(0,r.A)("menu"),{type:i}=u();return(0,n.jsxs)("div",{className:[s.group.base,s.group.variants[i]].join(" "),"data-sentry-component":"Group","data-sentry-source-file":"Menu.tsx",children:[a&&(0,n.jsx)("span",{className:s.group.icon,children:a}),(0,n.jsx)("span",{className:s.group.content,children:l}),t]})},m.Misc=function(e){let{children:t}=e;return(0,n.jsx)("div",{"data-sentry-component":"Misc","data-sentry-source-file":"Menu.tsx",children:(0,n.jsx)(o.Text,{"data-sentry-element":"Typography.Text","data-sentry-source-file":"Menu.tsx",children:(0,n.jsx)("span",{children:t})})})};let p=m}}]);
try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="4fbdaa30-94bd-4a53-948c-3ad1811c85e8",e._sentryDebugIdIdentifier="sentry-dbid-4fbdaa30-94bd-4a53-948c-3ad1811c85e8")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3835,6266],{12326:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});let a=(0,n(81915).A)("Pointer",[["path",{d:"M22 14a8 8 0 0 1-8 8",key:"56vcr3"}],["path",{d:"M18 11v-1a2 2 0 0 0-2-2a2 2 0 0 0-2 2",key:"1agjmk"}],["path",{d:"M14 10V9a2 2 0 0 0-2-2a2 2 0 0 0-2 2v1",key:"wdbh2u"}],["path",{d:"M10 9.5V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v10",key:"1ibuk9"}],["path",{d:"M18 11a2 2 0 1 1 4 0v3a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15",key:"g6ys72"}]])},24572:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});let a=(0,n(81915).A)("ChevronsDown",[["path",{d:"m7 6 5 5 5-5",key:"1lc07p"}],["path",{d:"m7 13 5 5 5-5",key:"1d48rs"}]])},42667:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/editor/[id]",function(){return n(65249)}])},53428:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});let a=(0,n(81915).A)("Table2",[["path",{d:"M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18",key:"gugj83"}]])},63747:(e,t,n)=>{"use strict";n.d(t,{A:()=>P});var a=n(80263),o=n(63121),l=n(93749),r=n.n(l),i=n(73969),s=n(98466),c=n(72633),d=n(32144),u=n(80251),m=n(17769),f=n(20305),h=n(38319),g=n(25400),x=n(26010),p=n(719);async function v(e){let{projectRef:t,connectionString:n,table:a,filters:o,roleImpersonationState:l}=e,r=(0,h.Nf)(function(e){var t;let{table:n,filters:a}=e,o=new m.Query().from(n.name,null!=(t=n.schema)?t:void 0).delete();return a.filter(e=>e.value&&""!==e.value).forEach(e=>{let t=(0,p.b)(n,e);o=o.filter(e.column,e.operator,t)}),o.toSql()}({table:a,filters:o}),l),{result:i}=await (0,f.E)({projectRef:t,connectionString:n,sql:r,isRoleImpersonationEnabled:(0,g._c)(null==l?void 0:l.role)});return i}let y=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,d.jE)();return(0,u.n)(e=>v(e),{async onSuccess(t,n,o){let{projectRef:l,table:r}=n;await a.invalidateQueries(x.j.tableRowsAndCount(l,r.id)),await (null==e?void 0:e(t,n,o))},async onError(e,n,a){void 0===t?i.oR.error("Failed to delete all table rows: ".concat(e.message)):t(e,n,a)},...n})};var b=n(73980),w=n(86252);async function j(e){let{projectRef:t,connectionString:n,table:a,rows:o,roleImpersonationState:l}=e,r=(0,h.Nf)(function(e){var t;let{table:n,rows:a}=e,{primaryKeys:o,error:l}=(0,p.j)({table:n});if(l)throw l;let r=new m.Query().from(n.name,null!=(t=n.schema)?t:void 0).delete();return null==o||o.forEach(e=>{let t=a.map(t=>t[e]);r=r.filter(e,"in",t)}),r.toSql()}({table:a,rows:o}),l),{result:i}=await (0,f.E)({projectRef:t,connectionString:n,sql:r,isRoleImpersonationEnabled:(0,g._c)(null==l?void 0:l.role)});return i}let C=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=(0,d.jE)();return(0,u.n)(e=>j(e),{async onSuccess(t,n,a){let{projectRef:l,table:r}=n;await o.invalidateQueries(x.j.tableRowsAndCount(l,r.id)),await (null==e?void 0:e(t,n,a))},async onError(e,n,o){if(void 0===t){let{table:t,rows:o}=n,l=e.message.includes("Please add a primary key column"),r=e.message.includes("violates foreign key constraint"),s=o.length>1;if(r){let n=t.name,o=e.message.split("on table ")[2].replaceAll('"',""),l=e.message.split("foreign key constraint")[1].split("on table")[0].replaceAll('"',""),r=s?"Unable to delete rows as one of them is currently referenced by a foreign key constraint from the table `".concat(o,"`."):"Unable to delete row as it is currently referenced by a foreign key constraint from the table `".concat(o,"`."),c="Set an on delete behavior on the foreign key relation `".concat(l,"` in the `").concat(o,"` table to automatically respond when row(s) are being deleted in the `").concat(n,"` table.");(0,i.oR)(r,{description:(0,a.jsx)(b.o,{content:c,className:"[&>p]:m-0"}),action:(0,a.jsx)("div",{className:"w-full flex gap-x-2 !mx-0 mt-3",children:(0,a.jsx)(w.A,{href:"https://supabase.com/docs/guides/database/postgres/cascade-deletes"})})})}else l?(0,i.oR)("Unable to delete row(s) as table has no primary keys",{description:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Add a primary key column to your table first to serve as a unique identifier for each row before updating or deleting the row."}),(0,a.jsx)("div",{className:"mt-3",children:(0,a.jsx)(w.A,{href:"https://supabase.com/docs/guides/database/tables#primary-keys"})})]})}):i.oR.error("Failed to delete table row: ".concat(e.message))}else t(e,n,o)},...n})};async function N(e){let{projectRef:t,connectionString:n,table:a}=e,o=function(e){var t;let{table:n}=e;return new m.Query().from(n.name,null!=(t=n.schema)?t:void 0).truncate().toSql()}({table:a}),{result:l}=await (0,f.E)({projectRef:t,connectionString:n,sql:o});return l}let k=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,d.jE)();return(0,u.n)(e=>N(e),{async onSuccess(t,n,o){let{projectRef:l,table:r}=n;await a.invalidateQueries(x.j.tableRowsAndCount(l,r.id)),await (null==e?void 0:e(t,n,o))},async onError(e,n,a){void 0===t?i.oR.error("Failed to truncate table row: ".concat(e.message)):t(e,n,a)},...n})};var D=n(99581),S=n(16703),E=n(11509),R=n(4043),T=n(38112),A=n(22554),_=n(86336);let P=e=>{var t,n,l,d,u,m,f,h,x;let{selectedTable:p,onTableDeleted:v}=e,{data:b}=(0,S.YA)(),w=(0,E.ap)(),{filters:j,onApplyFilters:N}=(0,s.M)(),P=e=>{let{columnName:t}=e;N(j.filter(e=>e.column!==t))},{mutate:I}=(0,c.T)({onSuccess:()=>{var e;if((null==(e=w.confirmationDialog)?void 0:e.type)!=="column")return;let t=w.confirmationDialog.column;P({columnName:t.name}),i.oR.success('Successfully deleted column "'.concat(t.name,'"'))},onError:e=>{var t;if((null==(t=w.confirmationDialog)?void 0:t.type)!=="column")return;let n=w.confirmationDialog.column;i.oR.error("Failed to delete ".concat(n.name,": ").concat(e.message))},onSettled:()=>{w.closeConfirmationDialog()}}),{mutate:L}=(0,D.A)({onSuccess:async()=>{i.oR.success('Successfully deleted table "'.concat(null==p?void 0:p.name,'"')),null==v||v()},onError:e=>{i.oR.error("Failed to delete ".concat(null==p?void 0:p.name,": ").concat(e.message))},onSettled:()=>{w.closeConfirmationDialog()}}),{mutate:M,isLoading:F}=C({onSuccess:()=>{var e,t,n;(null==(e=w.confirmationDialog)?void 0:e.type)==="row"&&(null==(t=(n=w.confirmationDialog).callback)||t.call(n)),i.oR.success("Successfully deleted selected row(s)")},onSettled:()=>{w.closeConfirmationDialog()}}),{mutate:O,isLoading:z}=y({onSuccess:()=>{var e,t,n;(null==(e=w.confirmationDialog)?void 0:e.type)==="row"&&(null==(t=(n=w.confirmationDialog).callback)||t.call(n)),i.oR.success("Successfully deleted selected rows")},onError:e=>{i.oR.error("Failed to delete rows: ".concat(e.message))},onSettled:()=>{w.closeConfirmationDialog()}}),{mutate:G,isLoading:q}=k({onSuccess:()=>{var e,t,n;(null==(e=w.confirmationDialog)?void 0:e.type)==="row"&&(null==(t=(n=w.confirmationDialog).callback)||t.call(n)),i.oR.success("Successfully deleted all rows from table")},onError:e=>{i.oR.error("Failed to delete rows: ".concat(e.message))},onSettled:()=>{w.closeConfirmationDialog()}}),Q=(null==(t=w.confirmationDialog)?void 0:t.type)==="row"&&w.confirmationDialog.allRowsSelected,K=(null==(n=w.confirmationDialog)?void 0:n.type)==="row"?w.confirmationDialog.allRowsSelected?null!=(x=w.confirmationDialog.numRows)?x:0:w.confirmationDialog.rows.length:0,W=((null==(l=w.confirmationDialog)?void 0:l.type)==="column"||(null==(d=w.confirmationDialog)?void 0:d.type)==="table")&&w.confirmationDialog.isDeleteWithCascade,$=async()=>{var e;if((null==(e=w.confirmationDialog)?void 0:e.type)!=="column"||void 0===b)return;let t=w.confirmationDialog.column;void 0!==t&&I({column:t,cascade:W,projectRef:b.ref,connectionString:null==b?void 0:b.connectionString})},V=async()=>{var e;(null==(e=w.confirmationDialog)?void 0:e.type)==="table"&&void 0!==p&&L({projectRef:null==b?void 0:b.ref,connectionString:null==b?void 0:b.connectionString,id:p.id,name:p.name,schema:p.schema,cascade:W})},U=(0,g.Qj)(),Y=async()=>{var e;if(!b)return console.error("Project ref is required");if(!p)return console.error("Selected table required");if((null==(e=w.confirmationDialog)?void 0:e.type)!=="row")return;let t=w.confirmationDialog.rows;if(w.confirmationDialog.allRowsSelected)if(0===j.length){if(void 0!==U().role)return w.closeConfirmationDialog(),i.oR.error("Table truncation is not supported when impersonating a role");G({projectRef:b.ref,connectionString:b.connectionString,table:p})}else O({projectRef:b.ref,connectionString:b.connectionString,table:p,filters:j,roleImpersonationState:U()});else M({projectRef:b.ref,connectionString:b.connectionString,table:p,rows:t,roleImpersonationState:U()})};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(_.A,{variant:"destructive",size:"small",visible:(null==(u=w.confirmationDialog)?void 0:u.type)==="column",title:'Confirm deletion of column "'.concat((null==(m=w.confirmationDialog)?void 0:m.type)==="column"&&w.confirmationDialog.column.name,'"'),confirmLabel:"Delete",confirmLabelLoading:"Deleting",onCancel:()=>{w.closeConfirmationDialog()},onConfirm:$,"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"DeleteConfirmationDialogs.tsx",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Are you sure you want to delete the selected column? This action cannot be undone."}),(0,a.jsx)(R.A,{label:"Drop column with cascade?",description:"Deletes the column and its dependent objects",checked:W,onChange:()=>w.toggleConfirmationIsWithCascade(),"data-sentry-element":"Checkbox","data-sentry-source-file":"DeleteConfirmationDialogs.tsx"}),W&&(0,a.jsxs)(T.Fc,{variant:"warning",title:"Warning: Dropping with cascade may result in unintended consequences",children:[(0,a.jsx)(T.XL,{children:"All dependent objects will be removed, as will any objects that depend on them, recursively."}),(0,a.jsx)(T.TN,{children:(0,a.jsx)(A.$,{asChild:!0,size:"tiny",type:"default",icon:(0,a.jsx)(o.A,{}),children:(0,a.jsx)(r(),{href:"https://www.postgresql.org/docs/current/ddl-depend.html",target:"_blank",rel:"noreferrer",children:"About dependency tracking"})})})]})]})}),(0,a.jsx)(_.A,{variant:"destructive",size:"small",visible:(null==(f=w.confirmationDialog)?void 0:f.type)==="table",title:(0,a.jsx)("span",{className:"break-words",children:'Confirm deletion of table "'.concat(null==p?void 0:p.name,'"')}),confirmLabel:"Delete",confirmLabelLoading:"Deleting",onCancel:()=>{w.closeConfirmationDialog()},onConfirm:V,"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"DeleteConfirmationDialogs.tsx",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Are you sure you want to delete the selected table? This action cannot be undone."}),(0,a.jsx)(R.A,{label:"Drop table with cascade?",description:"Deletes the table and its dependent objects",checked:W,onChange:()=>w.toggleConfirmationIsWithCascade(!W),"data-sentry-element":"Checkbox","data-sentry-source-file":"DeleteConfirmationDialogs.tsx"}),W&&(0,a.jsxs)(T.Fc,{variant:"warning",children:[(0,a.jsx)(T.XL,{children:"Warning: Dropping with cascade may result in unintended consequences"}),(0,a.jsx)(T.TN,{children:"All dependent objects will be removed, as will any objects that depend on them, recursively."}),(0,a.jsx)(T.TN,{className:"mt-4",children:(0,a.jsx)(A.$,{asChild:!0,size:"tiny",type:"default",icon:(0,a.jsx)(o.A,{}),children:(0,a.jsx)(r(),{href:"https://www.postgresql.org/docs/current/ddl-depend.html",target:"_blank",rel:"noreferrer",children:"About dependency tracking"})})})]})]})}),(0,a.jsx)(_.A,{variant:"destructive",size:"small",visible:(null==(h=w.confirmationDialog)?void 0:h.type)==="row",title:(0,a.jsxs)("p",{className:"break-words",children:[(0,a.jsx)("span",{children:"Confirm to delete the selected row"}),(0,a.jsx)("span",{children:K>1&&"s"})]}),confirmLabel:"Delete",confirmLabelLoading:"Deleting",onCancel:()=>w.closeConfirmationDialog(),onConfirm:()=>Y(),loading:q||F||z,"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"DeleteConfirmationDialogs.tsx",children:(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)("p",{className:"text-sm text-foreground-light",children:[(0,a.jsx)("span",{children:"Are you sure you want to delete "}),(0,a.jsxs)("span",{children:[Q?"all":"the selected"," "]}),(0,a.jsx)("span",{children:K>1&&"".concat(K," ")}),(0,a.jsx)("span",{children:"row"}),(0,a.jsx)("span",{children:K>1&&"s"}),(0,a.jsx)("span",{children:"? This action cannot be undone."})]})})})]})}},65249:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>eI});var a=n(80263),o=n(53239),l=n(46491),r=n(60045),i=n(93749),s=n.n(i),c=n(67908),d=n(77395),u=n(22745),m=n(37034),f=n(101),h=n(7108),g=n(25400),x=n(11509),p=n(4939);function v(e,t){return e.indexOf(t)>=0}function y(e){let{gridRef:t,rows:n}=e,a=(0,p.Ir)(),l=(0,o.useMemo)(()=>{var e,t;return"windows"==((null==(e=navigator)?void 0:e.appVersion.indexOf("Win"))!==-1?"windows":(null==(t=navigator)?void 0:t.appVersion.indexOf("Mac"))!==-1?"macos":"unknown")?"Control":"Command"},[]);return!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],[a,l]=o.useState(),r=a=>{var o;if(!e||v(t,a.target.nodeName)||v(n,a.target.className))return;let r=(o=a).metaKey&&o.shiftKey?"Command+Shift+".concat(o.key):o.metaKey?"Command+".concat(o.key):o.shiftKey&&"Enter"===o.key?"Shift+".concat(o.key):o.ctrlKey&&o.key?"Control+".concat(o.key):o.key;e[r]&&(r.includes("+")?(a.preventDefault(),e[r](a),l(null)):(l(a.key),a.preventDefault()))},i=t=>{e&&e[t.key]&&a===t.key&&(t.preventDefault(),e[t.key](t),l(null))};o.useEffect(()=>(window.addEventListener("keydown",r),window.addEventListener("keyup",i),()=>{window.removeEventListener("keydown",r),window.removeEventListener("keyup",i)}))}({["".concat(l,"+ArrowUp")]:e=>{if(e.stopPropagation(),a.selectedCellPosition){var n,o;let e={idx:null!=(o=null==(n=a.selectedCellPosition)?void 0:n.idx)?o:0,rowIdx:0};t.current.selectCell(e)}else t.current.scrollToCell({rowIdx:Number(0)})},["".concat(l,"+ArrowDown")]:e=>{if(e.stopPropagation(),a.selectedCellPosition){var o,l;let e={idx:null!=(l=null==(o=a.selectedCellPosition)?void 0:o.idx)?l:0,rowIdx:n.length>1?n.length-1:0};t.current.selectCell(e)}else t.current.scrollToCell({rowIdx:Number(n.length)})},["".concat(l,"+ArrowLeft")]:e=>{var n,o;e.stopPropagation();let l={idx:a.gridColumns.filter(e=>e.frozen).length,rowIdx:null!=(o=null==(n=a.selectedCellPosition)?void 0:n.rowIdx)?o:0};t.current.selectCell(l)},["".concat(l,"+ArrowRight")]:e=>{var n,o,l;e.stopPropagation(),null==(o=t.current)||o.selectCell({idx:a.gridColumns.length-2,rowIdx:null!=(l=null==(n=a.selectedCellPosition)?void 0:n.rowIdx)?l:0})}},["INPUT","TEXTAREA","SELECT"]),null}var b=n(80952),w=n(30382),j=n(76834),C=n(74388),N=n(16703),k=n(54887),D=n(96777),S=n(75820),E=n(32513),R=n(70891),T=n(98466),A=n(14875),_=n(22554),P=n(35741),I=n(29503),L=n(86336),M=n(23542);let F=e=>{if(0===e)return"0";let t=Math.floor(Math.log(e)/Math.log(1e3)),n=t>4?"T":["","K","M","B","T"][t];return"".concat((e/Math.pow(1e3,t>4?4:t)).toFixed(1)).concat(n)},O=[{value:100,label:"100 rows"},{value:500,label:"500 rows"},{value:1e3,label:"1000 rows"}],z=()=>{var e,t;let{id:n}=(0,l.g)(),r=n?Number(n):void 0,{data:i}=(0,N.YA)(),s=(0,x.ap)(),c=(0,p.Ir)(),{data:d}=(0,j.Pk)({projectRef:null==i?void 0:i.ref,connectionString:null==i?void 0:i.connectionString,id:r}),u=(0,C.bI)(d)?d.live_rows_estimate:null,{filters:m}=(0,T.M)(),f=c.page,h=(0,g.RY)(),[v,y]=(0,o.useState)(!1),[b,w]=(0,o.useState)(!1),[k,D]=(0,o.useState)(!1),[z,G]=(0,o.useState)(f.toString());(0,o.useEffect)(()=>{G(String(f))},[f]);let{data:q,isLoading:Q,isSuccess:K,isError:W,isFetching:$,error:V}=(0,A.gt)({projectRef:null==i?void 0:i.ref,connectionString:null==i?void 0:i.connectionString,tableId:c.table.id,filters:m,enforceExactCount:c.enforceExactCount,roleImpersonationState:h},{keepPreviousData:!0}),U=(null==q?void 0:q.is_estimate)?F(q.count):null==q?void 0:q.count.toLocaleString(),Y=Math.ceil((null!=(e=null==q?void 0:q.count)?e:0)/s.rowsPerPage),H=(null!=(t=null==q?void 0:q.count)?t:0)>0?Y:1,X=()=>{Z()},B=()=>{J()},Z=()=>{let e=f-1;c.setPage(e)},J=()=>{let e=f+1;c.setPage(e)},ee=e=>{let t=e>Y?Y:e;c.setPage(t||1)};return(0,o.useEffect)(()=>{f&&f>H&&c.setPage(H)},[f,H]),(0,o.useEffect)(()=>{void 0!==r&&c.setEnforceExactCount(null!==u&&u<=A.kd)},[r]),(0,o.useEffect)(()=>{W&&c.enforceExactCount&&(null==V?void 0:V.code)===408&&c.setEnforceExactCount(!1)},[W,c.enforceExactCount,null==V?void 0:V.code]),(0,a.jsxs)("div",{className:"flex items-center gap-x-4","data-sentry-component":"Pagination","data-sentry-source-file":"Pagination.tsx",children:[Q&&(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Loading records count..."}),K&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,a.jsx)(_.$,{"aria-label":"Previous page",icon:(0,a.jsx)(S.A,{}),type:"outline",className:"px-1.5",disabled:f<=1||Q,onClick:()=>{f>1&&(c.selectedRows.size>=1?w(!0):Z())}}),(0,a.jsx)("p",{className:"text-xs text-foreground-light",children:"Page"}),(0,a.jsx)(I.p,{className:"w-12",size:"tiny",min:1,max:Y,value:z,onChange:e=>G(e.target.value),onKeyDown:e=>{let t=Number(z);"Enter"===e.code&&!Number.isNaN(t)&&t>=1&&t<=Y&&ee(t)}}),(0,a.jsxs)("p",{className:"text-xs text-foreground-light",children:["of ",H.toLocaleString()]}),(0,a.jsx)(_.$,{"aria-label":"Next page",icon:(0,a.jsx)(E.A,{}),type:"outline",className:"px-1.5",disabled:f>=Y||Q,onClick:()=>{f<Y&&(c.selectedRows.size>=1?y(!0):J())}}),(0,a.jsx)(M.X,{options:O,onSelect:e=>{let t=Number(e);s.setRowsPerPage(isNaN(t)?100:t)},side:"top",align:"start",children:(0,a.jsx)(_.$,{asChild:!0,type:"outline",style:{padding:"3px 10px"},children:(0,a.jsx)("span",{children:"".concat(s.rowsPerPage," rows")})})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,a.jsxs)("p",{className:"text-xs text-foreground-light",children:["".concat(U," ").concat(0===q.count||q.count>1?"records":"record")," ",q.is_estimate?"(estimated)":""]}),q.is_estimate&&(0,a.jsxs)(P.m_,{children:[(0,a.jsx)(P.k$,{asChild:!0,children:(0,a.jsx)(_.$,{size:"tiny",type:"text",className:"px-1.5",loading:$,icon:(0,a.jsx)(R.A,{}),onClick:()=>{null===u||q.count>A.kd?D(!0):c.setEnforceExactCount(!0)}})}),(0,a.jsxs)(P.ZI,{side:"top",className:"w-72",children:["This is an estimated value as your table has more than"," ",A.kd.toLocaleString()," rows. ",(0,a.jsx)("br",{}),(0,a.jsx)("span",{className:"text-brand",children:"Click to retrieve the exact count of the table."})]})]})]})]}),W&&(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Error fetching records count. Please refresh the page."}),(0,a.jsx)(L.A,{visible:b,title:"Confirm moving to previous page",confirmLabel:"Confirm",onCancel:()=>w(!1),onConfirm:()=>{X()},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"Pagination.tsx",children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"The currently selected lines will be deselected, do you want to proceed?"})}),(0,a.jsx)(L.A,{visible:v,title:"Confirm moving to next page",confirmLabel:"Confirm",onCancel:()=>y(!1),onConfirm:()=>{B()},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"Pagination.tsx",children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"The currently selected lines will be deselected, do you want to proceed?"})}),(0,a.jsx)(L.A,{variant:"warning",visible:k,title:"Confirm to fetch exact count for table",confirmLabel:"Retrieve exact count",onCancel:()=>D(!1),onConfirm:()=>{c.setEnforceExactCount(!0),D(!1)},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"Pagination.tsx",children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:null===u?"If your table has a row count of greater than ".concat(A.kd.toLocaleString()," rows,\n          retrieving the exact count of the table may cause performance issues on your database."):"Your table has a row count of greater than ".concat(A.kd.toLocaleString()," rows, and\n          retrieving the exact count of the table may cause performance issues on your database.")})})]})},G=e=>{let{isRefetching:t}=e,{id:n}=(0,l.g)(),o=n?Number(n):void 0,{data:r}=(0,N.YA)(),{data:i}=(0,j.Pk)({projectRef:null==r?void 0:r.ref,connectionString:null==r?void 0:r.connectionString,id:o}),[{view:s="data"},c]=(0,k.W)(),d=(0,C.b4)(i),u=(0,C.KO)(i);return(0,a.jsxs)(b.C,{"data-sentry-element":"GridFooter","data-sentry-component":"Footer","data-sentry-source-file":"Footer.tsx",children:["data"===s&&(0,a.jsx)(z,{}),(0,a.jsxs)("div",{className:"ml-auto flex items-center gap-x-2",children:[i&&"data"===s&&(0,a.jsx)(D.A,{tableId:i.id,isRefetching:t}),(d||u)&&(0,a.jsx)(w.A,{width:75,options:["definition","data"],activeOption:s,borderOverride:"border",onClickOption:e=>{"data"===e?c({view:void 0}):c({view:e})}})]})]})};var q=n(24560),Q=n(56028),K=n(78741),W=n(85890),$=n(92589),V=n(79739),U=n(60885),Y=n(86992),H=n(52445),X=n(50676),B=n(80127),Z=n(96827),J=n(32144),ee=n(73969),et=n(94887),en=n(86252),ea=n(26010),eo=n(51081),el=n(9711),er=n(60627);function ei(e,t){let{show:n}=(0,el.EF)();return(0,a.jsx)(q.fI,{...t,onContextMenu:function(e){n(e,{id:er.JY,props:{rowIdx:t.rowIdx}})},"data-sentry-element":"Row","data-sentry-component":"RowRenderer","data-sentry-source-file":"RowRenderer.tsx"},e)}let es=e=>{var t;return null!=(t=null==e?void 0:e.idx)?t:-1},ec=(0,o.memo)((0,o.forwardRef)((e,t)=>{var n,l;let{width:r,height:i,containerClass:s,gridClass:c,rowClass:d,rows:u,error:m,isLoading:f,isSuccess:h,isError:v,filters:y,onApplyFilters:b}=e,w=(0,x.ap)(),j=(0,p.Ir)(),{data:k}=(0,H.s)(),{data:D}=(0,N.YA)(),S=function(e){let t=(0,J.jE)(),{data:n}=(0,N.YA)(),l=(0,p.Ir)(),r=(0,g.Qj)(),{mutate:i}=(0,eo.oG)({async onMutate(e){let{projectRef:n,table:a,configuration:o,payload:l}=e,r=new Set(Object.keys(o.identifiers)),i=ea.j.tableRows(n,{table:{id:a.id}});await t.cancelQueries(i);let s=t.getQueriesData(i);return t.setQueriesData(i,e=>{var t;return{rows:null!=(t=null==e?void 0:e.rows.map(e=>Object.entries(e).filter(e=>{let[t]=e;return r.has(t)}).every(e=>{let[t,n]=e;return n===o.identifiers[t]})?{...e,...l}:e))?t:[]}}),{previousRowsQueries:s}},onError(e,n,a){var o;let{previousRowsQueries:l}=a;l.forEach(e=>{let[n,a]=e;a&&t.setQueriesData(n,a),t.invalidateQueries(n)}),ee.oR.error(null!=(o=null==e?void 0:e.message)?o:e)}});return(0,o.useCallback)((t,o)=>{var s;if(!n)return;let c=t[o.indexes[0]],d=e.find(e=>e.idx==c.idx),u=Object.keys(c).find(e=>c[e]!==d[e]);if(!d||!u)return;let m={[u]:c[u]},f=null==(s=l.originalTable.columns)?void 0:s.filter(e=>{var t;return(null!=(t=null==e?void 0:e.enums)?t:[]).length>0&&"array"===e.data_type.toLowerCase()}).map(e=>e.name),h={};if((0,C.KO)(l.originalTable)&&l.originalTable.primary_keys.forEach(e=>{let t=l.originalTable.columns.find(t=>t.name===e.name);h[e.name]=(null==t?void 0:t.format)==="bytea"?(0,et.ds)(d[e.name]):d[e.name]}),0===Object.keys(h).length)return(0,ee.oR)("Unable to update row as table has no primary keys",{description:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Add a primary key column to your table first to serve as a unique identifier for each row before updating or deleting the row."}),(0,a.jsx)("div",{className:"mt-3",children:(0,a.jsx)(en.A,{href:"https://supabase.com/docs/guides/database/tables#primary-keys"})})]})});i({projectRef:n.ref,connectionString:n.connectionString,table:l.originalTable,configuration:{identifiers:h},payload:m,enumArrayColumns:f,roleImpersonationState:r()})},[r,i,n,e,l.originalTable])}(u),E=(0,o.useRef)(null),R=j.table,T=null==(n=j.originalTable)?void 0:n.entity_type,A=T===U.z.FOREIGN_TABLE,P=0===(null!=u?u:[]).length,{mutate:I}=(0,Y.h)(),{isDraggedOver:L,onDragOver:M,onFileDrop:F}=function(e){let{enabled:t,onFileDropped:n,onTelemetryEvent:a}=e,[l,r]=(0,o.useState)(!1),i=(0,o.useCallback)(e=>{t&&("dragover"!==e.type||l?("dragleave"===e.type||"drop"===e.type)&&r(!1):r(!0),e.stopPropagation(),e.preventDefault())},[t,l]),s=(0,o.useCallback)(e=>{if(!t)return;i(e);let[o]=e.dataTransfer.files;(0,X.Pz)(o)||(n(o),null==a||a("import_data_dropzone_file_added"))},[t,i,n,a]);return{isDraggedOver:l,onDragOver:i,onFileDrop:s}}({enabled:P&&!A,onFileDropped:e=>w.onImportData((0,Q.KR)(e)),onTelemetryEvent:e=>{var t,n;I({action:e,groups:{project:null!=(t=null==D?void 0:D.ref)?t:"Unknown",organization:null!=(n=null==k?void 0:k.slug)?n:"Unknown"}})}}),{data:O}=(0,V.Hw)({projectRef:null==D?void 0:D.ref,connectionString:null==D?void 0:D.connectionString,schema:null!=(l=null==R?void 0:R.schema)?l:void 0}),z=()=>{b([])};return(0,a.jsxs)("div",{className:(0,B.cn)("flex flex-col relative transition-colors",s,P&&L&&"border-2 border-dashed border-brand-600"),style:{width:r||"100%",height:i||"50vh"},onDragOver:M,onDragLeave:M,onDrop:F,children:[0===(null!=u?u:[]).length&&(0,a.jsxs)("div",{style:{height:"calc(100% - 35px)"},className:"absolute top-9 p-2 w-full z-[1] pointer-events-none",children:[f&&(0,a.jsx)(Z.y,{}),v&&(0,a.jsx)($.A,{className:"pointer-events-auto",error:m,subject:"Failed to retrieve rows from table",children:y.length>0&&(0,a.jsx)("p",{children:"Verify that the filter values are correct, as the error may stem from an incorrectly applied filter"})}),h&&(0,a.jsx)(a.Fragment,{children:0===(null!=y?y:[]).length?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center col-span-full h-full",children:[(0,a.jsx)("p",{className:"text-sm text-light",children:L?"Drop your CSV file here":"This table is empty"}),T===U.z.FOREIGN_TABLE?(0,a.jsx)("div",{className:"flex items-center space-x-2 mt-4",children:(0,a.jsx)("p",{className:"text-sm text-light",children:"This table is a foreign table. Add data to the connected source to get started."})}):!L&&(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4 mt-4",children:[(0,a.jsx)(_.$,{type:"default",className:"pointer-events-auto",onClick:()=>{var e,t;w.onImportData(),I({action:"import_data_button_clicked",properties:{tableType:"Existing Table"},groups:{project:null!=(e=null==D?void 0:D.ref)?e:"Unknown",organization:null!=(t=null==k?void 0:k.slug)?t:"Unknown"}})},children:"Import data from CSV"}),(0,a.jsx)("p",{className:"text-xs text-foreground-light",children:"or drag and drop a CSV file here"})]})]}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center col-span-full",children:[(0,a.jsx)("p",{className:"text-sm text-light",children:"The filters applied have returned no results from this table"}),(0,a.jsx)("div",{className:"flex items-center space-x-2 mt-4",children:(0,a.jsx)(_.$,{type:"default",className:"pointer-events-auto",onClick:()=>z(),children:"Remove all filters"})})]})})]}),(0,a.jsx)(q.Ay,{ref:t,className:"".concat(c," flex-grow"),rowClass:d,columns:j.gridColumns,rows:null!=u?u:[],renderers:{renderRow:ei},rowKeyGetter:es,selectedRows:j.selectedRows,onColumnResize:j.updateColumnSize,onRowsChange:S,onSelectedCellChange:function(e){E.current=e,j.setSelectedCellPosition({idx:e.column.idx,rowIdx:e.rowIdx})},onSelectedRowsChange:function(e){j.setSelectedRows(e)},onCellDoubleClick:e=>(function(e,t){let n=function(e){var t,n;let{targetTableSchema:a,targetTableName:o,targetColumnName:l}=null!=(n=null==R||null==(t=R.columns.find(t=>t.name==e))?void 0:t.foreignKey)?n:{},r=null==O?void 0:O.find(t=>t.source_schema===(null==R?void 0:R.schema)&&t.source_table===(null==R?void 0:R.name)&&t.source_columns.includes(e)&&t.target_schema===a&&t.target_table===o&&t.target_columns.includes(null!=l?l:""));return void 0!==r?(0,W.C)([r])[0]:void 0}(t.name);n&&w.onEditForeignKeyColumnValue({foreignKey:n,row:e,column:t})})(e.row,e.column),onCellKeyDown:K.GL})]})}));var ed=n(65037),eu=n(42512);let em=e=>{var t;let{customHeader:n,gridProps:r,children:i}=e,{id:s}=(0,l.g)(),c=s?Number(s):void 0,{data:v}=(0,N.YA)(),b=(0,x.ap)(),w=(0,p.Ir)(),j=(0,o.useRef)(null),[C,k]=(0,o.useState)(!1),{filters:D,onApplyFilters:S}=(0,T.M)(),{sorts:E,onApplySorts:R}=(0,eu.G)(),A=(0,g.RY)(),{data:_,error:P,isSuccess:I,isError:L,isLoading:M,isRefetching:F}=(0,f.vs)({projectRef:null==v?void 0:v.ref,connectionString:null==v?void 0:v.connectionString,tableId:c,sorts:E,filters:D,page:w.page,limit:b.rowsPerPage,roleImpersonationState:A},{keepPreviousData:!0,retryDelay:(e,t)=>{var n,a,o;let l=t&&(null==(n=t.message)?void 0:n.includes("does not exist")),r=null==(a=t.message)?void 0:a.includes("Too Many Requests"),i=null==(o=t.message)?void 0:o.includes("query vault failed");return(l&&R([]),e>3||l||r||i)?1/0:5e3}});(0,o.useEffect)(()=>{C||k(!0)},[]);let O=null!=(t=null==_?void 0:_.rows)?t:h.Oj;return(0,a.jsx)(d.Q,{backend:u.t2,context:window,"data-sentry-element":"DndProvider","data-sentry-component":"SupabaseGrid","data-sentry-source-file":"SupabaseGrid.tsx",children:(0,a.jsxs)("div",{className:"sb-grid h-full flex flex-col",children:[(0,a.jsx)(ed.Ay,{customHeader:n,"data-sentry-element":"Header","data-sentry-source-file":"SupabaseGrid.tsx"}),i||(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ec,{ref:j,...r,rows:O,error:P,isLoading:M,isSuccess:I,isError:L,filters:D,onApplyFilters:S}),(0,a.jsx)(G,{isRefetching:F}),(0,a.jsx)(y,{gridRef:j,rows:O})]}),C&&(0,m.createPortal)((0,a.jsx)(er.Td,{rows:O}),document.body)]})})};var ef=n(75831),eh=n(62308),eg=n(19335),ex=n(45783),ep=n(50922),ev=n(63747),ey=n(86256),eb=n(14360),ew=n(796),ej=n(14132),eC=n(86092),eN=n(89057),ek=n(60195),eD=n(46895);let eS=e=>{let{entity:t}=e,{ref:n}=(0,l.g)(),r=(0,o.useRef)(null),i=(0,o.useRef)(null),{resolvedTheme:c}=(0,ew.D)(),{data:d}=(0,N.YA)(),u=(0,eN.G_)({id:null==t?void 0:t.id,projectRef:null==d?void 0:d.ref,connectionString:null==d?void 0:d.connectionString},{enabled:(0,C.b4)(t)}),m=(0,eC.$)({id:null==t?void 0:t.id,projectRef:null==d?void 0:d.ref,connectionString:null==d?void 0:d.connectionString},{enabled:(0,C.KO)(t)}),{data:f,isLoading:h}=(0,C.b4)(t)?u:m,g=(0,C.eg)(t)?"create view ".concat(t.schema,".").concat(t.name," as\n"):(0,C.rW)(t)?"create materialized view ".concat(t.schema,".").concat(t.name," as\n"):"",x=(0,o.useMemo)(()=>f?(0,ek.A)(g+f):void 0,[f]),p=async(e,t)=>{r.current=e,i.current=t,e.changeViewZones(e=>{e.addZone({afterLineNumber:0,heightInPx:4,domNode:document.createElement("div")})}),await (0,eD.wR)(500),null==e||e.focus()};return h?(0,a.jsxs)("div",{className:"h-full grid",children:[(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)(ej.y,{})}),(0,a.jsx)("div",{className:"mt-auto",children:(0,a.jsx)(G,{})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex-grow overflow-y-auto border-t border-muted relative",children:[(0,a.jsx)(_.$,{asChild:!0,type:"default",className:"absolute top-2 right-5 z-10","data-sentry-element":"Button","data-sentry-source-file":"TableDefinition.tsx",children:(0,a.jsx)(s(),{href:"/project/".concat(n,"/sql/new?content=").concat(encodeURIComponent(null!=x?x:"")),"data-sentry-element":"Link","data-sentry-source-file":"TableDefinition.tsx",children:"Open in SQL Editor"})}),(0,a.jsx)(eb.default,{className:"monaco-editor",theme:(null==c?void 0:c.includes("dark"))?"vs-dark":"vs",onMount:p,defaultLanguage:"pgsql",value:x,path:"",options:{domReadOnly:!0,readOnly:!0,tabSize:2,fontSize:13,minimap:{enabled:!1},wordWrap:"on",fixedOverflowWidgets:!0},"data-sentry-element":"Editor","data-sentry-source-file":"TableDefinition.tsx"})]}),(0,a.jsx)(G,{"data-sentry-element":"Footer","data-sentry-source-file":"TableDefinition.tsx"})]})},eE=e=>{var t;let{isLoadingSelectedTable:n=!1,selectedTable:i}=e,d=(0,c.useRouter)(),u=(0,eg.qM)(),{ref:m,id:f}=(0,l.g)(),h=(0,ex.zv)();(0,K.VO)({projectRef:m,table:i});let[{view:g="data"}]=(0,k.W)(),x=(0,ef.SE)(r.aG.TENANT_SQL_ADMIN_WRITE,"tables"),v=(0,ef.SE)(r.aG.TENANT_SQL_ADMIN_WRITE,"columns"),y=f?h.openTabs.find(e=>e.endsWith(f)):void 0,b=h.openTabs.filter(e=>!e.startsWith("sql")),w=(0,o.useCallback)(()=>{m&&u.setDashboardHistory(m,"editor",void 0)},[u,m]),j=(0,o.useCallback)(e=>{d.push("/project/".concat(m,"/editor/").concat(e.id))},[m,d]),N=(0,o.useCallback)(async()=>{if(i){let e=(0,ex.lW)(i.entity_type,{id:i.id});h.handleTabClose({id:e,router:d,editor:"table",onClearDashboardHistory:w})}},[w,d,i,h]),{isSchemaLocked:D}=(0,eh.BQ)({schema:null!=(t=null==i?void 0:i.schema)?t:""});if(n||!m)return(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("div",{className:"h-10 bg-dash-sidebar dark:bg-surface-100"}),(0,a.jsx)("div",{className:"h-9 border-y"}),(0,a.jsx)("div",{className:"p-2 col-span-full",children:(0,a.jsx)(Z.y,{})})]});if(!i)return(0,a.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,a.jsx)("div",{className:"w-[400px]",children:(0,a.jsx)(ep.Z,{type:"default",title:"Unable to find your table with ID ".concat(f),description:"This table doesn't exist in your database",children:y?(0,a.jsx)(_.$,{type:"default",className:"mt-2",onClick:()=>{h.handleTabClose({id:y,router:d,editor:"table",onClearDashboardHistory:w})},children:"Close tab"}):b.length>0?(0,a.jsx)(_.$,{asChild:!0,type:"default",className:"mt-2",onClick:()=>u.setDashboardHistory(m,"editor",void 0),children:(0,a.jsx)(s(),{href:"/project/".concat(m,"/editor/").concat(b[0].split("-")[1]),children:"Close tab"})}):(0,a.jsx)(_.$,{asChild:!0,type:"default",className:"mt-2",onClick:()=>u.setDashboardHistory(m,"editor",void 0),children:(0,a.jsx)(s(),{href:"/project/".concat(m,"/editor"),children:"Head back"})})})})});let S=(0,C.eg)(i)||(0,C.rW)(i),E=(0,C.KO)(i),R=!(!x&&!v)&&E&&!D,T="".concat(i.schema,"_").concat(i.name);return(0,a.jsx)("div",{className:"h-full",onClick:()=>h.makeActiveTabPermanent(),"data-sentry-component":"TableGridEditor","data-sentry-source-file":"TableGridEditor.tsx",children:(0,a.jsxs)(p.HQ,{projectRef:m,table:i,editable:R,"data-sentry-element":"TableEditorTableStateContextProvider","data-sentry-source-file":"TableGridEditor.tsx",children:[(0,a.jsx)(em,{gridProps:{height:"100%"},customHeader:(S||E)&&"definition"===g?(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("p",{children:["SQL Definition of ",(0,a.jsx)("code",{className:"text-sm",children:i.name})," "]}),(0,a.jsx)("p",{className:"text-foreground-light text-sm",children:"(Read only)"})]}):null,"data-sentry-element":"SupabaseGrid","data-sentry-source-file":"TableGridEditor.tsx",children:(S||E)&&"definition"===g&&(0,a.jsx)(eS,{entity:i})},T),(0,a.jsx)(ey.A,{editable:R,selectedTable:(0,C.KO)(i)?i:void 0,onTableCreated:j,"data-sentry-element":"SidePanelEditor","data-sentry-source-file":"TableGridEditor.tsx"}),(0,a.jsx)(ev.A,{selectedTable:(0,C.KO)(i)?i:void 0,onTableDeleted:N,"data-sentry-element":"DeleteConfirmationDialogs","data-sentry-source-file":"TableGridEditor.tsx"})]},"table-editor-table-".concat(i.id))})};var eR=n(78311),eT=n(52672),eA=n(78561),e_=n(19164);let eP=()=>{let{id:e,ref:t}=(0,l.g)(),n=e?Number(e):void 0,r=(0,ex.zv)(),{data:i}=(0,N.YA)(),{data:s,isLoading:c}=(0,j.Pk)({projectRef:null==i?void 0:i.ref,connectionString:null==i?void 0:i.connectionString,id:n});return(0,o.useEffect)(()=>{if(s&&t){let e=(0,ex.lW)(s.entity_type,{id:s.id});r.tabsMap[e]?r.makeTabActive(e):r.addTab({id:e,type:s.entity_type,label:s.name,metadata:{schema:s.schema,name:s.name,tableId:n}})}},[s,n,t]),(0,a.jsx)(eE,{isLoadingSelectedTable:c,selectedTable:s,"data-sentry-element":"TableGridEditor","data-sentry-component":"TableEditorPage","data-sentry-source-file":"[id].tsx"})};eP.getLayout=e=>(0,a.jsx)(eR.A,{children:(0,a.jsx)(eT.$,{productMenu:(0,a.jsx)(e_.X,{}),product:"Table Editor",productMenuClassName:"overflow-y-hidden",children:(0,a.jsx)(eA.A,{children:e})})});let eI=eP},80952:(e,t,n)=>{"use strict";n.d(t,{C:()=>l});var a=n(80263),o=n(80127);let l=e=>{let{children:t,className:n}=e;return(0,a.jsx)("div",{"aria-label":"Table grid footer",className:(0,o.cn)("flex min-h-9 h-9 overflow-hidden overflow-x-auto items-center px-2 w-full border-t",n),"data-sentry-component":"GridFooter","data-sentry-source-file":"GridFooter.tsx",children:t})}},87418:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});let a=(0,n(81915).A)("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[89,2313,4335,673,7494,726,5476,4915,7074,4560,2735,8444,6110,3895,1168,7795,9587,5348,5175,4654,3258,3923,3013,9147,3144,1830,4844,6692,6123,3340,7532,4352,304,6416,8311,1041,5983,3444,8294,3792,8587,1391,1411,753,3462,636,6593,8792],()=>t(42667)),_N_E=e.O()}]);
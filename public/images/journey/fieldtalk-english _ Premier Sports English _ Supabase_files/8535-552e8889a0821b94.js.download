try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="efbaff5d-3b10-47fe-9a9e-38b01d9978ba",e._sentryDebugIdIdentifier="sentry-dbid-efbaff5d-3b10-47fe-9a9e-38b01d9978ba")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8535],{943:(e,t,a)=>{"use strict";a.d(t,{tV:()=>c,_X:()=>d});var n=a(22990),s=a(56947),r=a(20305);let l={databaseRoles:e=>["projects",e,"database-roles"]},i=n.A.roles.list();async function o(e,t){let{projectRef:a,connectionString:n}=e,{result:s}=await (0,r.E)({projectRef:a,connectionString:n,sql:i.sql,queryKey:["database-roles"]},t);return s}let d=function(e){let{projectRef:t,connectionString:a}=e,{enabled:n=!0,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.I)(l.databaseRoles(t),e=>{let{signal:n}=e;return o({projectRef:t,connectionString:a},n)},{enabled:n&&void 0!==t,...r})};function c(e,t){return e.invalidateQueries(l.databaseRoles(t))}},7767:(e,t,a)=>{"use strict";a.d(t,{A:()=>c});var n=a(80263),s=a(53239),r=a(65988),l=a(92413),i=a(38583);let o=(0,s.createContext)({parentCallback:e=>{},type:"",name:"",activeId:"",parentSize:""});function d(e){var t;let{id:a=(t=46656*Math.random()|0,("00000"+(46656*Math.random()|0).toString(36)).slice(-3)+("00000"+t.toString(36)).slice(-3)),disabled:s,value:r,label:d,afterLabel:c,beforeLabel:u,description:m,name:x,checked:p,className:h,onChange:f,onBlur:y,hidden:j=!1,size:g="medium",align:b="vertical",optionalLabel:v,addOnBefore:N,children:w}=e,S=(0,l.A)("radio"),{handleBlur:C}=(0,i.x)();function A(e){C&&C(e),y&&y(e)}return(0,n.jsx)(o.Consumer,{"data-sentry-element":"RadioContext.Consumer","data-sentry-component":"Radio","data-sentry-source-file":"Radio.tsx",children:e=>{let{parentCallback:t,type:l,name:i,activeId:o,parentSize:y}=e;g=y||g;let C=o===a||!!p||!1!==p&&void 0,E=[h,S.variants[l].container.base,"list"===l&&!j&&S.variants[l].container.size[g]];return E.push(S.variants[l].base),E.push(S.variants[l].size[g]),C?E.push(S.variants[l].active):E.push(S.variants[l].inactive),s&&E.push(S.disabled),"list"!==l&&(j=!0),(0,n.jsxs)("label",{htmlFor:a,className:E.join(" "),children:[(0,n.jsx)("input",{id:a,name:i||x,type:"radio",className:[S.base,S.size[g],j&&S.hidden,S.variants[l].radio_offset,""].join(" "),checked:C,disabled:s,value:r||a,onChange:e=>{t&&t(e),f&&f(e)},onBlur:A}),N,w||(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:[S.label.base,S.label[g],S.variants[l].container.align[b]].join(" "),children:[u&&(0,n.jsx)("div",{className:[S.label_before.base,S.label_before[g]].join(" "),children:u}),(0,n.jsx)("div",{children:d}),c&&(0,n.jsx)("div",{className:[S.label_after.base,S.label_after[g]].join(" "),children:c}),m&&(0,n.jsx)("div",{className:[S.description.base,S.description[g]].join(" "),children:m})]}),v&&(0,n.jsx)("div",{className:[S.optionalLabel.base,S.optionalLabel[g]].join(" "),children:v})]})]})}})}d.Group=function(e){let{id:t,layout:a,error:c,descriptionText:u,label:m,afterLabel:x,beforeLabel:p,labelOptional:h,children:f,className:y,type:j="list",options:g,value:b,name:v,onChange:N,size:w="medium",validation:S,groupClassName:C,labelsLayout:A="vertical"}=e,[E,R]=(0,s.useState)(""),_=(0,l.A)("radio"),{formContextOnChange:k,values:T,errors:F,touched:I,fieldLevelValidation:L}=(0,i.x)();return T&&!b&&(b=T[t||v]),c||(F&&!c&&(c=F[t||v]),c=I&&I[t||v]?c:void 0),(0,s.useEffect)(()=>{S&&L(t,S(b))},[]),(0,s.useEffect)(()=>{R(b)},[b]),(0,n.jsx)("fieldset",{name:v,className:y,"data-sentry-component":"RadioGroup","data-sentry-source-file":"Radio.tsx",children:(0,n.jsx)(r.H,{nonBoxInput:!0,label:m,afterLabel:x,beforeLabel:p,labelOptional:h,layout:a,id:t,error:c,descriptionText:u,size:w,labelLayout:A,"data-sentry-element":"FormLayout","data-sentry-source-file":"Radio.tsx",children:(0,n.jsx)("div",{className:C||_.variants[j].group,children:(0,n.jsx)(o.Provider,{value:{parentCallback:function(e){N&&N(e),k&&k(e),S&&L(t,S(e.target.value)),R(e.target.id)},type:j,name:v,activeId:E,parentSize:w},"data-sentry-element":"RadioContext.Provider","data-sentry-source-file":"Radio.tsx",children:g?g.map(e=>(0,n.jsx)(d,{id:e.id,label:e.label,beforeLabel:e.beforeLabel,afterLabel:e.afterLabel,value:e.value,description:e.description})):f})})})})};let c=d},11094:(e,t,a)=>{"use strict";a.d(t,{A0:()=>i,BF:()=>o,Gg:()=>d,Hj:()=>c,XI:()=>l,nA:()=>m,nd:()=>u,r6:()=>x});var n=a(80263),s=a(53239),r=a(80127);let l=s.forwardRef((e,t)=>{let{className:a,containerProps:s,...l}=e;return(0,n.jsx)("div",{className:(0,r.cn)("w-full overflow-auto"),...s,children:(0,n.jsx)("table",{ref:t,className:(0,r.cn)("w-full caption-bottom text-sm",a),...l})})});l.displayName="Table";let i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("thead",{ref:t,className:(0,r.cn)("[&_tr]:border-b [&>tr]:bg-200",a),...s})});i.displayName="TableHeader";let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("tbody",{ref:t,className:(0,r.cn)("[&_tr:last-child]:border-0",a),...s})});o.displayName="TableBody";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("tfoot",{ref:t,className:(0,r.cn)("bg-primary font-medium text-primary-foreground",a),...s})});d.displayName="TableFooter";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("tr",{ref:t,className:(0,r.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...s})});c.displayName="TableRow";let u=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("th",{ref:t,className:(0,r.cn)("h-10 px-4 text-left align-middle heading-meta text-foreground-lighter [&:has([role=checkbox])]:pr-0",a),...s})});u.displayName="TableHead";let m=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("td",{ref:t,className:(0,r.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...s})});m.displayName="TableCell";let x=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("caption",{ref:t,className:(0,r.cn)("mt-4 text-sm text-foreground-muted",a),...s})});x.displayName="TableCaption"},11301:(e,t,a)=>{"use strict";a.d(t,{GQ:()=>r,Il:()=>l});var n=a(97344),s=a.n(n);function r(e){let t=null==e?void 0:e.split(",").map(e=>e.trim());return s()(e)||!t||0===t.length?{value:[]}:{value:t.map(e=>{let t=e.match(/(\w+)\s+([\w\[\]]+)(?:\s+DEFAULT\s+(.*))?/i);if(!t)return console.error("Error while trying to parse function arguments",e),null;{let[,e,a,n]=t,s=n?n.trim():void 0;return["timestamp","time","timetz","timestamptz"].includes(a.toLowerCase())&&s&&(s="'".concat(s,"'")),{name:e,type:a,defaultValue:s}}}).filter(Boolean)}}function l(e){let t=[];if(e)for(var a in e)t.push({name:a,value:e[a]});return{value:t}}},15419:(e,t,a)=>{"use strict";a.d(t,{A:()=>d});var n=a(80263),s=a(93749),r=a.n(s),l=a(98615),i=a(34531),o=a(22554);let d=e=>{let{name:t="",isActive:a,isExternal:s,icon:d,rightIcon:c,url:u="",target:m="_self",onClick:x,textClassName:p="",hoverText:h="",label:f}=e,y=(0,n.jsx)(l.Ay.Item,{icon:d,rounded:!0,active:a,onClick:x,children:(0,n.jsxs)("div",{className:"flex w-full items-center justify-between gap-1",children:[(0,n.jsxs)("div",{title:h||("string"==typeof t?t:""),className:"flex items-center gap-2 truncate w-full "+p,children:[(0,n.jsxs)("span",{className:"truncate",children:[t," "]}),void 0!==f&&(0,n.jsx)(i.E,{variant:"warning",className:"py-0 px-1.5 capitalize",children:f})]}),c&&(0,n.jsx)("div",{children:c})]})});return u?s?(0,n.jsx)(o.$,{asChild:!0,block:!0,className:"!justify-start",type:"text",size:"small",icon:d,children:(0,n.jsx)(r(),{href:u,target:"_blank",rel:"noreferrer",children:t})}):(0,n.jsx)(r(),{href:u,className:"block",target:m,children:y}):y}},19686:(e,t,a)=>{"use strict";a.d(t,{Ay:()=>d});var n={};a.r(n),a.d(n,{BRAND:()=>i.qt,DIRTY:()=>r.jm,EMPTY_PATH:()=>r.I3,INVALID:()=>r.uY,NEVER:()=>i.tm,OK:()=>r.OK,ParseStatus:()=>r.MY,Schema:()=>i.Sj,ZodAny:()=>i.Ml,ZodArray:()=>i.n,ZodBigInt:()=>i.Lr,ZodBoolean:()=>i.WF,ZodBranded:()=>i.eN,ZodCatch:()=>i.hw,ZodDate:()=>i.aP,ZodDefault:()=>i.Xi,ZodDiscriminatedUnion:()=>i.jv,ZodEffects:()=>i.k1,ZodEnum:()=>i.Vb,ZodError:()=>o.G,ZodFirstPartyTypeKind:()=>i.kY,ZodFunction:()=>i.CZ,ZodIntersection:()=>i.Jv,ZodIssueCode:()=>o.eq,ZodLazy:()=>i.Ih,ZodLiteral:()=>i.DN,ZodMap:()=>i.Ut,ZodNaN:()=>i.Tq,ZodNativeEnum:()=>i.WM,ZodNever:()=>i.iS,ZodNull:()=>i.PQ,ZodNullable:()=>i.l1,ZodNumber:()=>i.rS,ZodObject:()=>i.bv,ZodOptional:()=>i.Ii,ZodParsedType:()=>l.Zp,ZodPipeline:()=>i._c,ZodPromise:()=>i.$i,ZodReadonly:()=>i.EV,ZodRecord:()=>i.b8,ZodSchema:()=>i.lK,ZodSet:()=>i.Kz,ZodString:()=>i.ND,ZodSymbol:()=>i.K5,ZodTransformer:()=>i.BG,ZodTuple:()=>i.y0,ZodType:()=>i.aR,ZodUndefined:()=>i._Z,ZodUnion:()=>i.fZ,ZodUnknown:()=>i._,ZodVoid:()=>i.a0,addIssueToContext:()=>r.zn,any:()=>i.bz,array:()=>i.YO,bigint:()=>i.o,boolean:()=>i.zM,coerce:()=>i.au,custom:()=>i.Ie,date:()=>i.p6,datetimeRegex:()=>i.fm,defaultErrorMap:()=>s.su,discriminatedUnion:()=>i.gM,effect:()=>i.QZ,enum:()=>i.k5,function:()=>i.fH,getErrorMap:()=>s.$W,getParsedType:()=>l.CR,instanceof:()=>i.Nl,intersection:()=>i.E$,isAborted:()=>r.G4,isAsync:()=>r.xP,isDirty:()=>r.DM,isValid:()=>r.fn,late:()=>i.fn,lazy:()=>i.RZ,literal:()=>i.eu,makeIssue:()=>r.y7,map:()=>i.Tj,nan:()=>i.oi,nativeEnum:()=>i.fc,never:()=>i.Zm,null:()=>i.ch,nullable:()=>i.me,number:()=>i.ai,object:()=>i.Ik,objectUtil:()=>l.o6,oboolean:()=>i.yN,onumber:()=>i.p7,optional:()=>i.lq,ostring:()=>i.Di,pipeline:()=>i.Tk,preprocess:()=>i.vk,promise:()=>i.iv,quotelessJson:()=>o.WI,record:()=>i.g1,set:()=>i.hZ,setErrorMap:()=>s.pJ,strictObject:()=>i.re,string:()=>i.Yj,symbol:()=>i.HR,transformer:()=>i.Gu,tuple:()=>i.PV,undefined:()=>i.Vx,union:()=>i.KC,unknown:()=>i.L5,util:()=>l.ZS,void:()=>i.rI});var s=a(54686),r=a(93298),l=a(14595),i=a(10663),o=a(63324);let d=n},23282:(e,t,a)=>{"use strict";a.d(t,{Fg:()=>n,QY:()=>s,mV:()=>r});let n=["anon","service_role","authenticated","authenticator","dashboard_user","supabase_admin","supabase_auth_admin","supabase_functions_admin","supabase_read_only_user","supabase_realtime_admin","supabase_replication_admin","supabase_storage_admin","pgbouncer","pgsodium_keyholder","pgsodium_keyiduser","pgsodium_keymaker","pgtle_admin"],s=["postgres","pgbouncer","supabase_admin","supabase_auth_admin","supabase_storage_admin","dashboard_user","authenticator","pg_database_owner","pg_read_all_data","pg_write_all_data"],r={canLogin:{disabled:!1,description:"User can login",grant_by_dashboard:!0},canCreateRole:{disabled:!1,description:"User can create roles",grant_by_dashboard:!0},canCreateDb:{disabled:!1,description:"User can create databases",grant_by_dashboard:!0},canBypassRls:{disabled:!1,description:"User bypasses every row level security policy",grant_by_dashboard:!0},isSuperuser:{disabled:!0,description:"User is a Superuser",grant_by_dashboard:!1},isReplicationRole:{disabled:!1,description:"User can initiate streaming replication and put the system in and out of backup mode",grant_by_dashboard:!0}}},24600:(e,t,a)=>{"use strict";a.d(t,{I:()=>r});var n=a(80263),s=a(22554);let r=e=>{let{form:t,hasChanges:a,handleReset:r,helper:l,disabled:i=!1,isSubmitting:o,submitText:d="Save"}=e,c=o||i||!a&&void 0!==a;return(0,n.jsxs)("div",{className:["flex w-full items-center gap-2",l?"justify-between":"justify-end"].join(" "),"data-sentry-component":"FormActions","data-sentry-source-file":"FormActions.tsx",children:[l&&(0,n.jsx)("span",{className:"text-sm text-foreground-lighter",children:l}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(s.$,{disabled:c,type:"default",htmlType:"reset",onClick:()=>r(),"data-sentry-element":"Button","data-sentry-source-file":"FormActions.tsx",children:"Cancel"}),(0,n.jsx)(s.$,{form:t,type:"primary",htmlType:"submit",disabled:c,loading:o,"data-sentry-element":"Button","data-sentry-source-file":"FormActions.tsx",children:d})]})]})}},28234:(e,t,a)=>{"use strict";a.d(t,{Dt:()=>o});var n=a(56947),s=a(20305),r=a(28175);let l=()=>"show max_connections";async function i(e,t){let{projectRef:a,connectionString:n}=e,r=l(),{result:i}=await (0,s.E)({projectRef:a,connectionString:n,sql:r,queryKey:["max-connections"]},t);return{maxConnections:parseInt(i[0].max_connections)}}let o=function(e){let{projectRef:t,connectionString:a}=e,{enabled:s=!0,...l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,n.I)(r.c.maxConnections(t),e=>{let{signal:n}=e;return i({projectRef:t,connectionString:a},n)},{enabled:s&&void 0!==t,...l})}},30075:(e,t,a)=>{var n=a(50117);e.exports=a(94277)(function(e,t,a){n(e,a,t)})},34763:(e,t,a)=>{"use strict";a.d(t,{A:()=>j});var n=a(80263),s=a(60045),r=a(42872),l=a(24699),i=a(7005),o=a(53239),d=a(15224),c=a(75831),u=a(16703),m=a(22554),x=a(49583),p=a(38112),h=a(51509),f=a(30569),y=a(50033);let j=e=>{let{className:t,disabled:a=!1,size:j="tiny",showError:g=!0,selectedSchemaName:b,supportSelectAll:v=!1,excludedSchemas:N=[],onSelectSchema:w,onSelectCreateSchema:S,portal:C=!0}=e,[A,E]=(0,o.useState)(!1),{can:R}=(0,c.hl)(s.aG.TENANT_SQL_ADMIN_WRITE,"schemas"),{data:_}=(0,u.YA)(),{data:k,isLoading:T,isSuccess:F,isError:I,error:L,refetch:P}=(0,d.w$)({projectRef:null==_?void 0:_.ref,connectionString:null==_?void 0:_.connectionString}),B=(k||[]).filter(e=>!N.includes(e.name)).sort((e,t)=>e.name.localeCompare(t.name));return(0,n.jsxs)("div",{className:t,"data-sentry-component":"SchemaSelector","data-sentry-source-file":"SchemaSelector.tsx",children:[T&&(0,n.jsx)(m.$,{type:"default",className:"w-full [&>span]:w-full",size:j,disabled:!0,children:(0,n.jsx)(x.E,{className:"w-full h-3 bg-foreground-muted"})},"schema-selector-skeleton"),g&&I&&(0,n.jsxs)(p.Fc,{variant:"warning",className:"!px-3 !py-3",children:[(0,n.jsx)(p.XL,{className:"text-xs text-amber-900",children:"Failed to load schemas"}),(0,n.jsxs)(p.TN,{className:"text-xs mb-2 break-words",children:["Error: ",null==L?void 0:L.message]}),(0,n.jsx)(m.$,{type:"default",size:"tiny",onClick:()=>P(),children:"Reload schemas"})]}),F&&(0,n.jsxs)(h.AM,{open:A,onOpenChange:E,modal:!1,children:[(0,n.jsx)(h.Wv,{asChild:!0,children:(0,n.jsx)(m.$,{size:j,disabled:a,type:"default","data-testid":"schema-selector",className:"w-full [&>span]:w-full !pr-1 space-x-1",iconRight:(0,n.jsx)(r.A,{className:"text-foreground-muted",strokeWidth:2,size:14}),children:b?(0,n.jsxs)("div",{className:"w-full flex gap-1",children:[(0,n.jsx)("p",{className:"text-foreground-lighter",children:"schema"}),(0,n.jsx)("p",{className:"text-foreground",children:"*"===b?"All schemas":b})]}):(0,n.jsx)("div",{className:"w-full flex gap-1",children:(0,n.jsx)("p",{className:"text-foreground-lighter",children:"Choose a schemaâ€¦"})})})}),(0,n.jsx)(h.hl,{className:"p-0 min-w-[200px] pointer-events-auto",side:"bottom",align:"start",portal:C,sameWidthAsTrigger:!0,children:(0,n.jsxs)(f.uB,{children:[(0,n.jsx)(f.G7,{placeholder:"Find schema..."}),(0,n.jsxs)(f.oI,{children:[(0,n.jsx)(f.xL,{children:"No schemas found"}),(0,n.jsx)(f.L$,{children:(0,n.jsxs)(y.FK,{className:(B||[]).length>7?"h-[210px]":"",children:[v&&(0,n.jsxs)(f.h_,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{w("*"),E(!1)},onClick:()=>{w("*"),E(!1)},children:[(0,n.jsx)("span",{children:"All schemas"}),"*"===b&&(0,n.jsx)(l.A,{className:"text-brand",strokeWidth:2,size:16})]},"select-all"),null==B?void 0:B.map(e=>(0,n.jsxs)(f.h_,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{w(e.name),E(!1)},onClick:()=>{w(e.name),E(!1)},children:[(0,n.jsx)("span",{children:e.name}),b===e.name&&(0,n.jsx)(l.A,{className:"text-brand",strokeWidth:2,size:16})]},e.id))]})}),void 0!==S&&R&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f.fx,{}),(0,n.jsx)(f.L$,{children:(0,n.jsxs)(f.h_,{className:"cursor-pointer flex items-center gap-x-2 w-full",onSelect:()=>{S(),E(!1)},onClick:()=>{S(),E(!1)},children:[(0,n.jsx)(i.A,{size:12}),"Create a new schema"]})})]})]})]})})]})]})}},36152:(e,t,a)=>{"use strict";a.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>o,Zp:()=>l,aR:()=>i,wL:()=>u});var n=a(80263),s=a(53239),r=a(80127);let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,r.cn)("overflow-hidden rounded-lg border bg-surface-100 text-card-foreground shadow-sm",a),...s})});l.displayName="Card";let i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,r.cn)("flex flex-col space-y-1.5 py-4 px-6 border-b",a),...s})});i.displayName="CardHeader";let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("h3",{ref:t,className:(0,r.cn)("text-xs font-mono uppercase",a),...s})});o.displayName="CardTitle";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("p",{ref:t,className:(0,r.cn)("text-sm text-foreground-muted",a),...s})});d.displayName="CardDescription";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,r.cn)("py-4 px-6 border-b last:border-none",a),...s})});c.displayName="CardContent";let u=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,r.cn)(" flex items-center py-4 px-6",a),...s})});u.displayName="CardFooter"},41807:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});var n=a(80263);a(53239);let s=function(e){let{children:t,target:a="_blank",href:s,className:r,onClick:l,style:i}=e;return(0,n.jsx)("a",{onClick:l,href:s,target:a,rel:"noopener noreferrer",style:i,"data-sentry-component":"Link","data-sentry-source-file":"Link.tsx",children:t})}},43631:(e,t,a)=>{"use strict";a.d(t,{z:()=>c});var n=a(23879),s=a(56947),r=a(70938),l=a(16703),i=a(74144),o=a(55784);async function d(e,t,a){let{projectRef:s,connectionString:l}=e;if(!s)throw Error("projectRef is required");let i=new Headers(a);l&&i.set("x-connection-encrypted",l);let{data:o,error:d}=await (0,r.Jt)("/platform/pg-meta/{ref}/extensions",{params:{header:{"x-connection-encrypted":l,"x-pg-application-name":n.r},path:{ref:s}},headers:i,signal:t});return d&&(0,r.H4)(d),o}let c=function(e){let{projectRef:t,connectionString:a}=e,{enabled:n=!0,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:c}=(0,l.YA)(),u=(null==c?void 0:c.status)===i.BU.ACTIVE_HEALTHY;return(0,s.I)(o.I.list(t),e=>{let{signal:n}=e;return d({projectRef:t,connectionString:a},n)},{enabled:n&&void 0!==t&&u,...r})}},48498:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var n=a(80263),s=a(80127),r=a(22554);let l=e=>{let{searchString:t,onResetFilter:a,className:l}=e;return(0,n.jsxs)("div",{className:(0,s.cn)("bg-surface-100 border border-default px-6 py-4 rounded flex items-center justify-between",l),"data-sentry-component":"NoSearchResults","data-sentry-source-file":"NoSearchResults.tsx",children:[(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)("p",{className:"text-sm text-foreground",children:"No results found"}),(0,n.jsxs)("p",{className:"text-sm text-foreground-light",children:['Your search for "',t,'" did not return any results']})]}),void 0!==a&&(0,n.jsx)(r.$,{type:"default",onClick:()=>a(),children:"Reset filter"})]})}},60423:(e,t,a)=>{"use strict";a.d(t,{A:()=>S});var n=a(80263),s=a(7005),r=a(85436),l=a(63121),i=a(53239),o=a(73969),d=a(86252),c=a(14132),u=a(99549),m=a(15224),x=a(20305),p=a(16703),h=a(33924),f=a(91982),y=a(48192),j=a(24344),g=a(38112),b=a(68506),v=a(22554),N=a(50922);let w=["vector","postgis"],S=e=>{let{visible:t,extension:a,onCancel:S}=e,{data:C}=(0,p.YA)(),A=(0,p.W0)(),[E,R]=(0,i.useState)(),[_,k]=(0,i.useState)(!1),{data:T,isLoading:F}=(0,m.w$)({projectRef:null==C?void 0:C.ref,connectionString:null==C?void 0:C.connectionString},{enabled:t}),{mutate:I,isLoading:L}=(0,u.E)({onSuccess:()=>{o.oR.success('Extension "'.concat(a.name,'" is now enabled')),S()},onError:e=>{o.oR.error("Failed to enable ".concat(a.name,": ").concat(e.message))}});(0,i.useEffect)(()=>{let e=!1;return t&&(async()=>{e||(k(!0),R(void 0));try{let t=await (0,x.E)({projectRef:null==C?void 0:C.ref,connectionString:null==C?void 0:C.connectionString,sql:"select * from pg_available_extension_versions where name = '".concat(a.name,"'")});e||R(t.result[0].schema)}catch(e){}k(!1)})(),()=>{e=!0}},[t,a.name]);let P=async e=>{if(void 0===C)return console.error("Project is required");let t=null!=E?E:"custom"===e.schema?e.name:e.schema;I({projectRef:C.ref,connectionString:null==C?void 0:C.connectionString,schema:t,name:a.name,version:a.default_version,cascade:!0,createSchema:!t.startsWith("pg_")})};return(0,n.jsx)(h.A,{hideFooter:!0,visible:t,onCancel:S,size:"small",header:(0,n.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,n.jsx)("h5",{className:"text-foreground",children:"Confirm to enable"}),(0,n.jsx)("code",{className:"text-xs",children:a.name})]}),"data-sentry-element":"Modal","data-sentry-component":"EnableExtensionModal","data-sentry-source-file":"EnableExtensionModal.tsx",children:(0,n.jsx)(f.A,{initialValues:{name:a.name,schema:"extensions"},validate:e=>{let t={};return"custom"!==e.schema||e.name||(t.name="Required field"),t},onSubmit:P,"data-sentry-element":"Form","data-sentry-source-file":"EnableExtensionModal.tsx",children:e=>{let{values:t}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(h.A.Content,{className:"flex flex-col gap-y-2",children:[A&&w.includes(a.name)&&(0,n.jsxs)(N.Z,{type:"default",title:"Extension is limited by OrioleDB",children:[(0,n.jsxs)("span",{className:"block",children:[a.name," cannot be accelerated by indexes on tables that are using the OrioleDB access method"]}),(0,n.jsx)(d.A,{abbrev:!1,className:"mt-2",href:"https://supabase.com/docs"})]}),_||F?(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(c.A,{}),(0,n.jsx)("div",{className:"w-3/4",children:(0,n.jsx)(c.A,{})})]}):E?(0,n.jsx)(y.A,{disabled:!0,id:"schema",name:"schema",value:E,label:"Select a schema to enable the extension for",descriptionText:"Extension must be installed in ".concat(E,".")}):(0,n.jsxs)(j.A,{size:"small",name:"schema",label:"Select a schema to enable the extension for",children:[(0,n.jsxs)(j.A.Option,{id:"custom",label:'Create a new schema "'.concat(a.name,'"'),value:"custom",addOnBefore:()=>(0,n.jsx)(s.A,{size:16,strokeWidth:1.5}),children:['Create a new schema "',a.name,'"']},"custom"),(0,n.jsx)(h.A.Separator,{}),null==T?void 0:T.map(e=>(0,n.jsx)(j.A.Option,{id:e.name,label:e.name,value:e.name,addOnBefore:()=>(0,n.jsx)(r.A,{size:16,strokeWidth:1.5}),children:e.name},e.id))]})]}),"custom"===t.schema&&(0,n.jsx)(h.A.Content,{children:(0,n.jsx)(y.A,{id:"name",name:"name",label:"Schema name"})}),"pg_cron"===a.name&&(null==C?void 0:C.cloud_provider)==="FLY"&&(0,n.jsx)(h.A.Content,{children:(0,n.jsxs)(g.Fc,{variant:"warning",children:[(0,n.jsx)(b.id,{}),(0,n.jsx)(g.XL,{children:"The pg_cron extension is not fully supported for Fly projects"}),(0,n.jsx)(g.TN,{children:"You can still enable the extension, but pg_cron jobs may not run due to the behavior of Fly projects."}),(0,n.jsx)(g.TN,{className:"mt-3",children:(0,n.jsx)(v.$,{asChild:!0,type:"default",iconRight:(0,n.jsx)(l.A,{width:12,height:12}),children:(0,n.jsx)("a",{href:"/docs/guides/platform/fly-postgres#limitations",target:"_blank",rel:"noopener noreferrer",children:(0,n.jsx)("span",{children:"Learn more"})})})})]})}),(0,n.jsx)(h.A.Separator,{}),(0,n.jsxs)(h.A.Content,{className:"flex items-center justify-end space-x-2",children:[(0,n.jsx)(v.$,{type:"default",disabled:L,onClick:()=>S(),children:"Cancel"}),(0,n.jsx)(v.$,{htmlType:"submit",disabled:L,loading:L,children:"Enable extension"})]})]})}})})}},60905:(e,t,a)=>{"use strict";a.d(t,{l:()=>i});var n=a(80263),s=a(98615),r=a(34531),l=a(15419);let i=e=>{let{page:t,menu:a}=e;return(0,n.jsx)("div",{className:"flex flex-col space-y-8","data-sentry-component":"ProductMenu","data-sentry-source-file":"ProductMenu.tsx",children:(0,n.jsx)(s.Ay,{type:"pills","data-sentry-element":"Menu","data-sentry-source-file":"ProductMenu.tsx",children:a.map((e,i)=>(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"my-6 space-y-8",children:(0,n.jsxs)("div",{className:"mx-3",children:[(0,n.jsx)(s.Ay.Group,{title:e.title?(0,n.jsxs)("div",{className:"flex flex-col space-y-2 uppercase font-mono",children:[(0,n.jsx)("span",{children:e.title}),e.isPreview&&(0,n.jsx)(r.E,{variant:"warning",children:"Not production ready"})]}):null}),(0,n.jsx)("div",{children:e.items.map(e=>{let a=e.pages?e.pages.includes(null!=t?t:""):t===e.key;return(0,n.jsx)(l.A,{url:e.url,name:e.name,icon:e.icon,rightIcon:e.rightIcon,isActive:a,isExternal:e.isExternal,target:e.isExternal?"_blank":"_self",label:e.label},e.key)})})]})}),i!==a.length-1&&(0,n.jsx)("div",{className:"h-px w-full bg-border-overlay"})]},e.key||e.title))})})}},62473:(e,t,a)=>{"use strict";a.d(t,{A:()=>f});var n=a(80263),s=a(67908),r=a(4487),l=a(60905),i=a(43631),o=a(32930),d=a(64084),c=a(16703),u=a(53405),m=a(18947),x=a(33444),p=a(15283);let h=()=>{let{data:e}=(0,c.YA)(),t=(0,s.useRouter)().pathname.split("/")[4],{data:a}=(0,i.z)({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString}),{data:u}=(0,o.Q)({projectRef:null==e?void 0:e.ref}),x=void 0!==(null!=a?a:[]).find(e=>"pg_net"===e.name),h=(null==u?void 0:u.selected_addons.find(e=>"pitr"===e.type))!==void 0,f=(0,r.p4)(),y=(0,m._P)("enablePgReplicate"),{databaseReplication:j,databaseRoles:g}=(0,d.x)(["database:replication","database:roles"]);return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(l.l,{page:t,menu:(0,p.k)(e,{pgNetExtensionExists:x,pitrEnabled:h,columnLevelPrivileges:f,enablePgReplicate:y,showPgReplicate:j,showRoles:g}),"data-sentry-element":"ProductMenu","data-sentry-source-file":"DatabaseLayout.tsx"})})},f=(0,u.r)(e=>{let{children:t}=e;return(0,n.jsx)(x.A,{product:"Database",productMenu:(0,n.jsx)(h,{}),isBlocking:!1,"data-sentry-element":"ProjectLayout","data-sentry-component":"DatabaseLayout","data-sentry-source-file":"DatabaseLayout.tsx",children:t})})},64795:(e,t,a)=>{"use strict";a.d(t,{$:()=>l});var n=a(80263),s=a(38112),r=a(68506);let l=()=>(0,n.jsxs)(s.Fc,{variant:"default","data-sentry-element":"Alert_Shadcn_","data-sentry-component":"BackupsStorageAlert","data-sentry-source-file":"BackupsStorageAlert.tsx",children:[(0,n.jsx)(r.id,{"data-sentry-element":"WarningIcon","data-sentry-source-file":"BackupsStorageAlert.tsx"}),(0,n.jsx)(s.TN,{"data-sentry-element":"AlertDescription_Shadcn_","data-sentry-source-file":"BackupsStorageAlert.tsx",children:"Database backups do not include objects stored via the Storage API, as the database only includes metadata about these objects. Restoring an old backup does not restore objects that have been deleted since then."})]})},67247:(e,t,a)=>{"use strict";a.d(t,{V:()=>r});var n=a(80263),s=a(80797);let r=()=>(0,n.jsx)("div",{className:"block w-full rounded border border-muted border-opacity-50 bg-gray-300 p-3","data-sentry-component":"BackupsEmpty","data-sentry-source-file":"BackupsEmpty.tsx",children:(0,n.jsxs)("div",{className:"flex space-x-3",children:[(0,n.jsx)(s.A,{size:20,strokeWidth:1.5,"data-sentry-element":"Info","data-sentry-source-file":"BackupsEmpty.tsx"}),(0,n.jsx)("p",{className:"text-sm",children:"No backups created yet - check again tomorrow."})]})})},71251:(e,t,a)=>{"use strict";a.d(t,{h:()=>o});var n=a(56947),s=a(70938),r=a(16703),l=a(28175);async function i(e,t){let{projectRef:a}=e;if(!a)throw Error("Project ref is required");let{data:n,error:r}=await (0,s.Jt)("/platform/database/{ref}/backups",{params:{path:{ref:a}},signal:t});return r&&(0,s.H4)(r),n}let o=function(e){let{projectRef:t}=e,{enabled:a=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=(0,r.CG)();return(0,n.I)(l.c.backups(t),e=>{let{signal:a}=e;return i({projectRef:t},a)},{enabled:a&&!o&&void 0!==t,...s})}},93474:(e,t,a)=>{"use strict";a.d(t,{aE:()=>e1,ZO:()=>tb,iZ:()=>tR,IP:()=>tX,Fd:()=>eP,Ey:()=>ei});var n=a(80263),s=a(60045),r=a(53667),l=a.n(r),i=a(14506),o=a.n(i),d=a(27969),c=a(36839),u=a(7005),m=a(53239),x=a(84558),p=a(48498),h=a(33419),f=a(943),y=a(28234),j=a(75831),g=a(16703),b=a(48192),v=a(22554),N=a(35741),w=a(34531),S=a(32981),C=a(87494),A=a(73969),E=a(19686),R=a(24600),_=a(22990),k=a(32144),T=a(80251),F=a(20305);async function I(e){let{projectRef:t,connectionString:a,payload:n}=e,s=_.A.roles.create(n).sql,{result:r}=await (0,F.E)({projectRef:t,connectionString:a,sql:s,queryKey:["roles","create"]});return r}let L=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,k.jE)();return(0,T.n)(e=>I(e),{async onSuccess(t,a,s){let{projectRef:r}=a;await (0,f.tV)(n,r),await (null==e?void 0:e(t,a,s))},async onError(e,a,n){void 0===t?A.oR.error("Failed to create database role: ".concat(e.message)):t(e,a,n)},...a})};var P=a(80832),B=a(20704),z=a(20838),D=a(75118),M=a(23282);let V=E.Ay.object({name:E.Ay.string().trim().min(1,"You must provide a name").default(""),isSuperuser:E.Ay.boolean().default(!1),canLogin:E.Ay.boolean().default(!1),canCreateRole:E.Ay.boolean().default(!1),canCreateDb:E.Ay.boolean().default(!1),isReplicationRole:E.Ay.boolean().default(!1),canBypassRls:E.Ay.boolean().default(!1)}),Y={name:"",isSuperuser:!1,canLogin:!1,canCreateRole:!1,canCreateDb:!1,isReplicationRole:!1,canBypassRls:!1},Z=e=>{let{visible:t,onClose:a}=e,s="create-new-role",{data:r}=(0,g.YA)(),l=(0,C.mN)({resolver:(0,S.u)(V)}),{mutate:i,isLoading:o}=L({onSuccess:(e,t)=>{A.oR.success("Successfully created new role: ".concat(t.payload.name)),c()}}),d=async e=>{if(!r)return console.error("Project is required");i({projectRef:r.ref,connectionString:r.connectionString,payload:e})},c=()=>{a(),l.reset(Y)};return(0,n.jsx)(P.Ay,{size:"large",visible:t,header:"Create a new role",className:"mr-0 transform transition-all duration-300 ease-in-out",loading:!1,onCancel:c,customFooter:(0,n.jsx)("div",{className:"flex w-full justify-end space-x-3 border-t border-default px-3 py-4",children:(0,n.jsx)(R.I,{form:s,isSubmitting:o,hasChanges:l.formState.isDirty,handleReset:c})}),"data-sentry-element":"SidePanel","data-sentry-component":"CreateRolePanel","data-sentry-source-file":"CreateRolePanel.tsx",children:(0,n.jsx)(B.lV,{...l,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"CreateRolePanel.tsx",children:(0,n.jsxs)("form",{id:s,className:"grid gap-6 w-full px-8 py-8",onSubmit:l.handleSubmit(d),children:[(0,n.jsx)(B.zB,{control:l.control,name:"name",render:e=>{let{field:t}=e;return(0,n.jsxs)(B.eI,{className:"grid gap-2 md:grid md:grid-cols-12 space-y-0",children:[(0,n.jsx)(B.lR,{className:"flex flex-col space-y-2 col-span-4 text-sm justify-center text-foreground-light",children:"Name"}),(0,n.jsx)(B.MJ,{className:"col-span-8",children:(0,n.jsx)(z.p,{...t,className:"w-full"})}),(0,n.jsx)(B.C5,{className:"col-start-5 col-span-8"})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreateRolePanel.tsx"}),(0,n.jsxs)("div",{className:"grid gap-2 mt-4 md:grid md:grid-cols-12",children:[(0,n.jsx)("div",{className:"col-span-4",children:(0,n.jsx)(B.lR,{className:"flex flex-col space-y-2 col-span-4 text-sm justify-center text-foreground-light","data-sentry-element":"FormLabel_Shadcn_","data-sentry-source-file":"CreateRolePanel.tsx",children:"Role privileges"})}),(0,n.jsxs)("div",{className:"col-span-8 grid gap-4",children:[Object.keys(M.mV).filter(e=>M.mV[e].grant_by_dashboard).map(e=>{let t=M.mV[e];return(0,n.jsx)(B.zB,{control:l.control,name:e,render:e=>{let{field:a}=e;return(0,n.jsxs)(B.eI,{className:"grid gap-2 md:grid md:grid-cols-12 space-y-0",children:[(0,n.jsx)(B.MJ,{className:"col-span-8 flex items-center gap-4",children:(0,n.jsxs)("div",{className:"w-full text-sm",children:[(0,n.jsx)(D.d,{checked:a.value,onCheckedChange:a.onChange}),(0,n.jsx)(B.lR,{children:t.description})]})}),(0,n.jsx)(B.C5,{className:"col-start-5 col-span-8"})]})}},e)}),(0,n.jsx)(P.Ay.Separator,{"data-sentry-element":"SidePanel.Separator","data-sentry-source-file":"CreateRolePanel.tsx"}),(0,n.jsxs)("div",{className:"grid gap-4",children:[(0,n.jsx)("p",{className:"text-sm",children:"These privileges cannot be granted via the Dashboard:"}),Object.keys(M.mV).filter(e=>!M.mV[e].grant_by_dashboard).map(e=>{let t=M.mV[e];return(0,n.jsx)(B.zB,{control:l.control,name:e,render:e=>{let{field:a}=e;return(0,n.jsxs)(B.eI,{className:"space-y-0 opacity-70",children:[(0,n.jsx)(B.MJ,{className:"flex items-center gap-4",children:(0,n.jsxs)("div",{className:"w-full text-sm",children:[(0,n.jsx)(D.d,{checked:a.value,onCheckedChange:a.onChange,disabled:!0,"aria-readonly":!0}),(0,n.jsx)(B.lR,{children:t.description})]})}),(0,n.jsx)(B.C5,{className:"col-start-5 col-span-8"})]})}},e)})]})]})]})]})})})};async function q(e){let{projectRef:t,connectionString:a,id:n,payload:s}=e,r=_.A.roles.remove({id:n},s).sql,{result:l}=await (0,F.E)({projectRef:t,connectionString:a,sql:r,queryKey:["roles","delete"]});return l}let $=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,k.jE)();return(0,T.n)(e=>q(e),{async onSuccess(t,a,s){let{projectRef:r}=a;await (0,f.tV)(n,r),await (null==e?void 0:e(t,a,s))},async onError(e,a,n){void 0===t?A.oR.error("Failed to delete database role: ".concat(e.message)):t(e,a,n)},...a})};var O=a(33924);let U=e=>{let{role:t,visible:a,onClose:s}=e,{data:r}=(0,g.YA)(),{mutate:l,isLoading:i}=$({onSuccess:()=>{A.oR.success("Successfully deleted role: ".concat(t.name)),s()}}),o=async()=>r?t?void l({projectRef:r.ref,connectionString:r.connectionString,id:t.id}):console.error("Failed to delete role: role is missing"):console.error("Project is required");return(0,n.jsx)(O.A,{size:"small",alignFooter:"right",visible:a,onCancel:s,onConfirm:o,header:(0,n.jsxs)("h3",{children:['Confirm to delete role "',null==t?void 0:t.name,'"']}),loading:i,"data-sentry-element":"Modal","data-sentry-component":"DeleteRoleModal","data-sentry-source-file":"DeleteRoleModal.tsx",children:(0,n.jsx)(O.A.Content,{"data-sentry-element":"Modal.Content","data-sentry-source-file":"DeleteRoleModal.tsx",children:(0,n.jsx)("p",{className:"text-sm",children:"This will automatically revoke any membership of this role in other roles, and this action cannot be undone."})})})};var H=a(91982),W=a(80127),J=a(26140),K=a(64495),G=a(8326);async function X(e){let{projectRef:t,connectionString:a,id:n,payload:s}=e,r=_.A.roles.update({id:n},s).sql,{result:l}=await (0,F.E)({projectRef:t,connectionString:a,sql:r,queryKey:["roles","update"]});return l}let Q=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,k.jE)();return(0,T.n)(e=>X(e),{async onSuccess(t,a,s){let{projectRef:r}=a;await (0,f.tV)(n,r),await (null==e?void 0:e(t,a,s))},async onError(e,a,n){void 0===t?A.oR.error("Failed to update database role: ".concat(e.message)):t(e,a,n)},...a})};var ee=a(72234),et=a(32615),ea=a(80949),en=a(70891);let es=e=>{let{role:t,disabled:a=!1,onSelectDelete:s}=e,{data:r}=(0,g.YA)(),[l,i]=(0,m.useState)(!1),{mutate:o,isLoading:d}=Q(),{isSuperuser:c,canLogin:u,canCreateRole:x,canCreateDb:p,isReplicationRole:h,canBypassRls:f}=t,y=async(e,a)=>{let{resetForm:n}=a;if(!r)return console.error("Project is required");let s=Object.fromEntries(Object.entries(e).filter(e=>{let[a,n]=e;return n!==t[a]}));o({projectRef:r.ref,connectionString:r.connectionString,id:t.id,payload:s},{onSuccess:()=>{A.oR.success('Successfully updated role "'.concat(t.name,'"')),n({values:{...e},initialValues:{...e}})}})};return(0,n.jsx)(H.A,{name:"role-update-form",initialValues:{isSuperuser:c,canLogin:u,canCreateRole:x,canCreateDb:p,isReplicationRole:h,canBypassRls:f},onSubmit:y,className:(0,W.cn)("bg-surface-100","hover:bg-overlay-hover","data-open:bg-selection","border-default hover:border-strong","data-open:border-strong","data-open:pb-px col-span-12 mx-auto","-space-y-px overflow-hidden","border border-t-0 first:border-t first:!mt-0 hover:border-t hover:-mt-[1px] shadow transition hover:z-50","first:rounded-tl first:rounded-tr","last:rounded-bl last:rounded-br"),"data-sentry-element":"Form","data-sentry-component":"RoleRow","data-sentry-source-file":"RoleRow.tsx",children:e=>{let{values:r,initialValues:o,handleReset:c}=e,u=JSON.stringify(r)!==JSON.stringify(o);return(0,n.jsxs)(J.Ay,{open:l,children:[(0,n.jsx)(J.Ay.Trigger,{asChild:!0,children:(0,n.jsxs)("button",{id:"collapsible-trigger",type:"button",className:"group flex w-full items-center justify-between rounded py-3 px-4 md:px-6 text-foreground",onClick:e=>{"collapsible-trigger"===e.target.id&&i(!l)},children:[(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)(ee.A,{id:"collapsible-trigger",className:"text-border-stronger transition data-open-parent:rotate-0 data-closed-parent:rotate-180",strokeWidth:2,width:14}),(0,n.jsxs)("div",{className:"space-x-2 flex items-center",children:[(0,n.jsx)("p",{className:"text-left text-sm",id:"collapsible-trigger",children:t.name}),(0,n.jsxs)("p",{className:"text-left text-sm text-foreground-light",id:"collapsible-trigger",children:["(ID: ",t.id,")"]})]})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[t.activeConnections>0&&(0,n.jsx)("div",{className:"relative h-2 w-2",children:(0,n.jsxs)("span",{className:"flex h-2 w-2",children:[(0,n.jsx)("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-brand opacity-75"}),(0,n.jsx)("span",{className:"relative inline-flex h-2 w-2 rounded-full bg-brand opacity-75"})]})}),(0,n.jsxs)("p",{id:"collapsible-trigger",className:"text-sm ".concat(t.activeConnections>0?"text-foreground":"text-foreground-light"),children:[t.activeConnections," connections"]}),!a&&(0,n.jsxs)(K.rI,{children:[(0,n.jsx)(K.ty,{asChild:!0,children:(0,n.jsx)(v.$,{type:"default",className:"px-1",icon:(0,n.jsx)(et.A,{})})}),(0,n.jsx)(K.SQ,{side:"bottom",className:"w-[120px]",children:(0,n.jsxs)(K._2,{className:"space-x-2",onClick:e=>{e.stopPropagation(),s(t)},children:[(0,n.jsx)(ea.A,{className:"text-red-800",size:"14",strokeWidth:2}),(0,n.jsx)("p",{children:"Delete"})]})})]})]})]})}),(0,n.jsx)(J.Ay.Content,{children:(0,n.jsxs)("div",{className:"group border-t border-default bg-surface-100 py-6 px-5 md:px-20 text-foreground",children:[(0,n.jsx)("div",{className:"py-4 space-y-[9px]",children:Object.keys(M.mV).map(e=>(0,n.jsx)(G.A,{size:"small",id:e,name:e,label:M.mV[e].description,disabled:a||M.mV[e].disabled,className:["roles-toggle",a||M.mV[e].disabled?"[&>div>button]:opacity-30 [&>div>label]:text-foreground-lighter":""].join(" "),afterLabel:!a&&M.mV[e].disabled&&(0,n.jsxs)(N.m_,{children:[(0,n.jsx)(N.k$,{children:(0,n.jsx)(en.A,{size:"14",strokeWidth:2,className:"ml-2 relative top-[3px]"})}),(0,n.jsx)(N.ZI,{side:"bottom",children:"This privilege cannot be updated via the dashboard"})]})},e))}),!a&&(0,n.jsxs)("div",{className:"py-4 flex items-center space-x-2 justify-end",children:[(0,n.jsx)(v.$,{type:"default",disabled:!u||d,onClick:()=>c(),children:"Cancel"}),(0,n.jsx)(v.$,{type:"primary",htmlType:"submit",disabled:!u||d,loading:d,children:"Save"})]})]})})]})}})};var er=a(14132);let el=e=>{let{index:t}=e;return(0,n.jsx)("div",{className:(0,W.cn)(["bg-surface-100","data-open:bg-selection","border-default","data-open:border-strong","data-open:pb-px col-span-12 mx-auto","-space-y-px overflow-hidden","border border-t-0 first:border-t first:!mt-0 shadow transition","first:rounded-tl first:rounded-tr","last:rounded-bl last:rounded-br"]),"data-sentry-component":"RoleRowSkeleton","data-sentry-source-file":"RoleRowSkeleton.tsx",children:(0,n.jsxs)("div",{className:"flex w-full items-center justify-between rounded py-3 px-6 text-foreground",children:[(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)(ee.A,{id:"collapsible-trigger",className:"text-border-stronger rotate-180",strokeWidth:2,width:14,"data-sentry-element":"ChevronUp","data-sentry-source-file":"RoleRowSkeleton.tsx"}),(0,n.jsxs)("div",{className:"space-x-2 flex items-center",children:[(0,n.jsx)(er.A,{className:"h-4 w-20 py-0 my-0.5",delayIndex:t,"data-sentry-element":"ShimmeringLoader","data-sentry-source-file":"RoleRowSkeleton.tsx"}),(0,n.jsx)(er.A,{className:"h-4 w-16 py-0 my-0.5",delayIndex:t,"data-sentry-element":"ShimmeringLoader","data-sentry-source-file":"RoleRowSkeleton.tsx"})]})]}),(0,n.jsx)(er.A,{className:"h-4 w-[90px] py-0 my-0.5",delayIndex:t,"data-sentry-element":"ShimmeringLoader","data-sentry-source-file":"RoleRowSkeleton.tsx"})]})})},ei=()=>{let{data:e}=(0,g.YA)(),[t,a]=(0,m.useState)(""),[r,i]=(0,m.useState)("all"),[S,C]=(0,m.useState)(!1),[A,E]=(0,m.useState)(),{can:R}=(0,j.hl)(s.aG.TENANT_SQL_ADMIN_WRITE,"roles"),{data:_}=(0,y.Dt)({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString}),k=null==_?void 0:_.maxConnections,{data:T,isLoading:F}=(0,f._X)({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString}),I=o()(null!=T?T:[],e=>e.name.toLocaleLowerCase()),L=("active"===r?I.filter(e=>e.activeConnections>0):I).filter(e=>e.name.includes(t)),[P,B]=l()(L,e=>M.Fg.includes(e.name)),z=I.map(e=>e.activeConnections).reduce((e,t)=>e+t,0),D=o()(I.filter(e=>e.activeConnections>0),e=>-e.activeConnections);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"mb-4 flex items-center justify-between gap-2 flex-wrap",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsx)(b.A,{size:"tiny",className:"w-52",placeholder:"Search for a role",icon:(0,n.jsx)(d.A,{size:12}),value:t,onChange:e=>a(e.target.value),actions:t&&(0,n.jsx)(v.$,{size:"tiny",type:"text",onClick:()=>a(""),className:"px-1 mr-1",children:(0,n.jsx)(c.A,{size:12,strokeWidth:2})}),"data-sentry-element":"Input","data-sentry-source-file":"RolesList.tsx"}),(0,n.jsxs)("div",{className:"flex items-center border border-strong rounded-full w-min h-[26px]",children:[(0,n.jsx)("button",{className:["text-xs w-[80px] h-full text-center rounded-l-full flex items-center justify-center transition","all"===r?"bg-overlay-hover text-foreground":"hover:bg-surface-200 text-foreground-light"].join(" "),onClick:()=>i("all"),children:"All roles"}),(0,n.jsx)("div",{className:"h-full w-[1px] border-r border-strong"}),(0,n.jsx)("button",{className:["text-xs w-[80px] h-full text-center rounded-r-full flex items-center justify-center transition","active"===r?"bg-overlay-hover text-foreground":"hover:bg-surface-200 text-foreground-light"].join(" "),onClick:()=>i("active"),children:"Active roles"})]})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,n.jsxs)(N.m_,{"data-sentry-element":"Tooltip","data-sentry-source-file":"RolesList.tsx",children:[(0,n.jsx)(N.k$,{"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"RolesList.tsx",children:(0,n.jsx)("div",{className:"w-42",children:(0,n.jsx)(h.A,{type:"horizontal",max:k||z,value:z,barClass:0===k||void 0===k?"bg-foreground":z>.9*k?"bg-destructive":z>.75*k?"bg-warning":void 0,labelTop:Number.isInteger(k)?"".concat(z,"/").concat(k):"".concat(z),labelTopClass:"text-xs",labelBottom:"Active connections",labelBottomClass:"text-xs","data-sentry-element":"SparkBar","data-sentry-source-file":"RolesList.tsx"})})}),(0,n.jsxs)(N.ZI,{align:"start",side:"bottom",className:"space-y-1","data-sentry-element":"TooltipContent","data-sentry-source-file":"RolesList.tsx",children:[(0,n.jsx)("p",{className:"text-foreground-light pr-2",children:"Connections by roles:"}),D.map(e=>(0,n.jsxs)("div",{children:[e.name,": ",e.activeConnections]},e.id))]})]}),(0,n.jsx)(x.G,{type:"primary",disabled:!R,icon:(0,n.jsx)(u.A,{size:12}),onClick:()=>C(!0),tooltip:{content:{side:"bottom",text:R?void 0:"You need additional permissions to add a new role"}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"RolesList.tsx",children:"Add role"})]})]}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"bg-surface-100 border border-default px-4 md:px-6 py-3 rounded-t flex items-center space-x-4",children:[(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"Roles managed by Supabase"}),(0,n.jsx)(w.E,{variant:"brand","data-sentry-element":"Badge","data-sentry-source-file":"RolesList.tsx",children:"Protected"})]}),F?Array.from({length:5}).map((e,t)=>(0,n.jsx)(el,{index:t},t)):P.map(e=>(0,n.jsx)(es,{disabled:!0,role:e,onSelectDelete:E},e.id))]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"bg-surface-100 border border-default px-4 md:px-6 py-3 rounded-t",children:(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"Other database roles"})}),F?Array.from({length:3}).map((e,t)=>(0,n.jsx)(el,{index:t},t)):B.map(e=>(0,n.jsx)(es,{disabled:!R,role:e,onSelectDelete:E},e.id))]})]}),t.length>0&&0===L.length&&(0,n.jsx)(p.A,{searchString:t,onResetFilter:()=>a("")}),(0,n.jsx)(Z,{visible:S,onClose:()=>C(!1),"data-sentry-element":"CreateRolePanel","data-sentry-source-file":"RolesList.tsx"}),(0,n.jsx)(U,{role:A,visible:void 0!==A,onClose:()=>E(void 0),"data-sentry-element":"DeleteRoleModal","data-sentry-source-file":"RolesList.tsx"})]})};var eo=a(70350),ed=a.n(eo),ec=a(37838),eu=a(46491),em=a(86252),ex=a(10540),ep=a(43631),eh=a(36152),ef=a(11094),ey=a(92818),ej=a(53238),eg=a(7060),eb=a(21749),ev=a(93749),eN=a.n(ev),ew=a(41742),eS=a(55784);async function eC(e){let{projectRef:t,connectionString:a,id:n,cascade:s}=e,r=new Headers;a&&r.set("x-connection-encrypted",a);let{sql:l}=_.A.extensions.remove(n,{cascade:s}),{result:i}=await (0,F.E)({projectRef:t,connectionString:a,sql:l,queryKey:["extension","delete",n]});return i}let eA=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,k.jE)();return(0,T.n)(e=>eC(e),{async onSuccess(t,a,s){let{projectRef:r}=a;await Promise.all([n.invalidateQueries(eS.I.list(r)),n.invalidateQueries(ew.n.upgradeEligibility(r))]),await (null==e?void 0:e(t,a,s))},async onError(e,a,n){void 0===t?A.oR.error("Failed to disable database extension: ".concat(e.message)):t(e,a,n)},...a})};var eE=a(47507),eR=a(50922),e_=a(86336),ek=a(60423);let eT=["adminpack","amcheck","file_fdw","lo","old_snapshot","pageinspect","pg_buffercache","pg_freespacemap","pg_surgery","pg_visibility","supabase_vault","supautils","intagg","xml2","pg_tle"],eF={vector:["pgvector","pg_vector"]},eI={pg_cron:"Disabling this extension will delete all scheduled jobs. This cannot be undone."},eL=e=>{var t,a,r,l;let{extension:i}=e,{data:o}=(0,g.YA)(),d=null!==i.installed_version,c=(0,g.W0)(),[u,p]=(0,m.useState)(!1),[h,f]=(0,m.useState)(!1),{can:y}=(0,j.hl)(s.aG.TENANT_SQL_ADMIN_WRITE,"extensions"),b=c&&"orioledb"===i.name,w=!y||b,S=eE.XO.find(e=>e.name===i.name),C=(null==S?void 0:S.link.startsWith("/guides"))?"https://supabase.com/docs".concat(null==S?void 0:S.link):null!=(t=null==S?void 0:S.link)?t:void 0,{mutate:E,isLoading:R}=eA({onSuccess:()=>{A.oR.success("".concat(i.name," is off.")),p(!1)}}),_=()=>{if(void 0===o)return console.error("Project is required");E({projectRef:o.ref,connectionString:o.connectionString,id:i.name})};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(ef.Hj,{"data-sentry-element":"TableRow","data-sentry-source-file":"ExtensionRow.tsx",children:[(0,n.jsx)(ef.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"ExtensionRow.tsx",children:(0,n.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,n.jsx)("span",{title:i.name,className:"truncate inline-block max-w-48",children:i.name}),(null==S?void 0:S.deprecated)&&(null==S?void 0:S.deprecated.length)>0&&(0,n.jsx)(x.G,{type:"warning",icon:(0,n.jsx)(ey.A,{}),className:"rounded-full",tooltip:{content:{text:"The extension is deprecated and will be removed in ".concat(S.deprecated.join(", "),".")}},children:"Deprecated"})]})}),(0,n.jsx)(ef.nA,{className:"font-mono tracking-tighter","data-sentry-element":"TableCell","data-sentry-source-file":"ExtensionRow.tsx",children:null!=(a=null==i?void 0:i.installed_version)?a:i.default_version}),(0,n.jsx)(ef.nA,{className:"truncate","data-sentry-element":"TableCell","data-sentry-source-file":"ExtensionRow.tsx",children:d?i.schema:"-"}),(0,n.jsx)(ef.nA,{className:"text-foreground-light","data-sentry-element":"TableCell","data-sentry-source-file":"ExtensionRow.tsx",children:(0,n.jsx)("p",{className:"block max-w-96",title:null!=(r=i.comment)?r:void 0,children:i.comment})}),(0,n.jsx)(ef.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"ExtensionRow.tsx",children:(null==S?void 0:S.product)?(0,n.jsxs)("div",{className:"flex flex-col gap-1",children:[S.product_url?(0,n.jsx)(eN(),{href:S.product_url.replace("{ref}",null!=(l=null==o?void 0:o.ref)?l:""),className:"transition hover:text-foreground",children:S.product}):(0,n.jsx)("span",{children:S.product}),!d&&(0,n.jsxs)("span",{className:"text-foreground-lighter text-xs",children:["Install extension to use ",S.product]})]}):(0,n.jsx)("span",{className:"text-foreground-lighter",children:"-"})}),(0,n.jsxs)(ef.nA,{className:"flex gap-2 items-center","data-sentry-element":"TableCell","data-sentry-source-file":"ExtensionRow.tsx",children:[(null==S?void 0:S.github_url)&&(0,n.jsx)(v.$,{asChild:!0,type:"default",icon:(0,n.jsx)(ej.A,{}),className:"rounded-full",children:(0,n.jsx)("a",{target:"_blank",rel:"noreferrer",href:S.github_url,className:"font-mono tracking-tighter",children:S.github_url.split("/").slice(-2).join("/")})}),void 0!==C&&(0,n.jsx)(v.$,{asChild:!0,type:"default",icon:(0,n.jsx)(eg.A,{}),className:"rounded-full",children:(0,n.jsx)("a",{target:"_blank",rel:"noreferrer",className:"font-mono tracking-tighter",href:C,children:"Docs"})})]}),(0,n.jsx)(ef.nA,{className:"w-20 sticky bg-surface-100 border-l right-0","data-sentry-element":"TableCell","data-sentry-source-file":"ExtensionRow.tsx",children:R?(0,n.jsx)(eb.A,{className:"animate-spin",size:16}):(0,n.jsxs)(N.m_,{children:[(0,n.jsx)(N.k$,{children:(0,n.jsx)(D.d,{disabled:w,checked:d,onCheckedChange:()=>d?p(!0):f(!0)})}),w&&(0,n.jsx)(N.ZI,{side:"bottom",children:y?b?"Project is using OrioleDB and cannot be disabled":null:"You need additional permissions to toggle extensions"})]})})]}),(0,n.jsx)(ek.A,{visible:h,extension:i,onCancel:()=>f(!1),"data-sentry-element":"EnableExtensionModal","data-sentry-source-file":"ExtensionRow.tsx"}),(0,n.jsx)(e_.A,{visible:u,title:"Confirm to disable extension",confirmLabel:"Disable",variant:"destructive",confirmLabelLoading:"Disabling",onCancel:()=>p(!1),onConfirm:()=>_(),"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"ExtensionRow.tsx",children:(0,n.jsxs)("div",{className:"flex flex-col gap-y-3",children:[(0,n.jsxs)("p",{className:"text-sm text-foreground-light",children:['Are you sure you want to turn OFF the "',i.name,'" extension?']}),eI[i.name]&&(0,n.jsx)(eR.Z,{type:"warning",className:"m-0",children:eI[i.name]})]})})]})},eP=()=>{let{filter:e}=(0,eu.g)(),{data:t}=(0,g.YA)(),[a,r]=(0,m.useState)(""),{data:i,isLoading:o}=(0,ep.z)({projectRef:null==t?void 0:t.ref,connectionString:null==t?void 0:t.connectionString}),c=0===a.length?null!=i?i:[]:(null!=i?i:[]).filter(e=>{let t=e.name.toLowerCase().includes(a.toLowerCase()),n=(eF[e.name]||[]).some(e=>e.includes(a.toLowerCase()));return t||n}),u=c.filter(e=>!eT.includes(e.name)),[x,h]=l()(u,e=>!ed()(e.installed_version)),{can:f,isSuccess:y}=(0,j.hl)(s.aG.TENANT_SQL_ADMIN_WRITE,"extensions");return(0,m.useEffect)(()=>{void 0!==e&&r(e)},[e]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"mb-4",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)(b.A,{size:"tiny",placeholder:"Search for an extension",value:a,onChange:e=>r(e.target.value),className:"w-52",icon:(0,n.jsx)(d.A,{size:14}),"data-sentry-element":"Input","data-sentry-source-file":"Extensions.tsx"}),(0,n.jsx)(em.A,{href:"https://supabase.com/docs/guides/database/extensions","data-sentry-element":"DocsButton","data-sentry-source-file":"Extensions.tsx"})]})}),y&&!f&&(0,n.jsx)(ex.A,{icon:(0,n.jsx)(ec.A,{className:"text-foreground-light",size:18,strokeWidth:2}),title:"You need additional permissions to update database extensions"}),o?(0,n.jsx)(er.y,{}):(0,n.jsx)("div",{className:"w-full overflow-hidden overflow-x-auto",children:(0,n.jsx)(eh.Zp,{children:(0,n.jsxs)(ef.XI,{children:[(0,n.jsx)(ef.A0,{children:(0,n.jsxs)(ef.Hj,{children:[(0,n.jsx)(ef.nd,{children:"Name"},"name"),(0,n.jsx)(ef.nd,{children:"Version"},"version"),(0,n.jsx)(ef.nd,{children:"Schema"},"schema"),(0,n.jsx)(ef.nd,{children:"Description"},"description"),(0,n.jsx)(ef.nd,{children:"Used by"},"used-by"),(0,n.jsx)(ef.nd,{children:"Links"},"links"),(0,n.jsx)(ef.nd,{className:"w-20 bg-background-200 border-l sticky right-0",children:"Enabled"},"enabled")]})}),(0,n.jsxs)(ef.BF,{children:[[...x,...h].map(e=>(0,n.jsx)(eL,{extension:e},e.name)),0===c.length&&(0,n.jsx)(ef.Hj,{children:(0,n.jsx)(ef.nA,{colSpan:7,children:(0,n.jsx)(p.A,{className:"border-none !p-0 bg-transparent",searchString:a,onResetFilter:()=>r("")})})})]})]})})})]})};var eB=a(53434),ez=a.n(eB),eD=a(80173),eM=a(67908),eV=a(91437),eY=a(43529),eZ=a(70938);async function eq(e){let{ref:t,backup:a}=e;if(a.isPhysicalBackup){let{data:e,error:n}=await (0,eZ.bE)("/platform/database/{ref}/backups/restore-physical",{params:{path:{ref:t}},body:{id:a.id,recovery_time_target:a.inserted_at}});if(n)throw n;return e}let{data:n,error:s}=await (0,eZ.bE)("/platform/database/{ref}/backups/restore",{params:{path:{ref:t}},body:{id:a.id}});return s&&(0,eZ.H4)(s),n}let e$=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,T.n)(e=>eq(e),{async onSuccess(t,a,n){await (null==e?void 0:e(t,a,n))},async onError(e,a,n){void 0===t?A.oR.error("Failed to restore from backup: ".concat(e.message)):t(e,a,n)},...a})};var eO=a(71251),eU=a(61789),eH=a(74144),eW=a(35485),eJ=a(89422),eK=a(87812),eG=a(92737);let eX=e=>{let{index:t,isHealthy:a,backup:r,onSelectBackup:l}=e,{ref:i}=(0,eu.g)(),{can:o}=(0,j.hl)(s.aG.INFRA_EXECUTE,"queue_job.restore.prepare"),{mutate:d,isLoading:c}=(0,eK.Z)({onSuccess:e=>{let{fileUrl:t}=e,a=document.createElement("a");a.href=t,document.body.appendChild(a),a.click(),document.body.removeChild(a)}});return(0,n.jsxs)("div",{className:"flex h-12 items-center justify-between px-6 ".concat(t?"border-t border-default":""),"data-sentry-component":"BackupItem","data-sentry-source-file":"BackupItem.tsx",children:[(0,n.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,n.jsx)(eG.T,{displayAs:"utc",utcTimestamp:r.inserted_at,labelFormat:"DD MMM YYYY HH:mm:ss (ZZ)",className:"text-left !text-sm font-mono tracking-tight","data-sentry-element":"TimestampInfo","data-sentry-source-file":"BackupItem.tsx"}),(0,n.jsxs)(N.m_,{"data-sentry-element":"Tooltip","data-sentry-source-file":"BackupItem.tsx",children:[(0,n.jsx)(N.k$,{"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"BackupItem.tsx",children:(0,n.jsx)(w.E,{variant:"default","data-sentry-element":"Badge","data-sentry-source-file":"BackupItem.tsx",children:r.isPhysicalBackup?"Physical":"Logical"})}),(0,n.jsxs)(N.ZI,{side:"bottom","data-sentry-element":"TooltipContent","data-sentry-source-file":"BackupItem.tsx",children:["Learn more about backup types"," ",(0,n.jsx)(eJ.g,{href:"https://supabase.com/blog/postgresql-physical-logical-backups","data-sentry-element":"InlineLink","data-sentry-source-file":"BackupItem.tsx",children:"here"})]})]})]}),(0,n.jsx)("div",{children:(e=>"COMPLETED"===e.status?(0,n.jsxs)("div",{className:"flex space-x-4",children:[(0,n.jsx)(x.G,{type:"default",disabled:!a||!o,onClick:l,tooltip:{content:{side:"bottom",text:a?o?void 0:"You need additional permissions to trigger a restore":"Cannot be restored as project is not active"}},children:"Restore"}),(0,n.jsx)(x.G,{type:"default",icon:(0,n.jsx)(eW.A,{}),loading:c,disabled:!o||c||e.isPhysicalBackup,onClick:()=>{if(!i)return console.error("Project ref is required");d({ref:i,backup:e})},tooltip:{content:{side:"bottom",className:e.isPhysicalBackup?"w-64":"",text:e.isPhysicalBackup?(0,n.jsxs)(n.Fragment,{children:["Physical backups cannot be downloaded through the dashboard. You can still download it via pgdump by following our guide"," ",(0,n.jsx)(eJ.g,{href:"https://supabase.com/docs/guides/troubleshooting/download-logical-backups",children:"here"}),"."]}):o?void 0:"You need additional permissions to download backups"}},children:"Download"})]}):(0,n.jsx)(w.E,{variant:"warning","data-sentry-element":"Badge","data-sentry-component":"generateSideButtons","data-sentry-source-file":"BackupItem.tsx",children:"Backup In Progress..."}))(r)})]})};var eQ=a(67247),e0=a(64795);let e1=()=>{var e,t;let a=(0,eM.useRouter)(),s=(0,k.jE)(),{ref:r}=(0,eu.g)(),{data:l}=(0,g.YA)(),i=(null==l?void 0:l.status)===eH.BU.ACTIVE_HEALTHY,[o,d]=(0,m.useState)(),{data:c}=(0,eO.h)({projectRef:r}),{mutate:u,isLoading:x,isSuccess:p}=e$({onSuccess:()=>{r&&setTimeout(()=>{(0,eU.Mi)(s,r,eH.BU.RESTORING),A.oR.success("Restoring database back to ".concat(ez()(null==o?void 0:o.inserted_at).format("DD MMM YYYY HH:mm:ss"))),a.push("/project/".concat(r))},3e3)}}),h=null!=(e=null==c?void 0:c.tierKey)?e:"",f=(null!=(t=null==c?void 0:c.backups)?t:[]).sort((e,t)=>new Date(t.inserted_at).valueOf()-new Date(e.inserted_at).valueOf()),y=null==c?void 0:c.pitr_enabled;return"FREE"===h?(0,n.jsx)(eY.A,{addon:"pitr",icon:(0,n.jsx)(eD.A,{size:20}),primaryText:"Free Plan does not include project backups.",secondaryText:"Upgrade to the Pro Plan for up to 7 days of scheduled backups.",source:"backups"}):y?null:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"space-y-6",children:0===f.length&&"FREE"!==h?(0,n.jsx)(eQ.V,{}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e0.$,{}),(0,n.jsx)(eV.A,{children:null==f?void 0:f.map((e,t)=>(0,n.jsx)(eX,{backup:e,index:t,isHealthy:i,onSelectBackup:()=>d(e)},e.id))})]})}),(0,n.jsx)(e_.A,{size:"medium",confirmLabel:"Confirm restore",confirmLabelLoading:"Restoring",visible:void 0!==o,title:"Confirm to restore from backup",alert:{base:{variant:"warning"},title:"Your project will be offline while the restore is in progress",description:"It is advised to upgrade at a time when there will be minimal impact for your application."},loading:x||p,onCancel:()=>d(void 0),onConfirm:()=>void 0===r?console.error("Project ref required"):void 0===o?console.error("Backup required"):void u({ref:r,backup:o}),"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"BackupsList.tsx",children:(0,n.jsxs)("p",{className:"text-sm",children:["Are you sure you want to restore from"," ",ez()(null==o?void 0:o.inserted_at).format("DD MMM YYYY"),"? This will destroy any new data written since this backup was made."]})})]})};var e2=a(97344),e3=a.n(e2),e4=a(30075),e5=a.n(e4),e6=a(44217),e8=a.n(e6),e9=a(56230),e7=a(34763),te=a(28175);async function tt(e){let{projectRef:t,connectionString:a,payload:n}=e,{sql:s,zod:r}=_.A.functions.create(n),{result:l}=await (0,F.E)({projectRef:t,connectionString:a,sql:s,queryKey:["functions","create"]});return l}let ta=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,k.jE)();return(0,T.n)(e=>tt(e),{async onSuccess(t,a,s){let{projectRef:r}=a;await n.invalidateQueries(te.c.databaseFunctions(r)),await (null==e?void 0:e(t,a,s))},async onError(e,a,n){void 0===t?A.oR.error("Failed to create database function: ".concat(e.message)):t(e,a,n)},...a})};async function tn(e){let{projectRef:t,connectionString:a,func:n,payload:s}=e,{sql:r,zod:l}=_.A.functions.update(n,s),{result:i}=await (0,F.E)({projectRef:t,connectionString:a,sql:r,queryKey:["functions","update",n.id.toString()]});return i}let ts=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,k.jE)();return(0,T.n)(e=>tn(e),{async onSuccess(t,a,s){let{projectRef:r}=a;await n.invalidateQueries(te.c.databaseFunctions(r)),await (null==e?void 0:e(t,a,s))},async onError(e,a,n){void 0===t?A.oR.error("Failed to update database function: ".concat(e.message)):t(e,a,n)},...a})};var tr=a(62308),tl=a(20235),ti=a(39119),to=a(59130),td=a(50033),tc=a(7767),tu=a(57374),tm=a(11301);let tx=e=>{let{selectedFunction:t,assistantVisible:a,setAssistantVisible:s}=e;return(0,n.jsx)(tl.Fm,{className:"py-3 flex flex-row justify-between items-center border-b-0","data-sentry-element":"SheetHeader","data-sentry-component":"CreateFunctionHeader","data-sentry-source-file":"CreateFunctionHeader.tsx",children:(0,n.jsxs)("div",{className:"flex flex-row gap-3 items-center max-w-[75%]",children:[(0,n.jsxs)(tl.kN,{className:(0,W.cn)("text-muted hover:text ring-offset-background transition-opacity hover:opacity-100","focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2","disabled:pointer-events-none data-[state=open]:bg-secondary","transition"),"data-sentry-element":"SheetClose","data-sentry-source-file":"CreateFunctionHeader.tsx",children:[(0,n.jsx)(c.A,{className:"h-3 w-3","data-sentry-element":"X","data-sentry-source-file":"CreateFunctionHeader.tsx"}),(0,n.jsx)("span",{className:"sr-only",children:"Close"})]}),(0,n.jsx)(tl.qp,{className:"truncate","data-sentry-element":"SheetTitle","data-sentry-source-file":"CreateFunctionHeader.tsx",children:void 0!==t?"Edit '".concat(t,"' function"):"Add a new function"})]})})};var tp=a(10166),th=a(51968),tf=a(12183);let ty=e=>{let{field:t,language:a,focused:s,setFocused:r}=e;return(0,n.jsxs)("div",{className:(0,W.cn)("rounded-md relative group flex-grow"),"data-sentry-component":"FunctionEditor","data-sentry-source-file":"FunctionEditor.tsx",children:[(0,n.jsx)(B.MJ,{"data-sentry-element":"FormControl_Shadcn_","data-sentry-source-file":"FunctionEditor.tsx",children:void 0!==a&&(0,n.jsx)(tf.A,{id:"database-functions-editor",language:"pgsql",placeholder:"plpgsql"===a?"BEGIN\n\nEND;":void 0,value:t.value,onInputChange:t.onChange})}),(0,n.jsx)("div",{className:(0,W.cn)("absolute top-0 right-2 bg-surface-300 border border-strong rounded h-[28px]","opacity-0 group-hover:opacity-100 group-hover:top-2 transition-all"),children:(0,n.jsxs)(N.m_,{"data-sentry-element":"Tooltip","data-sentry-source-file":"FunctionEditor.tsx",children:[(0,n.jsx)(N.k$,{asChild:!0,"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"FunctionEditor.tsx",children:(0,n.jsx)(v.$,{type:"text",size:"tiny",className:(0,W.cn)("px-1.5 text-foreground-lighter hover:text-foreground","transition z-50"),onClick:()=>r(!s),icon:s?(0,n.jsx)(tp.A,{}):(0,n.jsx)(th.A,{}),"data-sentry-element":"Button","data-sentry-source-file":"FunctionEditor.tsx"})}),(0,n.jsx)(N.ZI,{side:"bottom","data-sentry-element":"TooltipContent","data-sentry-source-file":"FunctionEditor.tsx",children:s?"Minimize editor":"Maximize editor"})]})})]})},tj="create-function-sidepanel",tg=E.Ay.object({name:E.Ay.string().trim().min(1),schema:E.Ay.string().trim().min(1),args:E.Ay.array(E.Ay.object({name:E.Ay.string().trim().min(1),type:E.Ay.string().trim()})),behavior:E.Ay.enum(["IMMUTABLE","STABLE","VOLATILE"]),definition:E.Ay.string().trim().min(1),language:E.Ay.string().trim(),return_type:E.Ay.string().trim(),security_definer:E.Ay.boolean(),config_params:E.Ay.array(E.Ay.object({name:E.Ay.string().trim().min(1),value:E.Ay.string().trim().min(1)})).optional()}),tb=e=>{let{func:t,visible:a,setVisible:s}=e,{data:r}=(0,g.YA)(),[l,i]=(0,m.useState)(!1),[o,d]=(0,m.useState)(!1),[c,u]=(0,m.useState)(!1),[x,p]=(0,m.useState)(!1),h=!!(null==t?void 0:t.id),f=(0,C.mN)({resolver:(0,S.u)(tg)}),y=f.watch("language"),{mutate:j,isLoading:b}=ta(),{mutate:N,isLoading:w}=ts();function E(){f.formState.isDirty?i(!0):s(!a)}let R=async e=>{if(!r)return console.error("Project is required");let n={...e,args:e.args.map(e=>"".concat(e.name," ").concat(e.type)),config_params:e8()(e5()(e.config_params,"name"),"value")};h?N({func:t,projectRef:r.ref,connectionString:r.connectionString,payload:n},{onSuccess:()=>{A.oR.success("Successfully updated function ".concat(e.name)),s(!a)}}):j({projectRef:r.ref,connectionString:r.connectionString,payload:n},{onSuccess:()=>{A.oR.success("Successfully created function ".concat(e.name)),s(!a)}})};(0,m.useEffect)(()=>{if(a){var e,n,s,r,l,i,o;p(!1),f.reset({name:null!=(e=null==t?void 0:t.name)?e:"",schema:null!=(n=null==t?void 0:t.schema)?n:"public",args:(0,tm.GQ)((null==t?void 0:t.argument_types)||"").value,behavior:null!=(s=null==t?void 0:t.behavior)?s:"VOLATILE",definition:null!=(r=null==t?void 0:t.definition)?r:"",language:null!=(l=null==t?void 0:t.language)?l:"plpgsql",return_type:null!=(i=null==t?void 0:t.return_type)?i:"void",security_definer:null!=(o=null==t?void 0:t.security_definer)&&o,config_params:(0,tm.Il)(null==t?void 0:t.config_params).value})}},[a,t]);let{data:_}=(0,tr.Uu)();return(0,n.jsx)(tl.cj,{open:a,onOpenChange:()=>E(),"data-sentry-element":"Sheet","data-sentry-component":"CreateFunction","data-sentry-source-file":"index.tsx",children:(0,n.jsxs)(tl.h,{showClose:!1,size:c?"lg":"default",className:(0,W.cn)("p-0 flex flex-row gap-0",c?"!min-w-screen lg:!min-w-[1200px]":"!min-w-screen lg:!min-w-[600px]"),"data-sentry-element":"SheetContent","data-sentry-source-file":"index.tsx",children:[(0,n.jsxs)("div",{className:(0,W.cn)("flex flex-col grow w-full",c&&"w-[60%]"),children:[(0,n.jsx)(tx,{selectedFunction:null==t?void 0:t.name,assistantVisible:c,setAssistantVisible:u,"data-sentry-element":"CreateFunctionHeader","data-sentry-source-file":"index.tsx"}),(0,n.jsx)(ti.w,{"data-sentry-element":"Separator","data-sentry-source-file":"index.tsx"}),(0,n.jsx)(B.lV,{...f,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"index.tsx",children:(0,n.jsxs)("form",{id:tj,className:"flex-grow overflow-auto",onSubmit:f.handleSubmit(R),children:[(0,n.jsx)(tl.Xc,{className:x?"hidden":"","data-sentry-element":"SheetSection","data-sentry-source-file":"index.tsx",children:(0,n.jsx)(B.zB,{control:f.control,name:"name",render:e=>{let{field:t}=e;return(0,n.jsx)(tu.M,{label:"Name of function",description:"Name will also be used for the function name in postgres",layout:"horizontal",children:(0,n.jsx)(B.MJ,{children:(0,n.jsx)(z.p,{...t,placeholder:"Name of function"})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"index.tsx"})}),(0,n.jsx)(ti.w,{className:x?"hidden":"","data-sentry-element":"Separator","data-sentry-source-file":"index.tsx"}),(0,n.jsxs)(tl.Xc,{className:x?"hidden":"space-y-4","data-sentry-element":"SheetSection","data-sentry-source-file":"index.tsx",children:[(0,n.jsx)(B.zB,{control:f.control,name:"schema",render:e=>{let{field:t}=e;return(0,n.jsx)(tu.M,{label:"Schema",description:"Tables made in the table editor will be in 'public'",layout:"horizontal",children:(0,n.jsx)(B.MJ,{children:(0,n.jsx)(e7.A,{portal:!1,selectedSchemaName:t.value,excludedSchemas:null==_?void 0:_.map(e=>e.name),size:"small",onSelectSchema:e=>t.onChange(e)})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"index.tsx"}),!h&&(0,n.jsx)(B.zB,{control:f.control,name:"return_type",render:e=>{let{field:t}=e;return(0,n.jsx)(tu.M,{label:"Return type",layout:"horizontal",children:(0,n.jsxs)(to.l6,{onValueChange:t.onChange,defaultValue:t.value,children:[(0,n.jsx)(to.bq,{className:"col-span-8",children:(0,n.jsx)(to.yv,{})}),(0,n.jsx)(to.gC,{children:(0,n.jsx)(td.FK,{className:"h-52",children:["void","record","trigger","integer",...e9.x0].map(e=>(0,n.jsx)(to.eb,{value:e,children:e},e))})})]})})}})]}),(0,n.jsx)(ti.w,{className:x?"hidden":"","data-sentry-element":"Separator","data-sentry-source-file":"index.tsx"}),(0,n.jsx)(tl.Xc,{className:x?"hidden":"","data-sentry-element":"SheetSection","data-sentry-source-file":"index.tsx",children:(0,n.jsx)(tv,{readonly:h,"data-sentry-element":"FormFieldArgs","data-sentry-source-file":"index.tsx"})}),(0,n.jsx)(ti.w,{className:x?"hidden":"","data-sentry-element":"Separator","data-sentry-source-file":"index.tsx"}),(0,n.jsx)(tl.Xc,{className:"".concat(x?"h-full":""," !px-0"),"data-sentry-element":"SheetSection","data-sentry-source-file":"index.tsx",children:(0,n.jsx)(B.zB,{control:f.control,name:"definition",render:e=>{let{field:t}=e;return(0,n.jsxs)(B.eI,{className:"space-y-4 flex flex-col h-full",children:[(0,n.jsxs)("div",{className:"px-content",children:[(0,n.jsx)(B.lR,{className:"text-base text-foreground",children:"Definition"}),(0,n.jsxs)(B.Rr,{className:"text-sm text-foreground-light",children:[(0,n.jsxs)("p",{children:["The language below should be written in ",(0,n.jsx)("code",{children:y}),"."]}),!h&&(0,n.jsx)("p",{children:"Change the language in the Advanced Settings below."})]})]}),(0,n.jsx)("div",{className:(0,W.cn)("border border-default flex",x?"flex-grow ":"h-72"),children:(0,n.jsx)(ty,{field:t,language:y,focused:x,setFocused:p})}),(0,n.jsx)(B.C5,{className:"px-content"})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"index.tsx"})}),(0,n.jsx)(ti.w,{className:x?"hidden":"","data-sentry-element":"Separator","data-sentry-source-file":"index.tsx"}),h?(0,n.jsx)(n.Fragment,{}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(tl.Xc,{className:x?"hidden":"",children:(0,n.jsx)("div",{className:"space-y-8 rounded bg-studio py-4 px-6 border border-overlay",children:(0,n.jsx)(G.A,{onChange:()=>d(!o),label:"Show advanced settings",checked:o,labelOptional:"These are settings that might be familiar for Postgres developers"})})}),o&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(tl.Xc,{className:x?"hidden":"space-y-2 pt-0",children:[(0,n.jsx)(tS,{}),(0,n.jsx)(B.zB,{control:f.control,name:"behavior",render:e=>{let{field:t}=e;return(0,n.jsx)(tu.M,{label:"Behavior",layout:"horizontal",children:(0,n.jsxs)(to.l6,{defaultValue:t.value,onValueChange:t.onChange,children:[(0,n.jsx)(to.bq,{className:"col-span-8",children:(0,n.jsx)(to.yv,{})}),(0,n.jsxs)(to.gC,{children:[(0,n.jsx)(to.eb,{value:"IMMUTABLE",children:"immutable"},"IMMUTABLE"),(0,n.jsx)(to.eb,{value:"STABLE",children:"stable"},"STABLE"),(0,n.jsx)(to.eb,{value:"VOLATILE",children:"volatile"},"VOLATILE")]})]})})}})]}),(0,n.jsx)(ti.w,{className:x?"hidden":""}),(0,n.jsx)(tl.Xc,{className:x?"hidden":"",children:(0,n.jsx)(tN,{readonly:h})}),(0,n.jsx)(ti.w,{className:x?"hidden":""}),(0,n.jsxs)(tl.Xc,{className:x?"hidden":"",children:[(0,n.jsx)("h5",{className:"text-base text-foreground mb-4",children:"Type of Security"}),(0,n.jsx)(B.zB,{control:f.control,name:"security_definer",render:e=>{let{field:t}=e;return(0,n.jsxs)(B.eI,{children:[(0,n.jsx)(B.MJ,{className:"col-span-8",children:(0,n.jsxs)(tc.A.Group,{type:"cards",layout:"vertical",onChange:e=>t.onChange("SECURITY_DEFINER"==e.target.value),value:t.value?"SECURITY_DEFINER":"SECURITY_INVOKER",children:[(0,n.jsx)(tc.A,{id:"SECURITY_INVOKER",label:"SECURITY INVOKER",value:"SECURITY_INVOKER",checked:!t.value,description:(0,n.jsxs)(n.Fragment,{children:["Function is to be executed with the privileges of the user that ",(0,n.jsx)("span",{className:"text-foreground",children:"calls it"}),"."]})}),(0,n.jsx)(tc.A,{id:"SECURITY_DEFINER",label:"SECURITY DEFINER",value:"SECURITY_DEFINER",checked:t.value,description:(0,n.jsxs)(n.Fragment,{children:["Function is to be executed with the privileges of the user that ",(0,n.jsx)("span",{className:"text-foreground",children:"created it"}),"."]})})]})}),(0,n.jsx)(B.C5,{})]})}})]})]})]})]})}),(0,n.jsxs)(tl.XW,{"data-sentry-element":"SheetFooter","data-sentry-source-file":"index.tsx",children:[(0,n.jsx)(v.$,{disabled:b||w,type:"default",onClick:E,"data-sentry-element":"Button","data-sentry-source-file":"index.tsx",children:"Cancel"}),(0,n.jsx)(v.$,{form:tj,htmlType:"submit",disabled:b||w,loading:b||w,"data-sentry-element":"Button","data-sentry-source-file":"index.tsx",children:"Confirm"})]})]}),c?(0,n.jsx)("div",{className:"border-l shadow-[rgba(0,0,0,0.13)_-4px_0px_6px_0px] z-10 w-[50%] bg-studio"}):null,(0,n.jsx)(e_.A,{visible:l,title:"Discard changes",confirmLabel:"Discard",onCancel:()=>i(!1),onConfirm:()=>{i(!1),s(!a)},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"index.tsx",children:(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"There are unsaved changes. Are you sure you want to close the panel? Your changes will be lost."})})]})})},tv=e=>{let{readonly:t}=e,{fields:a,append:s,remove:r}=(0,C.jz)({name:"args"});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)("h5",{className:"text-base text-foreground",children:"Arguments"}),(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"Arguments can be referenced in the function body using either names or numbers."})]}),(0,n.jsxs)("div",{className:"space-y-2 pt-4",children:[t&&e3()(a)&&(0,n.jsx)("span",{className:"text-foreground-lighter",children:"No argument for this function"}),a.map((e,a)=>(0,n.jsxs)("div",{className:"flex flex-row space-x-1",children:[(0,n.jsx)(B.zB,{name:"args.".concat(a,".name"),render:e=>{let{field:a}=e;return(0,n.jsxs)(B.eI,{className:"flex-1",children:[(0,n.jsx)(B.MJ,{children:(0,n.jsx)(z.p,{...a,disabled:t,placeholder:"argument_name"})}),(0,n.jsx)(B.C5,{})]})}}),(0,n.jsx)(B.zB,{name:"args.".concat(a,".type"),render:e=>{let{field:a}=e;return(0,n.jsxs)(B.eI,{className:"flex-1",children:[(0,n.jsx)(B.MJ,{children:t?(0,n.jsx)(z.p,{value:a.value,disabled:!0,readOnly:!0,className:"h-auto"}):(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(to.l6,{disabled:t,onValueChange:a.onChange,defaultValue:a.value,children:[(0,n.jsx)(to.bq,{className:"h-[38px]",children:(0,n.jsx)(to.yv,{})}),(0,n.jsx)(to.gC,{children:(0,n.jsx)(td.FK,{className:"h-52",children:["integer",...e9.x0].map(e=>(0,n.jsx)(to.eb,{value:e,children:e},e))})})]})})}),(0,n.jsx)(B.C5,{})]})}}),!t&&(0,n.jsx)(v.$,{type:"danger",icon:(0,n.jsx)(ea.A,{size:12}),onClick:()=>r(a),className:"h-[38px] w-[38px]"})]},e.id)),!t&&(0,n.jsx)(v.$,{type:"default",icon:(0,n.jsx)(u.A,{size:12}),onClick:()=>s({name:"",type:"integer"}),disabled:t,children:"Add a new argument"})]})]})},tN=e=>{let{readonly:t}=e,{fields:a,append:s,remove:r}=(0,C.jz)({name:"config_params"});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h5",{className:"text-base text-foreground",children:"Configuration Parameters"}),(0,n.jsxs)("div",{className:"space-y-2 pt-4",children:[t&&e3()(a)&&(0,n.jsx)("span",{className:"text-foreground-lighter",children:"No argument for this function"}),a.map((e,a)=>(0,n.jsxs)("div",{className:"flex flex-row space-x-1",children:[(0,n.jsx)(B.zB,{name:"config_params.".concat(a,".name"),render:e=>{let{field:t}=e;return(0,n.jsxs)(B.eI,{className:"flex-1",children:[(0,n.jsx)(B.MJ,{children:(0,n.jsx)(z.p,{...t,placeholder:"parameter_name"})}),(0,n.jsx)(B.C5,{})]})}}),(0,n.jsx)(B.zB,{name:"config_params.".concat(a,".value"),render:e=>{let{field:t}=e;return(0,n.jsxs)(B.eI,{className:"flex-1",children:[(0,n.jsx)(B.MJ,{children:(0,n.jsx)(z.p,{...t,placeholder:"parameter_value"})}),(0,n.jsx)(B.C5,{})]})}}),!t&&(0,n.jsx)(v.$,{type:"danger",icon:(0,n.jsx)(ea.A,{size:12}),onClick:()=>r(a),className:"h-[38px] w-[38px]"})]},e.id)),!t&&(0,n.jsx)(v.$,{type:"default",icon:(0,n.jsx)(u.A,{size:12}),onClick:()=>s({name:"",type:""}),disabled:t,children:"Add a new config"})]})]})},tw=["plpgsql","sql","plcoffee","plv8","plls"],tS=()=>{let{data:e}=(0,g.YA)(),{data:t}=(0,ep.z)({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString},{select:e=>l()(e,e=>!ed()(e.installed_version))[0]}),a=(0,m.useMemo)(()=>tw.filter(e=>!e.startsWith("pl")||(null==t?void 0:t.find(t=>t.name===e))!==void 0),[t]);return(0,n.jsx)(B.zB,{name:"language",render:e=>{let{field:t}=e;return(0,n.jsx)(tu.M,{label:"Language",layout:"horizontal",children:(0,n.jsxs)(to.l6,{onValueChange:t.onChange,defaultValue:t.value,children:[(0,n.jsx)(to.bq,{className:"col-span-8",children:(0,n.jsx)(to.yv,{})}),(0,n.jsx)(to.gC,{children:a.map(e=>(0,n.jsx)(to.eb,{value:e,children:e},e))})]})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-component":"FormFieldLanguage","data-sentry-source-file":"index.tsx"})};async function tC(e){let{projectRef:t,connectionString:a,func:n}=e,{sql:s,zod:r}=_.A.functions.remove(n),{result:l}=await (0,F.E)({projectRef:t,connectionString:a,sql:s,queryKey:["functions","delete",n.id.toString()]});return l}let tA=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,k.jE)();return(0,T.n)(e=>tC(e),{async onSuccess(t,a,s){let{projectRef:r}=a;await n.invalidateQueries(te.c.databaseFunctions(r)),await (null==e?void 0:e(t,a,s))},async onError(e,a,n){void 0===t?A.oR.error("Failed to delete database function: ".concat(e.message)):t(e,a,n)},...a})};var tE=a(2772);let tR=e=>{let{func:t,visible:a,setVisible:s}=e,{data:r}=(0,g.YA)(),{name:l,schema:i}=null!=t?t:{},{mutate:o,isLoading:d}=tA({onSuccess:()=>{A.oR.success("Successfully removed function ".concat(l)),s(!1)}});async function c(){return t?r?void o({func:t,projectRef:r.ref,connectionString:r.connectionString}):console.error("Project is required"):console.error("Function is required")}return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(tE.A,{variant:"warning",visible:a,onCancel:()=>s(!a),onConfirm:c,title:"Delete this function",loading:d,confirmLabel:"Delete function ".concat(l),confirmPlaceholder:"Type in name of function",confirmString:null!=l?l:"Unknown",text:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{children:"This will delete the function"})," ",(0,n.jsx)("span",{className:"text-bold text-foreground",children:l})," ",(0,n.jsx)("span",{children:"from the schema"})," ",(0,n.jsx)("span",{className:"text-bold text-foreground",children:i})]}),alert:{title:"You cannot recover this function once deleted."},"data-sentry-element":"TextConfirmModal","data-sentry-source-file":"DeleteFunction.tsx"})})};var t_=a(96196),tk=a(92589),tT=a(30145),tF=a(68997),tI=a(69654),tL=a(63121),tP=a(68889),tB=a(10663),tz=a(57112),tD=a(79650);async function tM(e){let{projectRef:t,connectionString:a,schema:n,name:s,description:r,values:l}=e,i='create type "'.concat(n,'"."').concat(s,'" as enum (').concat(l.map(e=>"'".concat(e,"'")).join(", "),");"),o=void 0!==r?'comment on type "'.concat(n,'"."').concat(s,"\" is '").concat(r,"';"):"",d=(0,tz.d)("".concat(i," ").concat(o)),{result:c}=await (0,F.E)({projectRef:t,connectionString:a,sql:d});return c}let tV=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,k.jE)();return(0,T.n)(e=>tM(e),{async onSuccess(t,a,s){let{projectRef:r}=a;await n.invalidateQueries(tD.K.list(r)),await (null==e?void 0:e(t,a,s))},async onError(e,a,n){void 0===t?A.oR.error("Failed to create enumerated type: ".concat(e.message)):t(e,a,n)},...a})};var tY=a(38112),tZ=a(73318);let tq=e=>{let{index:t,id:a,field:s,isDisabled:r=!1,onRemoveValue:l}=e;return(0,n.jsx)(tP.sx,{draggableId:a,index:t,isDragDisabled:r,"data-sentry-element":"Draggable","data-sentry-component":"EnumeratedTypeValueRow","data-sentry-source-file":"EnumeratedTypeValueRow.tsx",children:e=>(0,n.jsxs)("div",{ref:e.innerRef,...e.draggableProps,className:"flex items-center space-x-2 space-y-2",children:[(0,n.jsx)("div",{...e.dragHandleProps,className:"opacity-50 hover:opacity-100 transition ".concat(r?"text-foreground-lighter !cursor-default":"text-foreground"),children:(0,n.jsx)(tZ.A,{size:16,strokeWidth:1.5})}),(0,n.jsx)(z.p,{...s,className:"w-full"}),(0,n.jsx)(v.$,{type:"default",size:"small",disabled:r,icon:(0,n.jsx)(ea.A,{strokeWidth:1.5,size:16}),className:"px-2",onClick:()=>l()})]})})},t$=[...e9.N1,...e9.AL,...e9.J_,...e9.aw,...e9.mL,...e9.J5,...e9.wB,"bigint","bigserial","bit","bit varying","boolean","box","bytea","char","character","character varying","cidr","circle","date","double precision","inet","int","integer","interval","line","lseg","macaddr","macaddr8","money","numeric","decimal","path","pg_lsn","pg_snapshot","point","polygon","real","smallint","smallserial","serial","time with timezone","timestamp with timezone","tsquery","tsvector","txid_snapshot","xml"],tO=e=>{let{visible:t,onClose:a,schema:s}=e,r={name:"",description:"",values:[{value:""}]},l=(0,m.useRef)(null),{data:i}=(0,g.YA)(),{mutate:o,isLoading:d}=tV({onSuccess:(e,t)=>{A.oR.success('Successfully created type "'.concat(t.name,'"')),b()}});(0,m.useEffect)(()=>{x.reset(r)},[t]);let c=tB.Ik({name:tB.Yj().min(1,"Please provide a name for your enumerated type").refine(e=>!t$.includes(e),{message:"Name cannot be a native Postgres data type"}).default(""),description:tB.Yj().default("").optional(),values:tB.Ik({value:tB.Yj().min(1,"Please provide a value")}).array().default([])}),x=(0,C.mN)({resolver:(0,S.u)(c),defaultValues:r}),{fields:p,append:h,remove:f,move:y}=(0,C.jz)({name:"values",control:x.control}),j=e=>{e.destination&&y(e.source.index,e.destination.index)},b=()=>{x.reset(r),a()};return(0,n.jsx)(P.Ay,{loading:d,visible:t,onCancel:b,header:"Create a new enumerated type",confirmText:"Create type",onConfirm:()=>{l.current&&l.current.click()},"data-sentry-element":"SidePanel","data-sentry-component":"CreateEnumeratedTypeSidePanel","data-sentry-source-file":"CreateEnumeratedTypeSidePanel.tsx",children:(0,n.jsx)(P.Ay.Content,{className:"py-4","data-sentry-element":"SidePanel.Content","data-sentry-source-file":"CreateEnumeratedTypeSidePanel.tsx",children:(0,n.jsx)(B.lV,{...x,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"CreateEnumeratedTypeSidePanel.tsx",children:(0,n.jsxs)("form",{className:"space-y-4",onSubmit:x.handleSubmit(e=>{var t;return(null==i?void 0:i.ref)===void 0?console.error("Project ref required"):(null==i?void 0:i.connectionString)===void 0?console.error("Project connectionString required"):void o({projectRef:i.ref,connectionString:i.connectionString,schema:s,name:e.name,description:null==(t=e.description)?void 0:t.replaceAll("'","''"),values:e.values.filter(e=>e.value.length>0).map(e=>e.value.trim())})}),children:[(0,n.jsx)(B.zB,{control:x.control,name:"name",render:e=>{let{field:t}=e;return(0,n.jsxs)(B.eI,{children:[(0,n.jsx)(B.lR,{children:"Name"}),(0,n.jsx)(B.MJ,{children:(0,n.jsx)(z.p,{...t})}),(0,n.jsx)(B.C5,{})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreateEnumeratedTypeSidePanel.tsx"}),(0,n.jsx)(B.zB,{control:x.control,name:"description",render:e=>{let{field:t}=e;return(0,n.jsxs)(B.eI,{children:[(0,n.jsx)(B.lR,{children:"Description"}),(0,n.jsx)(B.MJ,{children:(0,n.jsx)(z.p,{...t})}),(0,n.jsx)(B.Rr,{children:"Optional"})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreateEnumeratedTypeSidePanel.tsx"}),(0,n.jsx)(tP.JY,{onDragEnd:e=>j(e),"data-sentry-element":"DragDropContext","data-sentry-source-file":"CreateEnumeratedTypeSidePanel.tsx",children:(0,n.jsx)(tP.gL,{droppableId:"enum_type_values_droppable","data-sentry-element":"Droppable","data-sentry-source-file":"CreateEnumeratedTypeSidePanel.tsx",children:e=>(0,n.jsxs)("div",{ref:e.innerRef,children:[p.map((e,t)=>(0,n.jsx)(B.zB,{control:x.control,name:"values.".concat(t,".value"),render:a=>{let{field:s}=a;return(0,n.jsxs)(B.eI,{children:[(0,n.jsx)(B.lR,{className:(0,W.cn)(0!==t&&"sr-only"),children:"Values"}),0===t&&(0,n.jsxs)(tY.Fc,{children:[(0,n.jsx)(ec.A,{strokeWidth:1.5}),(0,n.jsx)(tY.XL,{children:"After creation, values cannot be deleted or sorted"}),(0,n.jsxs)(tY.TN,{children:[(0,n.jsx)("p",{className:"!leading-normal track",children:"You will need to delete and recreate the enumerated type with the updated values instead."}),(0,n.jsx)(v.$,{asChild:!0,type:"default",icon:(0,n.jsx)(tL.A,{strokeWidth:1.5}),className:"mt-2",children:(0,n.jsx)(eN(),{href:"https://www.postgresql.org/message-id/21012.1459434338%40sss.pgh.pa.us",target:"_blank",rel:"noreferrer",children:"Learn more"})})]})]}),(0,n.jsx)(B.MJ,{children:(0,n.jsx)(tq,{index:t,id:e.id,field:s,isDisabled:p.length<2,onRemoveValue:()=>f(t)})}),(0,n.jsx)(B.C5,{className:"ml-6"})]})}},e.id)),e.placeholder]})})}),(0,n.jsx)(v.$,{type:"default",icon:(0,n.jsx)(u.A,{strokeWidth:1.5}),onClick:()=>h({value:""}),"data-sentry-element":"Button","data-sentry-source-file":"CreateEnumeratedTypeSidePanel.tsx",children:"Add value"}),(0,n.jsx)(v.$,{ref:l,htmlType:"submit",type:"default",className:"hidden","data-sentry-element":"Button","data-sentry-source-file":"CreateEnumeratedTypeSidePanel.tsx",children:"Update"})]})})})})};async function tU(e){let{projectRef:t,connectionString:a,name:n,schema:s}=e,r="drop type if exists ".concat(s,'."').concat(n,'"'),{result:l}=await (0,F.E)({projectRef:t,connectionString:a,sql:r});return l}let tH=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,k.jE)();return(0,T.n)(e=>tU(e),{async onSuccess(t,a,s){let{projectRef:r}=a;await n.invalidateQueries(tD.K.list(r)),await (null==e?void 0:e(t,a,s))},async onError(e,a,n){void 0===t?A.oR.error("Failed to create enumerated type: ".concat(e.message)):t(e,a,n)},...a})},tW=e=>{let{visible:t,selectedEnumeratedType:a,onClose:s}=e,{data:r}=(0,g.YA)(),{mutate:l,isLoading:i}=tH({onSuccess:()=>{A.oR.success('Successfully deleted "'.concat(a.name,'"')),s()}}),o=()=>void 0===a?console.error("No enumerated type selected"):(null==r?void 0:r.ref)===void 0?console.error("Project ref required"):(null==r?void 0:r.connectionString)===void 0?console.error("Project connectionString required"):void l({projectRef:null==r?void 0:r.ref,connectionString:null==r?void 0:r.connectionString,name:a.name,schema:a.schema});return(0,n.jsxs)(e_.A,{variant:"destructive",size:"medium",loading:i,visible:t,title:(0,n.jsxs)(n.Fragment,{children:["Confirm to delete enumerated type"," ",(0,n.jsx)("code",{className:"text-sm",children:null==a?void 0:a.name})]}),confirmLabel:"Confirm delete",confirmLabelLoading:"Deleting...",onCancel:s,onConfirm:()=>o(),alert:{title:"This action cannot be undone",description:"You will need to re-create the enumerated type if you want to revert the deletion."},"data-sentry-element":"ConfirmationModal","data-sentry-component":"DeleteEnumeratedTypeModal","data-sentry-source-file":"DeleteEnumeratedTypeModal.tsx",children:[(0,n.jsx)("p",{className:"text-sm",children:"Before deleting this enumerated type, consider:"}),(0,n.jsx)("ul",{className:"space-y-2 mt-2 text-sm text-foreground-light",children:(0,n.jsx)("li",{className:"list-disc ml-6",children:"This enumerated type is no longer in use in any tables or functions"})})]})};async function tJ(e){let{projectRef:t,connectionString:a,schema:n,name:s,description:r,values:l=[]}=e,i=[];s.original!==s.updated&&i.push('alter type "'.concat(n,'"."').concat(s.original,'" rename to "').concat(s.updated,'";')),l.length>0&&l.forEach((e,t)=>{if(e.isNew)if(0===t){let t=l.find(e=>!e.isNew);i.push('alter type "'.concat(n,'"."').concat(s.updated,"\" add value '").concat(e.updated,"' before '").concat(null==t?void 0:t.original,"';"))}else i.push('alter type "'.concat(n,'"."').concat(s.updated,"\" add value '").concat(e.updated,"' after '").concat(l[t-1].updated,"';"));else e.original!==e.updated&&i.push('alter type "'.concat(n,'"."').concat(s.updated,"\" rename value '").concat(e.original,"' to '").concat(e.updated,"';"))}),void 0!==r&&i.push('comment on type "'.concat(n,'"."').concat(s.updated,"\" is '").concat(r,"';"));let o=(0,tz.d)(i.join(" ")),{result:d}=await (0,F.E)({projectRef:t,connectionString:a,sql:o});return d}let tK=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,k.jE)();return(0,T.n)(e=>tJ(e),{async onSuccess(t,a,s){let{projectRef:r}=a;await n.invalidateQueries(tD.K.list(r)),await (null==e?void 0:e(t,a,s))},async onError(e,a,n){void 0===t?A.oR.error("Failed to add value to enumerated type: ".concat(e.message)):t(e,a,n)},...a})},tG=e=>{var t;let{visible:a,selectedEnumeratedType:s,onClose:r}=e,l=(0,m.useRef)(null),{data:i}=(0,g.YA)(),{mutate:o,isLoading:d}=tK({onSuccess:(e,t)=>{A.oR.success('Successfully updated type "'.concat(t.name.updated,'"')),r()}}),c=tB.Ik({name:tB.Yj().min(1,"Please provide a name for your enumerated type").default(""),description:tB.Yj().default("").optional(),values:tB.Ik({isNew:tB.zM(),originalValue:tB.Yj(),updatedValue:tB.Yj().min(1,"Please provide a value")}).array().default([])}),x=(0,C.mN)({resolver:(0,S.u)(c),defaultValues:{name:"",description:"",values:[{isNew:!0,originalValue:"",updatedValue:""}]}}),{fields:p,append:h,remove:f,move:y}=(0,C.jz)({name:"values",control:x.control}),j=e=>{e.destination&&y(e.source.index,e.destination.index)},b=(null!=(t=null==s?void 0:s.enums)?t:[]).map(e=>({isNew:!1,originalValue:e,updatedValue:e}));return(0,m.useEffect)(()=>{if(void 0!==s){var e;x.reset({name:s.name,description:null!=(e=s.comment)?e:"",values:b})}void 0==s&&x.reset({values:b})},[s]),(0,n.jsx)(P.Ay,{loading:d,visible:a,onCancel:r,header:'Update type "'.concat(null==s?void 0:s.name,'"'),confirmText:"Update type",onConfirm:()=>{l.current&&l.current.click()},"data-sentry-element":"SidePanel","data-sentry-component":"EditEnumeratedTypeSidePanel","data-sentry-source-file":"EditEnumeratedTypeSidePanel.tsx",children:(0,n.jsx)(P.Ay.Content,{className:"py-4","data-sentry-element":"SidePanel.Content","data-sentry-source-file":"EditEnumeratedTypeSidePanel.tsx",children:(0,n.jsx)(B.lV,{...x,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"EditEnumeratedTypeSidePanel.tsx",children:(0,n.jsxs)("form",{className:"space-y-4",onSubmit:x.handleSubmit(e=>{var t;if((null==i?void 0:i.ref)===void 0)return console.error("Project ref required");if((null==i?void 0:i.connectionString)===void 0)return console.error("Project connectionString required");if(void 0===s)return console.error("selectedEnumeratedType required");let a={schema:s.schema,name:{original:s.name,updated:e.name},values:e.values.filter(e=>0!==e.updatedValue.length).map(e=>({original:e.originalValue,updated:e.updatedValue.trim(),isNew:e.isNew})),...e.description!==s.comment?{description:null==(t=e.description)?void 0:t.replaceAll("'","''")}:{}};o({projectRef:i.ref,connectionString:i.connectionString,...a})}),children:[(0,n.jsx)(B.zB,{control:x.control,name:"name",render:e=>{let{field:t}=e;return(0,n.jsxs)(B.eI,{children:[(0,n.jsx)(B.lR,{children:"Name"}),(0,n.jsx)(B.MJ,{children:(0,n.jsx)(z.p,{...t})}),(0,n.jsx)(B.C5,{})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"EditEnumeratedTypeSidePanel.tsx"}),(0,n.jsx)(B.zB,{control:x.control,name:"description",render:e=>{let{field:t}=e;return(0,n.jsxs)(B.eI,{children:[(0,n.jsx)(B.lR,{children:"Description"}),(0,n.jsx)(B.MJ,{children:(0,n.jsx)(z.p,{...t})}),(0,n.jsx)(B.Rr,{children:"Optional"})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"EditEnumeratedTypeSidePanel.tsx"}),(0,n.jsx)(tP.JY,{onDragEnd:e=>j(e),"data-sentry-element":"DragDropContext","data-sentry-source-file":"EditEnumeratedTypeSidePanel.tsx",children:(0,n.jsx)(tP.gL,{droppableId:"enum_type_values_droppable","data-sentry-element":"Droppable","data-sentry-source-file":"EditEnumeratedTypeSidePanel.tsx",children:e=>(0,n.jsxs)("div",{ref:e.innerRef,children:[p.map((e,t)=>(0,n.jsx)(B.zB,{control:x.control,name:"values.".concat(t,".updatedValue"),render:a=>{let{field:s}=a;return(0,n.jsxs)(B.eI,{children:[(0,n.jsx)(B.lR,{className:(0,W.cn)(0!==t&&"sr-only"),children:"Values"}),0===t&&(0,n.jsxs)(tY.Fc,{children:[(0,n.jsx)(ec.A,{strokeWidth:1.5}),(0,n.jsx)(tY.XL,{children:"Existing values cannot be deleted or sorted"}),(0,n.jsxs)(tY.TN,{children:[(0,n.jsx)("p",{className:"!leading-normal track",children:"You will need to delete and recreate the enumerated type with the updated values instead."}),(0,n.jsx)(v.$,{asChild:!0,type:"default",icon:(0,n.jsx)(tL.A,{strokeWidth:1.5}),className:"mt-2",children:(0,n.jsx)(eN(),{href:"https://www.postgresql.org/message-id/21012.1459434338%40sss.pgh.pa.us",target:"_blank",rel:"noreferrer",children:"Learn more"})})]})]}),(0,n.jsx)(B.MJ,{children:(0,n.jsx)(tq,{index:t,id:e.id,field:s,isDisabled:!e.isNew,onRemoveValue:()=>f(t)})}),(0,n.jsx)(B.C5,{className:"ml-6"})]})}},e.id)),e.placeholder]})})}),(0,n.jsx)(v.$,{type:"default",icon:(0,n.jsx)(u.A,{strokeWidth:1.5}),onClick:()=>h({isNew:!0,originalValue:"",updatedValue:""}),"data-sentry-element":"Button","data-sentry-source-file":"EditEnumeratedTypeSidePanel.tsx",children:"Add value"}),(0,n.jsx)(v.$,{ref:l,htmlType:"submit",type:"default",className:"hidden","data-sentry-element":"Button","data-sentry-source-file":"EditEnumeratedTypeSidePanel.tsx",children:"Update"})]})})})})},tX=()=>{let{data:e}=(0,g.YA)(),[t,a]=(0,m.useState)(""),{selectedSchema:s,setSelectedSchema:r}=(0,tF.k)(),[l,i]=(0,m.useState)(!1),[o,c]=(0,m.useState)(),[u,x]=(0,m.useState)(),{data:p,error:h,isLoading:f,isError:y,isSuccess:j}=(0,tT.p)({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString}),N=(null!=p?p:[]).filter(e=>e.enums.length>0),w=t.length>0?N.filter(e=>e.schema===s&&e.name.toLowerCase().includes(t.toLowerCase())):N.filter(e=>e.schema===s),{isSchemaLocked:S}=(0,tr.BQ)({schema:s});return(0,n.jsxs)("div",{className:"space-y-4","data-sentry-component":"EnumeratedTypes","data-sentry-source-file":"EnumeratedTypes.tsx",children:[(0,n.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-2",children:[(0,n.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center gap-2",children:[(0,n.jsx)(e7.A,{className:"w-full lg:w-[180px]",size:"tiny",showError:!1,selectedSchemaName:s,onSelectSchema:r,"data-sentry-element":"SchemaSelector","data-sentry-source-file":"EnumeratedTypes.tsx"}),(0,n.jsx)(b.A,{size:"tiny",value:t,className:"w-full lg:w-52",onChange:e=>a(e.target.value),placeholder:"Search for a type",icon:(0,n.jsx)(d.A,{size:14}),"data-sentry-element":"Input","data-sentry-source-file":"EnumeratedTypes.tsx"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(em.A,{href:"https://www.postgresql.org/docs/current/datatype-enum.html","data-sentry-element":"DocsButton","data-sentry-source-file":"EnumeratedTypes.tsx"}),!S&&(0,n.jsx)(v.$,{className:"ml-auto flex-1",type:"primary",onClick:()=>i(!0),children:"Create type"})]})]}),S&&(0,n.jsx)(tI.i,{schema:s,entity:"enumerated types"}),f&&(0,n.jsx)(er.y,{}),y&&(0,n.jsx)(tk.A,{error:h,subject:"Failed to retrieve database enumerated types"}),j&&(0,n.jsx)(eh.Zp,{children:(0,n.jsxs)(ef.XI,{children:[(0,n.jsx)(ef.A0,{children:(0,n.jsxs)(ef.Hj,{children:[(0,n.jsx)(ef.nd,{children:"Schema"},"schema"),(0,n.jsx)(ef.nd,{children:"Name"},"name"),(0,n.jsx)(ef.nd,{children:"Values"},"values"),(0,n.jsx)(ef.nd,{},"actions")]})}),(0,n.jsx)(ef.BF,{children:(0,n.jsxs)(n.Fragment,{children:[0===w.length&&0===t.length&&(0,n.jsx)(ef.Hj,{children:(0,n.jsxs)(ef.nA,{colSpan:4,children:[(0,n.jsx)("p",{className:"text-sm text-foreground",children:"No enumerated types created yet"}),(0,n.jsxs)("p",{className:"text-sm text-foreground-light",children:['There are no enumerated types found in the schema "',s,'"']})]})}),0===w.length&&t.length>0&&(0,n.jsx)(ef.Hj,{children:(0,n.jsxs)(ef.nA,{colSpan:4,children:[(0,n.jsx)("p",{className:"text-sm text-foreground",children:"No results found"}),(0,n.jsxs)("p",{className:"text-sm text-foreground-light",children:['Your search for "',t,'" did not return any results']})]})}),w.length>0&&w.map(e=>(0,n.jsxs)(ef.Hj,{children:[(0,n.jsx)(ef.nA,{className:"w-20",children:(0,n.jsx)("p",{className:"w-20 truncate",children:e.schema})}),(0,n.jsx)(ef.nA,{children:e.name}),(0,n.jsx)(ef.nA,{children:e.enums.join(", ")}),(0,n.jsx)(ef.nA,{children:!S&&(0,n.jsx)("div",{className:"flex justify-end items-center space-x-2",children:(0,n.jsxs)(K.rI,{children:[(0,n.jsx)(K.ty,{asChild:!0,children:(0,n.jsx)(v.$,{type:"default",className:"px-1",icon:(0,n.jsx)(et.A,{})})}),(0,n.jsxs)(K.SQ,{side:"bottom",align:"end",className:"w-32",children:[(0,n.jsxs)(K._2,{className:"space-x-2",onClick:()=>c(e),children:[(0,n.jsx)(t_.A,{size:14}),(0,n.jsx)("p",{children:"Update type"})]}),(0,n.jsxs)(K._2,{className:"space-x-2",onClick:()=>x(e),children:[(0,n.jsx)(ea.A,{size:14}),(0,n.jsx)("p",{children:"Delete type"})]})]})]})})})]},e.id))]})})]})}),(0,n.jsx)(tO,{visible:l,onClose:()=>i(!1),schema:s,"data-sentry-element":"CreateEnumeratedTypeSidePanel","data-sentry-source-file":"EnumeratedTypes.tsx"}),(0,n.jsx)(tG,{visible:void 0!==o,selectedEnumeratedType:o,onClose:()=>c(void 0),"data-sentry-element":"EditEnumeratedTypeSidePanel","data-sentry-source-file":"EnumeratedTypes.tsx"}),(0,n.jsx)(tW,{visible:void 0!==u,selectedEnumeratedType:u,onClose:()=>x(void 0),"data-sentry-element":"DeleteEnumeratedTypeModal","data-sentry-source-file":"EnumeratedTypes.tsx"})]})}},95142:(e,t,a)=>{"use strict";a.d(t,{BS:()=>i,Dm:()=>c,HJ:()=>g,Rf:()=>y,Uw:()=>d,Vw:()=>N,Xr:()=>v,aw:()=>h,bV:()=>l,cJ:()=>x,dX:()=>u,eh:()=>o,fh:()=>b,gu:()=>m,sZ:()=>p,tn:()=>j,xp:()=>f});var n=a(80263),s=a(53239),r=a(80127);let l="mx-auto w-full max-w-[1200px]",i="px-4 @lg:px-6 @xl:px-12 @2xl:px-20 @3xl:px-24",o=(0,s.forwardRef)((e,t)=>{let{className:a,bottomPadding:s,size:l="default",...o}=e;return(0,n.jsx)("div",{ref:t,...o,className:(0,r.cn)("mx-auto w-full",{small:"max-w-[768px]",default:"max-w-[1200px]",large:"max-w-[1600px]",full:"max-w-none"}[l],i,s&&"pb-16",a)})}),d=(0,s.forwardRef)((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("header",{...s,ref:t,className:(0,r.cn)("w-full","flex-col gap-3 py-6",a)})}),c=(0,s.forwardRef)((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("h1",{ref:t,...s,className:(0,r.cn)(a)})}),u=(0,s.forwardRef)((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("p",{ref:t,...s,className:(0,r.cn)("text-sm text-foreground-light",a)})}),m=(0,s.forwardRef)((e,t)=>{let{className:a,isFullWidth:s,topPadding:l,...i}=e;return(0,n.jsx)("div",{ref:t,...i,className:(0,r.cn)("flex flex-col first:pt-12 py-6",s?"w-full":"gap-3 lg:grid md:grid-cols-12",a)})}),x=(0,s.forwardRef)((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("div",{ref:t,...s,className:(0,r.cn)("w-full h-px bg-border",a)})}),p=(0,s.forwardRef)((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("h3",{ref:t,...s,className:(0,r.cn)("text-foreground text-xl",a)})}),h=(0,s.forwardRef)((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("p",{ref:t,...s,className:(0,r.cn)("text-sm text-foreground-light",a)})}),f=(0,s.forwardRef)((e,t)=>{let{className:a,children:s,title:l,...i}=e;return(0,n.jsxs)("div",{ref:t,...i,className:(0,r.cn)("col-span-4 xl:col-span-5 prose text-sm",a),children:[l&&(0,n.jsx)("h2",{children:l}),s]})}),y=(0,s.forwardRef)((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("div",{ref:t,...s,className:(0,r.cn)("col-span-8 xl:col-span-7","flex flex-col gap-6",a)})}),j=(0,s.forwardRef)((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("div",{ref:t,...s,className:(0,r.cn)("flex flex-col gap-3 items-center",a)})}),g=(0,s.forwardRef)((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("div",{ref:t,...s,className:(0,r.cn)("flex w-full items-center",a)})}),b=(0,s.forwardRef)((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("div",{ref:t,...s,className:(0,r.cn)("flex flex-row gap-3",a)})}),v=(0,s.forwardRef)((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("div",{ref:t,...s,className:(0,r.cn)("flex flex-col gap-3","min-w-[420px]",a)})}),N=(0,s.forwardRef)((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("div",{ref:t,...s,className:(0,r.cn)(l,i,"my-8 flex flex-col gap-8",a)})});d.displayName="ScaffoldHeader",c.displayName="ScaffoldTitle",u.displayName="ScaffoldDescription",o.displayName="ScaffoldContainer",x.displayName="ScaffoldDivider",m.displayName="ScaffoldSection",v.displayName="ScaffoldColumn",f.displayName="ScaffoldSectionDetail",y.displayName="ScaffoldSectionContent",j.displayName="ScaffoldFilterAndContent",g.displayName="ScaffoldActionsContainer",b.displayName="ScaffoldActionsGroup",N.displayName="ScaffoldContainerLegacy",p.displayName="ScaffoldSectionTitle",h.displayName="ScaffoldSectionDescription"},98615:(e,t,a)=>{"use strict";a.d(t,{Ay:()=>x});var n=a(80263),s=a(53239),r=a(92413),l=a(80127),i=a(41807);function o(e){let{children:t,className:a,tag:s="div",style:r}=e;return(0,n.jsx)("".concat(s),{style:r,"data-sentry-element":"CustomTag","data-sentry-component":"Typography","data-sentry-source-file":"Typography.tsx",children:t})}o.Title=function(e){let{className:t,level:a=1,children:s,style:r}=e;return(0,n.jsx)("h".concat(a),{style:r,"data-sentry-element":"CustomTag","data-sentry-component":"Title","data-sentry-source-file":"Title.tsx",children:s})},o.Text=function(e){let{className:t,children:a,style:s,type:r,disabled:l,mark:i,code:o,keyboard:d,underline:c,strikethrough:u,strong:m,small:x}=e;return o?(0,n.jsx)("code",{style:s,children:a}):i?(0,n.jsx)("mark",{style:s,children:a}):d?(0,n.jsx)("kbd",{style:s,children:a}):m?(0,n.jsx)("strong",{style:s,children:a}):(0,n.jsx)("span",{style:s,"data-sentry-component":"Text","data-sentry-source-file":"Text.tsx",children:a})},o.Link=i.A;let d=(0,s.createContext)({type:"text"}),c=e=>{let{type:t}=e;return(0,n.jsx)(d.Provider,{value:{type:t},"data-sentry-element":"MenuContext.Provider","data-sentry-component":"MenuContextProvider","data-sentry-source-file":"MenuContext.tsx",children:e.children})},u=()=>{let e=(0,s.useContext)(d);if(void 0===e)throw Error("MenuContext must be used within a MenuContextProvider.");return e};function m(e){let{children:t,className:a,ulClassName:s,style:r,type:l="text"}=e;return(0,n.jsx)("nav",{role:"menu","aria-label":"Sidebar","aria-orientation":"vertical","aria-labelledby":"options-menu",className:a,style:r,"data-sentry-component":"Menu","data-sentry-source-file":"Menu.tsx",children:(0,n.jsx)(c,{type:l,"data-sentry-element":"MenuContextProvider","data-sentry-source-file":"Menu.tsx",children:(0,n.jsx)("ul",{className:s,children:t})})})}m.Item=function(e){let{children:t,icon:a,active:s,rounded:i,onClick:o,doNotCloseOverlay:d=!1,showActiveBar:c=!1,style:m}=e,x=(0,r.A)("menu"),{type:p}=u(),h=[x.item.base];h.push(x.item.variants[p].base),s?h.push(x.item.variants[p].active):h.push(x.item.variants[p].normal);let f=[x.item.content.base];s?f.push(x.item.content.active):f.push(x.item.content.normal);let y=[x.item.icon.base];return s?y.push(x.item.icon.active):y.push(x.item.icon.normal),(0,n.jsxs)("li",{role:"menuitem",className:(0,l.cn)("outline-none",h),style:m,onClick:o,"aria-current":s?"page":void 0,"data-sentry-component":"Item","data-sentry-source-file":"Menu.tsx",children:[a&&(0,n.jsx)("div",{className:"".concat(y.join(" ")," min-w-fit"),children:a}),(0,n.jsx)("span",{className:f.join(" "),children:t})]})},m.Group=function(e){let{children:t,icon:a,title:s}=e,l=(0,r.A)("menu"),{type:i}=u();return(0,n.jsxs)("div",{className:[l.group.base,l.group.variants[i]].join(" "),"data-sentry-component":"Group","data-sentry-source-file":"Menu.tsx",children:[a&&(0,n.jsx)("span",{className:l.group.icon,children:a}),(0,n.jsx)("span",{className:l.group.content,children:s}),t]})},m.Misc=function(e){let{children:t}=e;return(0,n.jsx)("div",{"data-sentry-component":"Misc","data-sentry-source-file":"Menu.tsx",children:(0,n.jsx)(o.Text,{"data-sentry-element":"Typography.Text","data-sentry-source-file":"Menu.tsx",children:(0,n.jsx)("span",{children:t})})})};let x=m},99549:(e,t,a)=>{"use strict";a.d(t,{E:()=>u});var n=a(22990),s=a(53444),r=a(32144),l=a(80251),i=a(73969),o=a(20305),d=a(55784);async function c(e){let{projectRef:t,connectionString:a,schema:r,name:l,version:i,cascade:d=!1,createSchema:c=!1}=e,u=new Headers;a&&u.set("x-connection-encrypted",a);let{sql:m}=n.A.extensions.create({schema:r,name:l,version:i,cascade:d}),{result:x}=await (0,o.E)({projectRef:t,connectionString:a,sql:c?"create schema if not exists ".concat((0,s.bD)(r),"; ").concat(m):m,queryKey:["extension","create"]});return x}let u=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,r.jE)();return(0,l.n)(e=>c(e),{async onSuccess(t,a,s){let{projectRef:r}=a;await n.invalidateQueries(d.I.list(r)),await (null==e?void 0:e(t,a,s))},async onError(e,a,n){void 0===t?i.oR.error("Failed to enable database extension: ".concat(e.message)):t(e,a,n)},...a})}}}]);
try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="d5b00e50-19a8-4d83-8d5c-d9b1a026a1a6",e._sentryDebugIdIdentifier="sentry-dbid-d5b00e50-19a8-4d83-8d5c-d9b1a026a1a6")}()}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1391],{10540:(e,t,n)=>{n.d(t,{A:()=>m});var a=n(80263),s=n(10166),r=n(51968),o=n(63121),i=n(93749),l=n.n(i),c=n(53239),d=n(22554);let u=(0,c.forwardRef)((e,t)=>{let{icon:n,title:i,description:u,url:m,urlLabel:p="Read more",defaultVisibility:g=!1,hideCollapse:h=!1,button:f,className:x="",block:b=!1}=e,[v,y]=(0,c.useState)(g);return(0,a.jsx)("div",{ref:t,role:"alert",className:"".concat(b?"block w-full":"","\n      block w-full rounded-md border bg-surface-300/25 py-3 ").concat(x),children:(0,a.jsxs)("div",{className:"flex flex-col px-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex w-full space-x-3 items-center",children:[n&&(0,a.jsx)("span",{className:"text-foreground-lighter",children:n}),(0,a.jsx)("div",{className:"flex-grow",children:(0,a.jsx)("h5",{className:"text-foreground",children:i})})]}),u&&!h?(0,a.jsx)("div",{className:"cursor-pointer text-foreground-lighter",onClick:()=>y(!v),children:v?(0,a.jsx)(s.A,{size:14,strokeWidth:1.5}):(0,a.jsx)(r.A,{size:14,strokeWidth:1.5})}):null]}),(u||m||f)&&(0,a.jsxs)("div",{className:"flex flex-col space-y-3 overflow-hidden transition-all ".concat(v?"mt-3":""),style:{maxHeight:500*!!v},children:[(0,a.jsx)("div",{className:"text-foreground-light text-sm",children:u}),m&&(0,a.jsx)("div",{children:(0,a.jsx)(d.$,{asChild:!0,type:"default",icon:(0,a.jsx)(o.A,{}),children:(0,a.jsx)(l(),{href:m,target:"_blank",rel:"noreferrer",children:p})})}),f&&(0,a.jsx)("div",{children:f})]})]})})});u.displayName="InformationBox";let m=u},24344:(e,t,n)=>{n.d(t,{A:()=>x});var a=n(80263),s=n(10726),r=n(11203),o=n.n(r),i=n(53239),l=n(65988),c=n(74512),d=n(30069),u=n(92413),m=n(80127),p=n(38583);let g=(0,i.createContext)({onChange:e=>{},selected:void 0});var h=n(24699);function f(e){let{children:t,className:n,buttonClassName:r,descriptionText:h,error:f,icon:x,id:b="",name:v="",label:y,labelOptional:_,layout:j,value:w,onChange:q,onFocus:N,onBlur:S,style:C,size:k="medium",defaultValue:T,validation:E,disabled:D,optionsWidth:L}=e,[$,z]=(0,i.useState)(void 0),[R,A]=(0,i.useState)({}),O=(0,u.A)("listbox"),P=(0,i.useRef)(null),{formContextOnChange:M,values:I,errors:B,handleBlur:H,touched:W,fieldLevelValidation:F}=(0,p.x)();I&&!w&&(w=I[b||v],T=I[b||v]),f||(B&&!f&&(f=B[b||v]),f=W&&W[b||v]?f:void 0),(0,i.useEffect)(()=>{void 0!==w&&z(w)},[w]),(0,i.useEffect)(()=>{function e(){var e;document.documentElement.style.setProperty("--width-listbox","".concat(L||(null==(e=P.current)?void 0:e.offsetWidth),"px"))}return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]),(0,i.useEffect)(()=>{var e;let n=o()(t);function a(e){return n.find(t=>t.props.value===e)}if(w){z(w);let e=a(w);A((null==e?void 0:e.props)?e.props:void 0);return}if($){let e=a($);A((null==e?void 0:e.props)?e.props:void 0);return}if(T){z(T);let e=a($);A((null==e?void 0:e.props)?e.props:void 0);return}A(null==(e=n[0])?void 0:e.props)},[$]);let U=[O.container,O.base,r],J=[O.addOnBefore];return f&&U.push(O.variants.error),f||U.push(O.variants.standard),x&&J.push(O.with_icon),k&&U.push(O.size[k]),D&&U.push(O.disabled),(0,a.jsx)(l.H,{label:y,labelOptional:_,layout:j,id:b,error:f,descriptionText:h,className:n,style:C,size:k,"data-sentry-element":"FormLayout","data-sentry-component":"Listbox","data-sentry-source-file":"Listbox2.tsx",children:(0,a.jsxs)(s.bL,{"data-sentry-element":"DropdownMenuPrimitive.Root","data-sentry-source-file":"Listbox2.tsx",children:[(0,a.jsx)(s.l9,{asChild:!0,disabled:D,"data-sentry-element":"DropdownMenuPrimitive.Trigger","data-sentry-source-file":"Listbox2.tsx",children:(0,a.jsxs)("button",{"data-size":k,ref:P,className:(0,m.cn)(U),onBlur:function(e){H&&H(e),S&&S(e)},onFocus:N,name:v,id:b,children:[(0,a.jsxs)("span",{className:(0,m.cn)(J),children:[x&&(0,a.jsx)(d.A,{size:k,icon:x}),(null==R?void 0:R.addOnBefore)&&(0,a.jsx)(R.addOnBefore,{}),(0,a.jsx)("span",{className:O.label,children:null==R?void 0:R.label})]}),(0,a.jsx)("span",{className:O.chevron_container,children:(0,a.jsx)("svg",{className:O.chevron,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-sentry-element":"svg","data-sentry-source-file":"Listbox2.tsx",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L10 5.414 7.707 7.707a1 1 0 01-1.414-1.414l3-3A1 1 0 0110 3zm-3.707 9.293a1 1 0 011.414 0L10 14.586l2.293-2.293a1 1 0 011.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd","data-sentry-element":"path","data-sentry-source-file":"Listbox2.tsx"})})}),f&&(0,a.jsx)("div",{className:O.actions_container,children:f&&(0,a.jsx)(c.A,{size:k})})]})}),(0,a.jsx)(s.UC,{sideOffset:6,loop:!0,side:"bottom",align:"center",className:O.options_container,"data-sentry-element":"DropdownMenuPrimitive.Content","data-sentry-source-file":"Listbox2.tsx",children:(0,a.jsx)("div",{children:(0,a.jsx)(g.Provider,{value:{onChange:function(e){q&&q(e),z(e);let t={};t.target={type:"select",name:v,id:b,value:e,checked:void 0},M&&M(t),E&&F(b,E(e))},selected:$},"data-sentry-element":"SelectContext.Provider","data-sentry-source-file":"Listbox2.tsx",children:t})})})]})})}f.Option=function(e){let{id:t,value:n,label:r,disabled:o=!1,children:i,className:l="",addOnBefore:c}=e,d=(0,u.A)("listbox");return(0,a.jsx)(g.Consumer,{"data-sentry-element":"SelectContext.Consumer","data-sentry-component":"SelectOption","data-sentry-source-file":"Listbox2.tsx",children:e=>{let{onChange:r,selected:u}=e,p=u===n;return(0,a.jsxs)(s.q7,{className:(0,m.cn)(d.option,p?d.option_active:" ",o?d.option_disabled:" ",l),onSelect:()=>o?{}:r(n),children:[(0,a.jsxs)("div",{className:d.option_inner,children:[c&&c({active:p,selected:u}),(0,a.jsx)("span",{children:"function"==typeof i?i({active:p,selected:u}):i})]}),p?(0,a.jsx)("span",{className:(0,m.cn)(d.option_check,p?d.option_check_active:""),children:(0,a.jsx)(h.A,{className:d.option_check_icon,"aria-hidden":"true"})}):null]},t)}})};let x=f},26140:(e,t,n)=>{n.d(t,{Ay:()=>i});var a=n(80263),s=n(90709);n(53239);var r=n(92413);let o=e=>{let{open:t,children:n,className:r,...o}=e;return(0,a.jsx)(s.bL,{asChild:o.asChild,defaultOpen:o.defaultOpen,open:t,onOpenChange:o.onOpenChange,disabled:o.disabled,className:r,"data-sentry-element":"RadixCollapsible.Root","data-sentry-component":"Collapsible","data-sentry-source-file":"Collapsible.tsx",children:n})};o.Trigger=function(e){let{children:t,asChild:n}=e;return(0,a.jsx)(s.l9,{asChild:n,"data-sentry-element":"RadixCollapsible.Trigger","data-sentry-component":"Trigger","data-sentry-source-file":"Collapsible.tsx",children:t})},o.Content=function(e){let{asChild:t,children:n,className:o}=e,i=(0,r.A)("collapsible");return(0,a.jsx)(s.UC,{asChild:t,className:[i.content,o].join(" "),"data-sentry-element":"RadixCollapsible.Content","data-sentry-component":"Content","data-sentry-source-file":"Collapsible.tsx",children:n})};let i=o},30145:(e,t,n)=>{n.d(t,{p:()=>l});var a=n(56947),s=n(70938),r=n(79650),o=n(23879);async function i(e,t){let{projectRef:n,connectionString:a}=e;if(!n)throw Error("projectRef is required");let r=new Headers;a&&r.set("x-connection-encrypted",a);let{data:i,error:l}=await (0,s.Jt)("/platform/pg-meta/{ref}/types",{params:{header:{"x-connection-encrypted":a,"x-pg-application-name":o.r},path:{ref:n}},headers:Object.fromEntries(r),signal:t});return l&&(0,s.H4)(l),i}let l=function(e){let{projectRef:t,connectionString:n}=e,{enabled:s=!0,...o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.I)(r.K.list(t),e=>{let{signal:a}=e;return i({projectRef:t,connectionString:n},a)},{enabled:s&&void 0!==t,...o})}},33419:(e,t,n)=>{n.d(t,{A:()=>r});var a=n(80263),s=n(80127);let r=e=>{let{max:t=100,value:n=0,barClass:r="bg-foreground",bgClass:o="",type:i="vertical",borderClass:l="",labelBottom:c="",labelBottomClass:d="tabular-nums",labelTop:u="",labelTopClass:m=""}=e;if("horizontal"===i){let e=Number(n/t*100),i=c||u;return(0,a.jsxs)("div",{className:"flex flex-col w-full",children:[i&&(0,a.jsxs)("div",{className:"flex align-baseline justify-between pb-1 space-x-8",children:[(0,a.jsx)("p",{className:(0,s.cn)("text-foreground text-sm truncate capitalize-sentence",u.length>0&&"max-w-[75%]",d),children:c}),(0,a.jsx)("p",{className:(0,s.cn)("text-foreground-light text-sm",m),children:u})]}),(0,a.jsx)("div",{className:"relative rounded h-1 overflow-hidden w-full border p-0 ".concat(o||"bg-surface-400"," ").concat(l||"border-none"),children:(0,a.jsx)("div",{className:"absolute rounded inset-x-0 bottom-0 h-1 ".concat(r," transition-all"),style:{width:"".concat(e,"%")}})})]})}{let e=Number(n/t*35);return e<2&&(e=2),(0,a.jsx)("div",{className:"relative rounded w-5 overflow-hidden border p-1 ".concat(o||"bg-gray-400"," ").concat(l||"border-none"),style:{height:35},children:(0,a.jsx)("div",{className:"absolute inset-x-0 bottom-0 w-5 ".concat(r),style:{height:e}})})}}},40469:(e,t,n)=>{n.d(t,{m:()=>a});let a={create:()=>["queues","create"],delete:e=>["queues",e,"delete"],purge:e=>["queues",e,"purge"],getMessagesInfinite:(e,t,n)=>["projects",e,"queue-messages",t,n].filter(Boolean),list:e=>["projects",e,"queues"],metrics:(e,t)=>["projects",e,"queue-metrics",t],exposePostgrestStatus:e=>["projects",e,"queue-expose-status"]}},56230:(e,t,n)=>{n.d(t,{AL:()=>c,J5:()=>u,J_:()=>l,N1:()=>i,aw:()=>d,fX:()=>x,mL:()=>m,mN:()=>p,wB:()=>g,wy:()=>f,x0:()=>h});var a=n(86631),s=n.n(a),r=n(14506),o=n.n(r);let i=["int2","int4","int8","float4","float8","numeric","double precision"],l=["json","jsonb"],c=["text","varchar"],d=["timestamp","timestamptz"],u=["date"],m=["time","timetz"],p=s()(d,u,m),g=["uuid","bool","vector","bytea"],h=o()(s()(i,l,c,p,g)),f={varchar:{alternative:"text",reference:"https://wiki.postgresql.org/wiki/Don't_Do_This#Don.27t_use_varchar.28n.29_by_default"},json:{alternative:"jsonb",reference:"https://www.postgresql.org/docs/current/datatype-json.html"},timetz:{alternative:"timestamptz",reference:"https://wiki.postgresql.org/wiki/Don't_Do_This#Don.27t_use_timetz"},timestamp:{alternative:"timestamptz",reference:"https://wiki.postgresql.org/wiki/Don't_Do_This#Don.27t_use_timestamp_.28without_time_zone.29"}},x=[{name:"int2",description:"Signed two-byte integer",type:"number"},{name:"int4",description:"Signed four-byte integer",type:"number"},{name:"int8",description:"Signed eight-byte integer",type:"number"},{name:"float4",description:"Single precision floating-point number (4 bytes)",type:"number"},{name:"float8",description:"Double precision floating-point number (8 bytes)",type:"number"},{name:"numeric",description:"Exact numeric of selectable precision",type:"number"},{name:"json",description:"Textual JSON data",type:"json"},{name:"jsonb",description:"Binary JSON data, decomposed",type:"json"},{name:"text",description:"Variable-length character string",type:"text"},{name:"varchar",description:"Variable-length character string",type:"text"},{name:"uuid",description:"Universally unique identifier",type:"text"},{name:"date",description:"Calendar date (year, month, day)",type:"time"},{name:"time",description:"Time of day (no time zone)",type:"time"},{name:"timetz",description:"Time of day, including time zone",type:"time"},{name:"timestamp",description:"Date and time (no time zone)",type:"time"},{name:"timestamptz",description:"Date and time, including time zone",type:"time"},{name:"bool",description:"Logical boolean (true/false)",type:"bool"},{name:"bytea",description:"Variable-length binary string",type:"others"}]},62308:(e,t,n)=>{n.d(t,{$O:()=>u,BQ:()=>g,Uu:()=>p});var a=n(74722),s=n.n(a),r=n(53239),o=n(6409),i=n(16558),l=n(72671),c=n(95794),d=n(16703);let u=["auth","cron","extensions","information_schema","net","pgsodium","pgsodium_masks","pgbouncer","pgtle","realtime","storage","supabase_functions","supabase_migrations","vault","graphql","graphql_public",l.Lh],m=()=>{let{data:e}=(0,d.YA)(),t=(0,c.ov)({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString}),n=(0,r.useMemo)(()=>{var e;let n=null==(e=t.data)?void 0:e.filter(e=>(0,i.vN)({handlerName:o.U.ICEBERG,server:{options:[]}},e)),a=null==n?void 0:n.map(e=>(0,i.WV)(e.server_options)).map(e=>e.supabase_target_schema).flatMap(e=>null==e?void 0:e.split(",")).filter(Boolean);return s()(a)},[t.data]);return{...t,data:n}},p=function(){let{excludeSchemas:e=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,r.useMemo)(()=>e,[JSON.stringify(e)]),n=m(),a=(0,r.useMemo)(()=>{var e;let a=u.map(e=>({name:e,type:"internal"})),r=null==(e=n.data)?void 0:e.map(e=>({name:e,type:"fdw"}));return s()([...a,...r]).filter(e=>!t.includes(e.name))},[n.data,t]);return{...n,data:a}},g=e=>{let{schema:t,excludedSchemas:n=[]}=e,{data:a}=p({excludeSchemas:n}),s=a.find(e=>e.name===t);return s?{isSchemaLocked:!0,reason:s.type}:{isSchemaLocked:!1,reason:void 0}}},68997:(e,t,n)=>{n.d(t,{k:()=>i});var a=n(49629),s=n(53239),r=n(46491);let o=e=>(0,a.ZA)("schema",a.tU.withDefault(e).withOptions({clearOnDefault:!1})),i=()=>{let{ref:e}=(0,r.g)(),t=e&&e.length>0&&window.localStorage.getItem(r.rS.LAST_SELECTED_SCHEMA(e))||"public",[n,a]=o((0,s.useMemo)(()=>t,[e]));return(0,s.useEffect)(()=>{e&&e.length>0&&window.localStorage.setItem(r.rS.LAST_SELECTED_SCHEMA(e),n)},[n,e]),{selectedSchema:n,setSelectedSchema:a}}},69654:(e,t,n)=>{n.d(t,{i:()=>u});var a=n(80263),s=n(53239),r=n(19506),o=n(22554),i=n(80127),l=n(62308),c=n(50922);let d=e=>{let{onClose:t}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.c7,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:(0,a.jsx)(r.L3,{"data-sentry-element":"DialogTitle","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:"Schemas managed by Supabase"})}),(0,a.jsx)(r.pf,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"ProtectedSchemaWarning.tsx"}),(0,a.jsxs)(r.OO,{className:"space-y-2 prose","data-sentry-element":"DialogSection","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:[(0,a.jsx)("p",{className:"text-sm",children:"The following schemas are managed by Supabase and are currently protected from write access through the dashboard."}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:l.$O.map(e=>(0,a.jsx)("code",{className:"text-xs",children:e},e))}),(0,a.jsx)("p",{className:"text-sm !mt-4",children:"These schemas are critical to the functionality of your Supabase project and hence we highly recommend not altering them."}),(0,a.jsx)("p",{className:"text-sm",children:"You can, however, still interact with those schemas through the SQL Editor although we advise you only do so if you know what you are doing."})]}),(0,a.jsx)(r.Es,{"data-sentry-element":"DialogFooter","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:(0,a.jsx)("div",{className:"flex items-center justify-end space-x-2",children:(0,a.jsx)(o.$,{type:"default",onClick:t,"data-sentry-element":"Button","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:"Understood"})})})]})},u=e=>{let{size:t="md",schema:n,entity:u}=e,[m,p]=(0,s.useState)(!1),{isSchemaLocked:g,reason:h}=(0,l.BQ)({schema:n});return g?(0,a.jsx)(c.Z,{showIcon:!1,type:"note",title:"sm"===t?"Viewing protected schema":"Viewing ".concat(u," from a protected schema"),className:(0,i.cn)("[&>div>p]:prose [&>div>p]:max-w-full [&>div>p]:!leading-normal","sm"===t?"[&>div>p]:text-xs":"[&>div>p]:text-sm"),"data-sentry-element":"Admonition","data-sentry-component":"ProtectedSchemaWarning","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:"fdw"===h?(0,a.jsxs)("p",{children:["The ",(0,a.jsx)("code",{className:"text-xs",children:n})," schema is used by Supabase to connect to analytics buckets and is read-only through the dashboard."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("p",{className:"mb-2",children:["The ",(0,a.jsx)("code",{className:"text-xs",children:n})," schema is managed by Supabase and is read-only through the dashboard."]}),(0,a.jsxs)(r.lG,{open:m,onOpenChange:p,children:[(0,a.jsx)(r.zM,{asChild:!0,children:(0,a.jsx)(o.$,{type:"default",size:"tiny",onClick:()=>p(!0),children:"Learn more"})}),(0,a.jsx)(r.Cf,{children:(0,a.jsx)(d,{onClose:()=>p(!1)})})]})]})}):null}},72671:(e,t,n)=>{n.d(t,{Lh:()=>u,T_:()=>h});var a=n(32144),s=n(80251),r=n(73969),o=n(26616),i=n.n(o),l=n(20305),c=n(40469),d=n(28175);let u="pgmq_public",m=i()("\ncreate schema if not exists ".concat(u,";\ngrant usage on schema ").concat(u," to postgres, anon, authenticated, service_role;\n\ncreate or replace function ").concat(u,".pop(\n    queue_name text\n)\n  returns setof pgmq.message_record\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return query\n    select *\n    from pgmq.pop(\n        queue_name := queue_name\n    );\nend;\n$$;\n\ncomment on function ").concat(u,".pop(queue_name text) is 'Retrieves and locks the next message from the specified queue.';\n\n\ncreate or replace function ").concat(u,".send(\n    queue_name text,\n    message jsonb,\n    sleep_seconds integer default 0  -- renamed from 'delay'\n)\n  returns setof bigint\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return query\n    select *\n    from pgmq.send(\n        queue_name := queue_name,\n        msg := message,\n        delay := sleep_seconds\n    );\nend;\n$$;\n\ncomment on function ").concat(u,".send(queue_name text, message jsonb, sleep_seconds integer) is 'Sends a message to the specified queue, optionally delaying its availability by a number of seconds.';\n\n\ncreate or replace function ").concat(u,".send_batch(\n    queue_name text,\n    messages jsonb[],\n    sleep_seconds integer default 0  -- renamed from 'delay'\n)\n  returns setof bigint\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return query\n    select *\n    from pgmq.send_batch(\n        queue_name := queue_name,\n        msgs := messages,\n        delay := sleep_seconds\n    );\nend;\n$$;\n\ncomment on function ").concat(u,".send_batch(queue_name text, messages jsonb[], sleep_seconds integer) is 'Sends a batch of messages to the specified queue, optionally delaying their availability by a number of seconds.';\n\n\ncreate or replace function ").concat(u,".archive(\n    queue_name text,\n    message_id bigint\n)\n  returns boolean\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return\n    pgmq.archive(\n        queue_name := queue_name,\n        msg_id := message_id\n    );\nend;\n$$;\n\ncomment on function ").concat(u,".archive(queue_name text, message_id bigint) is 'Archives a message by moving it from the queue to a permanent archive.';\n\n\ncreate or replace function ").concat(u,".delete(\n    queue_name text,\n    message_id bigint\n)\n  returns boolean\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return\n    pgmq.delete(\n        queue_name := queue_name,\n        msg_id := message_id\n    );\nend;\n$$;\n\ncomment on function ").concat(u,".delete(queue_name text, message_id bigint) is 'Permanently deletes a message from the specified queue.';\n\ncreate or replace function ").concat(u,".read(\n    queue_name text,\n    sleep_seconds integer,\n    n integer\n)\n  returns setof pgmq.message_record\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return query\n    select *\n    from pgmq.read(\n        queue_name := queue_name,\n        vt := sleep_seconds,\n        qty := n\n    );\nend;\n$$;\n\ncomment on function ").concat(u,'.read(queue_name text, sleep_seconds integer, n integer) is \'Reads up to "n" messages from the specified queue with an optional "sleep_seconds" (visibility timeout).\';\n\n-- Grant execute permissions on wrapper functions to roles\ngrant execute on function ').concat(u,".pop(text) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.pop(text) to postgres, service_role, anon, authenticated;\n\ngrant execute on function ").concat(u,".send(text, jsonb, integer) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.send(text, jsonb, integer) to postgres, service_role, anon, authenticated;\n\ngrant execute on function ").concat(u,".send_batch(text, jsonb[], integer) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.send_batch(text, jsonb[], integer) to postgres, service_role, anon, authenticated;\n\ngrant execute on function ").concat(u,".archive(text, bigint) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.archive(text, bigint) to postgres, service_role, anon, authenticated;\n\ngrant execute on function ").concat(u,".delete(text, bigint) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.delete(text, bigint) to postgres, service_role, anon, authenticated;\n\ngrant execute on function ").concat(u,".read(text, integer, integer) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.read(text, integer, integer) to postgres, service_role, anon, authenticated;\n\n-- For the service role, we want full access\n-- Grant permissions on existing tables\ngrant all privileges on all tables in schema pgmq to postgres, service_role;\n\n-- Ensure service_role has permissions on future tables\nalter default privileges in schema pgmq grant all privileges on tables to postgres, service_role;\n\ngrant usage on schema pgmq to postgres, anon, authenticated, service_role;\n\n\n/*\n  Grant access to sequences to API roles by default. Existing table permissions\n  continue to enforce insert restrictions. This is necessary to accommodate the\n  on-backup hook that rebuild queue table primary keys to avoid a pg_dump segfault.\n  This can be removed once logical backups are completely retired.\n*/\ngrant usage, select, update\non all sequences in schema pgmq\nto anon, authenticated, service_role;\n\nalter default privileges in schema pgmq\ngrant usage, select, update\non sequences\nto anon, authenticated, service_role;\n")),p=i()("\n  drop function if exists \n    ".concat(u,".pop(queue_name text),\n    ").concat(u,".send(queue_name text, message jsonb, sleep_seconds integer),\n    ").concat(u,".send_batch(queue_name text, message jsonb[], sleep_seconds integer),\n    ").concat(u,".archive(queue_name text, message_id bigint),\n    ").concat(u,".delete(queue_name text, message_id bigint),\n    ").concat(u,".read(queue_name text, sleep integer, n integer)\n  ;\n\n  -- Revoke execute permissions on inner pgmq functions to roles (inverse of enabling)\n  do $$\n  begin\n      if exists (select 1 from pg_namespace where nspname = 'pgmq') then\n          -- Revoke privileges on the schema itself\n          revoke all on schema pgmq from anon, authenticated, service_role;\n          \n          -- Revoke default privileges for future objects\n          alter default privileges in schema pgmq revoke all on tables from anon, authenticated, service_role;\n          alter default privileges in schema pgmq revoke all on sequences from anon, authenticated, service_role;\n          alter default privileges in schema pgmq revoke all on functions from anon, authenticated, service_role;\n      end if;\n  end $$;\n\n  drop schema if exists ").concat(u,";\n"));async function g(e){let{projectRef:t,connectionString:n,enable:a}=e,{result:s}=await (0,l.E)({projectRef:t,connectionString:n,sql:a?m:p,queryKey:["toggle-queues-exposure"]});return s}let h=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=(0,a.jE)();return(0,s.n)(e=>g(e),{async onSuccess(t,n,a){let{projectRef:s}=n;await o.invalidateQueries(c.m.exposePostgrestStatus(s)),o.invalidateQueries(d.c.schemas(s)),await (null==e?void 0:e(t,n,a))},async onError(e,n,a){void 0===t?r.oR.error("Failed to toggle queue exposure via PostgREST: ".concat(e.message)):t(e,n,a)},...n})}},92737:(e,t,n)=>{n.d(t,{K:()=>f,T:()=>v});var a=n(80263),s=n(53239),r=n(70979),o=n(80127),i=n(35741),l=n(53434),c=n.n(l),d=n(27344),u=n.n(d),m=n(37361),p=n.n(m);c().extend(u()),c().extend(p());let g=e=>c().unix(Number(e)/1e3/1e3).toISOString(),h=e=>{let t=16===String(e).length;return!Number.isNaN(Number(e))&&t},f=e=>{let{utcTimestamp:t,format:n}=e,a=h(t)?g(t):t;return c().utc(a).local().format(n)},x=e=>{let{utcTimestamp:t,format:n}=e,a=h(t)?g(t):t;return c().utc(a).format(n)},b=e=>{let{utcTimestamp:t}=e,n=h(t)?g(t):t;return c().utc(n).fromNow()},v=e=>{let{utcTimestamp:t,className:n,displayAs:l="local",format:c="DD MMM  HH:mm:ss",labelFormat:d="DD MMM HH:mm:ss"}=e,u=f({utcTimestamp:t,format:c}),m=x({utcTimestamp:t,format:c}),p=b({utcTimestamp:t}),[g,h]=(0,s.useState)("start"),v=(0,s.useRef)(null),y=Intl.DateTimeFormat().resolvedOptions().timeZone;(0,s.useEffect)(()=>{let e=()=>{if(v.current){let e=v.current.getBoundingClientRect(),t=window.innerHeight;h(e.top<t/2?"start":"end")}};return e(),window.addEventListener("scroll",e),window.addEventListener("resize",e),()=>{window.removeEventListener("scroll",e),window.removeEventListener("resize",e)}},[]);let _=e=>{let{label:t,value:n}=e,[i,l]=(0,s.useState)(!1);return(0,a.jsxs)("div",{onPointerDown:e=>{e.stopPropagation()},onMouseDown:e=>{e.stopPropagation()},onClick:e=>{e.stopPropagation(),e.preventDefault(),(0,r.l)(n,()=>{l(!0),setTimeout(()=>{l(!1)},1e3)})},className:(0,o.cn)("relative cursor-pointer flex gap-y-2 gap-x-0.5 hover:bg-surface-100 px-2 py-1 group",{"bg-surface-100":i}),"data-sentry-component":"TooltipRow","data-sentry-source-file":"index.tsx",children:[(0,a.jsxs)("div",{className:"flex items-center gap-x-2 text-left truncate",children:[(0,a.jsx)("p",{children:t}),(0,a.jsx)("div",{className:"border-t w-full border-dashed"})]}),(0,a.jsxs)("div",{className:"relative flex items-center gap-x-2 flex-grow",children:[(0,a.jsx)("div",{className:"border-t w-full border-dashed z-10"}),i&&(0,a.jsx)("span",{className:"flex items-center justify-end w-full absolute inset-0 flex items-right text-brand-600 bg-surface-100",children:"Copied!"}),(0,a.jsx)("span",{className:"flex items-center gap-x-2 justify-end whitespace-nowrap",children:n})]})]})};return(0,a.jsxs)(i.m_,{"data-sentry-element":"Tooltip","data-sentry-component":"TimestampInfo","data-sentry-source-file":"index.tsx",children:[(0,a.jsx)(i.k$,{asChild:!0,ref:v,className:"text-xs ".concat(n," border-b border-transparent hover:border-dashed hover:border-foreground-light"),"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"index.tsx",children:(0,a.jsx)("span",{children:"local"===l?f({utcTimestamp:t,format:d}):x({utcTimestamp:t,format:d})})}),(0,a.jsxs)(i.ZI,{align:g,side:"right",className:"font-mono p-0 py-1 min-w-80","data-sentry-element":"TooltipContent","data-sentry-source-file":"index.tsx",children:[(0,a.jsx)(_,{label:"UTC",value:m,"data-sentry-element":"TooltipRow","data-sentry-source-file":"index.tsx"}),(0,a.jsx)(_,{label:y,value:u,"data-sentry-element":"TooltipRow","data-sentry-source-file":"index.tsx"}),(0,a.jsx)(_,{label:"Relative",value:p,"data-sentry-element":"TooltipRow","data-sentry-source-file":"index.tsx"}),(0,a.jsx)(_,{label:"Timestamp",value:String(t),"data-sentry-element":"TooltipRow","data-sentry-source-file":"index.tsx"})]})]})}},95794:(e,t,n)=>{n.d(t,{RB:()=>i,ov:()=>l});var a=n(56947),s=n(20305),r=n(31619);let o=()=>"\n    select\n      s.oid as \"id\",\n      w.fdwname as \"name\",\n      s.srvname as \"server_name\",\n      s.srvoptions as \"server_options\",\n      c.proname as \"handler\",\n      (\n        select jsonb_agg(\n          jsonb_build_object(\n            'id', c.oid::bigint,\n            'schema', relnamespace::regnamespace::text,\n            'name', c.relname,\n            'columns', (\n              select jsonb_agg(\n                jsonb_build_object(\n                  'name', a.attname,\n                  'type', pg_catalog.format_type(a.atttypid, a.atttypmod)\n                )\n              )\n              from pg_catalog.pg_attribute a\n              where a.attrelid = c.oid and a.attnum > 0 and not a.attisdropped\n            ),\n            'options', t.ftoptions\n          )\n        )\n        from pg_catalog.pg_class c\n        join pg_catalog.pg_foreign_table t on c.oid = t.ftrelid\n        where c.oid = any (select t.ftrelid from pg_catalog.pg_foreign_table t where t.ftserver = s.oid)\n      ) as \"tables\"\n    from pg_catalog.pg_foreign_server s\n    join pg_catalog.pg_foreign_data_wrapper w on s.srvfdw = w.oid\n    join pg_catalog.pg_proc c on w.fdwhandler = c.oid;\n  ";async function i(e,t){let{projectRef:n,connectionString:a}=e,r=o(),{result:i}=await (0,s.E)({projectRef:n,connectionString:a,sql:r,queryKey:["fdws"]},t);return i}let l=function(e){let{projectRef:t,connectionString:n}=e,{enabled:s=!0,...o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.I)(r.Y.list(t),e=>{let{signal:a}=e;return i({projectRef:t,connectionString:n},a)},{enabled:s&&void 0!==t,...o})}}}]);
try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="3d6d363b-916e-445b-a011-a00c3fc1baf3",e._sentryDebugIdIdentifier="sentry-dbid-3d6d363b-916e-445b-a011-a00c3fc1baf3")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6250,6266],{6140:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>eh});var n=s(80263),a=s(26218),r=s(4206),l=s(24699),i=s(21329),o=s(35485),c=s(21749),d=s(796),m=s(53239),h=s(48465),u=s(67057),x=s(45452),p=s(45240),f=s(31530),g=s(53995);let y=({id:e,x:t,y:s,width:n,height:a,style:r,color:l,strokeColor:i,strokeWidth:o,className:c,borderRadius:d,shapeRendering:h,onClick:x,selected:p})=>{let{background:f,backgroundColor:g}=r||{};return m.createElement("rect",{className:(0,u.A)(["react-flow__minimap-node",{selected:p},c]),x:t,y:s,rx:d,ry:d,width:n,height:a,fill:l||f||g,stroke:i,strokeWidth:o,shapeRendering:h,onClick:x?t=>x(t,e):void 0})};y.displayName="MiniMapNode";var j=(0,m.memo)(y);let v=e=>e.nodeOrigin,b=e=>e.getNodes().filter(e=>!e.hidden&&e.width&&e.height),N=e=>e instanceof Function?e:()=>e;var w=(0,m.memo)(function({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:s="",nodeBorderRadius:n=5,nodeStrokeWidth:r=2,nodeComponent:l=j,onClick:i}){let o=(0,a.Pj)(b,x.x),c=(0,a.Pj)(v),d=N(t),h=N(e),u=N(s),p="undefined"==typeof window||window.chrome?"crispEdges":"geometricPrecision";return m.createElement(m.Fragment,null,o.map(e=>{let{x:t,y:s}=(0,a.Cz)(e,c).positionAbsolute;return m.createElement(l,{key:e.id,x:t,y:s,width:e.width,height:e.height,style:e.style,selected:e.selected,className:u(e),color:d(e),borderRadius:n,strokeColor:h(e),strokeWidth:r,shapeRendering:p,onClick:i,id:e.id})}))});let k=e=>{let t=e.getNodes(),s={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:s,boundingRect:t.length>0?(0,a.Mi)((0,a.Jo)(t,e.nodeOrigin),s):s,rfId:e.rfId}};function _({style:e,className:t,nodeStrokeColor:s="transparent",nodeColor:n="#e2e2e2",nodeClassName:r="",nodeBorderRadius:l=5,nodeStrokeWidth:i=2,nodeComponent:o,maskColor:c="rgb(240, 240, 240, 0.6)",maskStrokeColor:d="none",maskStrokeWidth:h=1,position:y="bottom-right",onClick:j,onNodeClick:v,pannable:b=!1,zoomable:N=!1,ariaLabel:_="React Flow mini map",inversePan:S=!1,zoomStep:A=10,offsetScale:E=5}){let C=(0,a.PI)(),M=(0,m.useRef)(null),{boundingRect:L,viewBB:T,rfId:I}=(0,a.Pj)(k,x.x),P=e?.width??200,z=e?.height??150,R=Math.max(L.width/P,L.height/z),$=R*P,D=R*z,F=E*R,G=L.x-($-L.width)/2-F,W=L.y-(D-L.height)/2-F,H=$+2*F,O=D+2*F,V=`react-flow__minimap-desc-${I}`,U=(0,m.useRef)(0);U.current=R,(0,m.useEffect)(()=>{if(M.current){let e=(0,f.A)(M.current),t=(0,p.s_)().on("zoom",b?e=>{let{transform:t,d3Selection:s,d3Zoom:n,translateExtent:a,width:r,height:l}=C.getState();if("mousemove"!==e.sourceEvent.type||!s||!n)return;let i=U.current*Math.max(1,t[2])*(S?-1:1),o={x:t[0]-e.sourceEvent.movementX*i,y:t[1]-e.sourceEvent.movementY*i},c=p.GS.translate(o.x,o.y).scale(t[2]),d=n.constrain()(c,[[0,0],[r,l]],a);n.transform(s,d)}:null).on("zoom.wheel",N?e=>{let{transform:t,d3Selection:s,d3Zoom:n}=C.getState();if("wheel"!==e.sourceEvent.type||!s||!n)return;let a=-e.sourceEvent.deltaY*(1===e.sourceEvent.deltaMode?.05:e.sourceEvent.deltaMode?1:.002)*A,r=t[2]*Math.pow(2,a);n.scaleTo(s,r)}:null);return e.call(t),()=>{e.on("zoom",null)}}},[b,N,S,A]);let q=j?e=>{let t=(0,g.A)(e);j(e,{x:t[0],y:t[1]})}:void 0,X=v?(e,t)=>{v(e,C.getState().nodeInternals.get(t))}:void 0;return m.createElement(a.Zk,{position:y,style:e,className:(0,u.A)(["react-flow__minimap",t]),"data-testid":"rf__minimap"},m.createElement("svg",{width:P,height:z,viewBox:`${G} ${W} ${H} ${O}`,role:"img","aria-labelledby":V,ref:M,onClick:q},_&&m.createElement("title",{id:V},_),m.createElement(w,{onClick:X,nodeColor:n,nodeStrokeColor:s,nodeBorderRadius:l,nodeClassName:r,nodeStrokeWidth:i,nodeComponent:o}),m.createElement("path",{className:"react-flow__minimap-mask",d:`M${G-F},${W-F}h${H+2*F}v${O+2*F}h${-H-2*F}z
        M${T.x},${T.y}h${T.width}v${T.height}h${-T.width}z`,fill:c,fillRule:"evenodd",stroke:d,strokeWidth:h,pointerEvents:"none"})))}_.displayName="MiniMap";var S=(0,m.memo)(_);s(572);var A=s(73969),E=s(46491),C=s(45638),M=s(92589),L=s(84558),T=s(34763),I=s(15224),P=s(4107),z=s(59347),R=s(68997),$=s(16703),D=s(46895),F=s(70979),G=s(64495),W=s(10208),H=s(68921),O=s(81915);let V=(0,O.A)("Fingerprint",[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]]),U=(0,O.A)("Diamond",[["path",{d:"M2.7 10.3a2.41 2.41 0 0 0 0 3.41l7.59 7.59a2.41 2.41 0 0 0 3.41 0l7.59-7.59a2.41 2.41 0 0 0 0-3.41l-7.59-7.59a2.41 2.41 0 0 0-3.41 0Z",key:"1f1r0c"}]]),q=()=>(0,n.jsx)("div",{className:"absolute bottom-0 left-0 border-t flex justify-center px-1 py-2 shadow-md bg-surface-100 w-full z-10","data-sentry-component":"SchemaGraphLegend","data-sentry-source-file":"SchemaGraphLegend.tsx",children:(0,n.jsxs)("ul",{className:"flex flex-wrap  items-center justify-center gap-4",children:[(0,n.jsxs)("li",{className:"flex items-center text-xs font-mono gap-1",children:[(0,n.jsx)(W.A,{size:15,strokeWidth:1.5,className:"flex-shrink-0 text-light","data-sentry-element":"Key","data-sentry-source-file":"SchemaGraphLegend.tsx"}),"Primary key"]}),(0,n.jsxs)("li",{className:"flex items-center text-xs font-mono gap-1",children:[(0,n.jsx)(H.A,{size:15,strokeWidth:1.5,className:"flex-shrink-0 text-light","data-sentry-element":"Hash","data-sentry-source-file":"SchemaGraphLegend.tsx"}),"Identity"]}),(0,n.jsxs)("li",{className:"flex items-center text-xs font-mono gap-1",children:[(0,n.jsx)(V,{size:15,strokeWidth:1.5,className:"flex-shrink-0 text-light","data-sentry-element":"Fingerprint","data-sentry-source-file":"SchemaGraphLegend.tsx"}),"Unique"]}),(0,n.jsxs)("li",{className:"flex items-center text-xs font-mono gap-1",children:[(0,n.jsx)(U,{size:15,strokeWidth:1.5,className:"flex-shrink-0 text-light","data-sentry-element":"DiamondIcon","data-sentry-source-file":"SchemaGraphLegend.tsx"}),"Nullable"]}),(0,n.jsxs)("li",{className:"flex items-center text-xs font-mono gap-1",children:[(0,n.jsx)(U,{size:15,strokeWidth:1.5,fill:"currentColor",className:"flex-shrink-0 text-light","data-sentry-element":"DiamondIcon","data-sentry-source-file":"SchemaGraphLegend.tsx"}),"Non-Nullable"]})]})});var X=s(23131),Y=s.n(X),B=s(86727),Z=s.n(B),Q=s(53428),K=s(63121),J=s(93749),ee=s.n(J),et=s(80127),es=s(22554);let en=e=>{let{data:t,targetPosition:s,sourcePosition:r,placeholder:l}=e,i="!h-px !w-px !min-w-0 !min-h-0 !cursor-grab !border-0 !opacity-0",o="h-[22px]";return(0,n.jsx)(n.Fragment,{children:t.isForeign?(0,n.jsxs)("header",{className:"text-[0.55rem] px-2 py-1 border-[0.5px] rounded-[4px] bg-alternative flex gap-1 items-center",children:[t.name,s&&(0,n.jsx)(a.h7,{type:"target",id:t.name,position:s,className:(0,et.cn)(i)})]}):(0,n.jsxs)("div",{className:"border-[0.5px] overflow-hidden rounded-[4px] shadow-sm",style:{width:160},children:[(0,n.jsxs)("header",{className:(0,et.cn)("text-[0.55rem] pl-2 pr-1 bg-alternative flex items-center justify-between",o),children:[(0,n.jsxs)("div",{className:"flex gap-x-1 items-center",children:[(0,n.jsx)(Q.A,{strokeWidth:1,size:12,className:"text-light"}),t.name]}),t.id&&!l&&(0,n.jsx)(es.$,{asChild:!0,type:"text",className:"px-0 w-[16px] h-[16px] rounded",children:(0,n.jsx)(ee(),{href:"/project/".concat(t.ref,"/editor/").concat(t.id),children:(0,n.jsx)(K.A,{size:10,className:"text-foreground-light"})})})]}),t.columns.map(e=>(0,n.jsxs)("div",{className:(0,et.cn)("text-[8px] leading-5 relative flex flex-row justify-items-start","bg-surface-100","border-t","border-t-[0.5px]","hover:bg-scale-500 transition cursor-default",o),children:[(0,n.jsxs)("div",{className:(0,et.cn)("gap-[0.24rem] flex mx-2 align-middle items-center justify-start",e.isPrimary&&"basis-1/5"),children:[e.isPrimary&&(0,n.jsx)(W.A,{size:8,strokeWidth:1,className:(0,et.cn)("flex-shrink-0","text-light")}),e.isNullable&&(0,n.jsx)(U,{size:8,strokeWidth:1,className:"flex-shrink-0 text-light"}),!e.isNullable&&(0,n.jsx)(U,{size:8,strokeWidth:1,fill:"currentColor",className:"flex-shrink-0 text-light"}),e.isUnique&&(0,n.jsx)(V,{size:8,strokeWidth:1,className:"flex-shrink-0 text-light"}),e.isIdentity&&(0,n.jsx)(H.A,{size:8,strokeWidth:1,className:"flex-shrink-0 text-light"})]}),(0,n.jsxs)("div",{className:"flex w-full justify-between",children:[(0,n.jsx)("span",{className:"text-ellipsis overflow-hidden whitespace-nowrap max-w-[85px]",children:e.name}),(0,n.jsx)("span",{className:"px-2 inline-flex justify-end font-mono text-lighter text-[0.4rem]",children:e.format})]}),s&&(0,n.jsx)(a.h7,{type:"target",id:e.id,position:s,className:(0,et.cn)(i,"!left-0")}),r&&(0,n.jsx)(a.h7,{type:"source",id:e.id,position:r,className:(0,et.cn)(i,"!right-0")})]},e.id))]})})};async function ea(e,t,s){var n;if(!(null==s?void 0:s.length))return{nodes:[],edges:[]};let a=s.map(t=>{let s=(t.columns||[]).map(e=>({id:e.id,isPrimary:t.primary_keys.some(t=>t.name===e.name),name:e.name,format:e.format,isNullable:e.is_nullable,isUnique:e.is_unique,isUpdateable:e.is_updatable,isIdentity:e.is_identity}));return{id:"".concat(t.id),type:"table",data:{ref:e,id:t.id,name:t.name,isForeign:!1,columns:s},position:{x:0,y:0}}}),r=[],l=s[0].schema;for(let t of Z()(s.flatMap(e=>e.relationships),"id")){if(t.source_schema!==l)continue;if(t.target_table_schema!==l){a.push({id:t.constraint_name,type:"table",data:{ref:e,name:"".concat(t.target_table_schema,".").concat(t.target_table_name,".").concat(t.target_column_name),isForeign:!0,columns:[]},position:{x:0,y:0}});let[n,l]=er(s,t.source_table_name,t.source_column_name);n&&r.push({id:String(t.id),source:n,sourceHandle:l,target:t.constraint_name,targetHandle:t.constraint_name});continue}let[n,i]=er(s,t.source_table_name,t.source_column_name),[o,c]=er(s,t.target_table_name,t.target_column_name);n&&o&&r.push({id:String(t.id),source:n,sourceHandle:i,target:o,targetHandle:c})}let i=localStorage.getItem(E.rS.SCHEMA_VISUALIZER_POSITIONS(null!=e?e:"project",null!=(n=null==t?void 0:t.id)?n:0)),o=(0,D.Bl)(i);return o?ei(a,r,o):el(a,r)}function er(e,t,s){for(let n of e)if(t===n.name){for(let e of n.columns||[])if(s===e.name)return[String(n.id),e.id]}return[]}let el=(e,t)=>{let s=new(Y()).graphlib.Graph;return s.setDefaultEdgeLabel(()=>({})),s.setGraph({rankdir:"LR",align:"UR",nodesep:25,ranksep:50}),e.forEach(e=>{s.setNode(e.id,{width:160,height:20*(e.data.columns.length+1)})}),t.forEach(e=>{s.setEdge(e.source,e.target)}),Y().layout(s),e.forEach(e=>{let t=s.node(e.id);return e.targetPosition=a.yX.Left,e.sourcePosition=a.yX.Right,e.position={x:t.x-t.width/2,y:t.y-t.height/2},e}),{nodes:e,edges:t}},ei=(e,t,s)=>{let n=e.filter(e=>!(e.id in s)),r=0,l={x:0,y:-(65+10*n.length)};return e.forEach(e=>{let t=null==s?void 0:s[e.id];e.targetPosition=a.yX.Left,e.sourcePosition=a.yX.Right,t?e.position=t:(e.position={x:l.x+10*r,y:l.y+10*r},r+=1)}),{nodes:e,edges:t}},eo=()=>{var e;let{ref:t}=(0,E.g)(),{resolvedTheme:s}=(0,d.D)(),{data:u}=(0,$.YA)(),{selectedSchema:x,setSelectedSchema:p}=(0,R.k)(),[f,g]=(0,m.useState)(!1);(0,m.useEffect)(()=>{f&&setTimeout(()=>g(!1),2e3)},[f]);let[y,j]=(0,m.useState)(!1),v=(null==s?void 0:s.includes("dark"))?"rgb(17, 19, 24, .8)":"rgb(237, 237, 237, .8)",b=(0,a.VH)(),N=(0,m.useMemo)(()=>({table:en}),[]),{data:w,error:k,isSuccess:_,isLoading:W,isError:H}=(0,I.w$)({projectRef:null==u?void 0:u.ref,connectionString:null==u?void 0:u.connectionString}),{data:O,error:V,isSuccess:U,isLoading:X,isError:Y}=(0,P.LW)({projectRef:null==u?void 0:u.ref,connectionString:null==u?void 0:u.connectionString,schema:x,includeColumns:!0}),B=(null!=w?w:[]).find(e=>e.name===x),[Z,Q]=(0,z.M)(E.rS.SCHEMA_VISUALIZER_POSITIONS(t,null!=(e=null==B?void 0:B.id)?e:0),{}),K=()=>{if(void 0===B)return console.error("Schema is required");let e=b.getNodes();e.length>0&&Q(e.reduce((e,t)=>({...e,[t.id]:t.position}),{}))},J=e=>{let s=document.querySelector(".react-flow__viewport");if(!s)return;j(!0);let n=s.clientWidth,a=s.clientHeight,{x:l,y:i,zoom:o}=b.getViewport();"svg"===e?(0,r.YI)(s,{backgroundColor:"white",width:n,height:a,style:{width:n.toString(),height:a.toString(),transform:"translate(".concat(l,"px, ").concat(i,"px) scale(").concat(o,")")}}).then(e=>{let s=document.createElement("a");s.setAttribute("download","supabase-schema-".concat(t,".svg")),s.setAttribute("href",e),s.click(),A.oR.success("Successfully downloaded as SVG")}).catch(e=>{console.error("Failed to download:",e),A.oR.error("Failed to download current view:",e.message)}).finally(()=>{j(!1)}):"png"===e&&(0,r.$E)(s,{backgroundColor:"white",width:n,height:a,style:{width:n.toString(),height:a.toString(),transform:"translate(".concat(l,"px, ").concat(i,"px) scale(").concat(o,")")}}).then(e=>{let s=document.createElement("a");s.setAttribute("download","supabase-schema-".concat(t,".png")),s.setAttribute("href",e),s.click(),A.oR.success("Successfully downloaded as PNG")}).catch(e=>{console.error("Failed to download:",e),A.oR.error("Failed to download current view:",e.message)}).finally(()=>{j(!1)})};return(0,m.useEffect)(()=>{U&&_&&O.length>0&&ea(t,w.find(e=>e.name===x),O).then(e=>{let{nodes:t,edges:s}=e;b.setNodes(t),b.setEdges(s),setTimeout(()=>b.fitView({}))})},[U,_,O,s]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-muted",children:[W&&(0,n.jsx)("div",{className:"h-[34px] w-[260px] bg-foreground-lighter rounded shimmering-loader"}),H&&(0,n.jsx)(M.A,{error:k,subject:"Failed to retrieve schemas"}),_&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(T.A,{className:"w-[180px]",size:"tiny",showError:!1,selectedSchemaName:x,onSelectSchema:p}),(0,n.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,n.jsx)(L.G,{type:"outline",icon:f?(0,n.jsx)(l.A,{}):(0,n.jsx)(i.A,{}),onClick:()=>{O&&((0,F.l)((0,D.z6)(O)),g(!0))},tooltip:{content:{side:"bottom",text:(0,n.jsxs)("div",{className:"max-w-[180px] space-y-2 text-foreground-light",children:[(0,n.jsx)("p",{className:"text-foreground",children:"Note"}),(0,n.jsx)("p",{children:"This schema is for context or debugging only. Table order and constraints may be invalid. Not meant to be run as-is."})]})}},children:"Copy as SQL"}),(0,n.jsxs)(G.rI,{children:[(0,n.jsx)(G.ty,{asChild:!0,children:(0,n.jsx)(L.G,{"aria-label":"Download Schema",type:"default",loading:y,className:"px-1.5",icon:(0,n.jsx)(o.A,{}),tooltip:{content:{side:"bottom",text:"Download current view"}}})}),(0,n.jsxs)(G.SQ,{className:"w-32",children:[(0,n.jsx)(G._2,{onClick:()=>J("png"),children:"Download as PNG"}),(0,n.jsx)(G._2,{onClick:()=>J("svg"),children:"Download as SVG"})]})]}),(0,n.jsx)(L.G,{type:"default",onClick:()=>{let e=b.getNodes(),t=b.getEdges();el(e,t),b.setNodes(e),b.setEdges(t),setTimeout(()=>b.fitView({})),K()},tooltip:{content:{side:"bottom",text:"Automatically arrange the layout of all nodes"}},children:"Auto layout"})]})]})]}),X&&(0,n.jsxs)("div",{className:"w-full h-full flex items-center justify-center gap-x-2",children:[(0,n.jsx)(c.A,{className:"animate-spin text-foreground-light",size:16}),(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"Loading tables"})]}),Y&&(0,n.jsx)("div",{className:"w-full h-full flex items-center justify-center px-20",children:(0,n.jsx)(M.A,{subject:"Failed to retrieve tables",error:V})}),U&&(0,n.jsx)(n.Fragment,{children:0===O.length?(0,n.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,n.jsx)(C.A,{title:"No tables created yet",ctaButtonLabel:"Create a new table",ctaUrl:"/project/".concat(t,"/editor?create=table"),children:(0,n.jsxs)("p",{className:"text-sm text-foreground-light",children:['There are no tables found in the schema "',x,'"']})})}):(0,n.jsx)("div",{className:"w-full h-full",children:(0,n.jsxs)(a.Gc,{defaultNodes:[],defaultEdges:[],defaultEdgeOptions:{type:"smoothstep",animated:!0,deletable:!1,style:{stroke:"hsl(var(--border-stronger))",strokeWidth:1}},nodeTypes:N,fitView:!0,minZoom:.8,maxZoom:1.8,proOptions:{hideAttribution:!0},onNodeDragStop:()=>K(),children:[(0,n.jsx)(h.V,{gap:16,className:"[&>*]:stroke-foreground-muted opacity-[25%]",variant:h._.Dots,color:"inherit"}),(0,n.jsx)(S,{pannable:!0,zoomable:!0,nodeColor:"#111318",maskColor:v,className:"border rounded-md shadow-sm"}),(0,n.jsx)(q,{})]})})})]})};var ec=s(62473),ed=s(78311);let em=()=>(0,n.jsx)("div",{className:"flex w-full h-full flex-col","data-sentry-component":"SchemasPage","data-sentry-source-file":"schemas.tsx",children:(0,n.jsx)(a.Ln,{"data-sentry-element":"ReactFlowProvider","data-sentry-source-file":"schemas.tsx",children:(0,n.jsx)(eo,{"data-sentry-element":"SchemaGraph","data-sentry-source-file":"schemas.tsx"})})});em.getLayout=e=>(0,n.jsx)(ed.A,{children:(0,n.jsx)(ec.A,{title:"Database",children:e})});let eh=em},10208:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});let n=(0,s(81915).A)("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]])},15419:(e,t,s)=>{"use strict";s.d(t,{A:()=>c});var n=s(80263),a=s(93749),r=s.n(a),l=s(98615),i=s(34531),o=s(22554);let c=e=>{let{name:t="",isActive:s,isExternal:a,icon:c,rightIcon:d,url:m="",target:h="_self",onClick:u,textClassName:x="",hoverText:p="",label:f}=e,g=(0,n.jsx)(l.Ay.Item,{icon:c,rounded:!0,active:s,onClick:u,children:(0,n.jsxs)("div",{className:"flex w-full items-center justify-between gap-1",children:[(0,n.jsxs)("div",{title:p||("string"==typeof t?t:""),className:"flex items-center gap-2 truncate w-full "+x,children:[(0,n.jsxs)("span",{className:"truncate",children:[t," "]}),void 0!==f&&(0,n.jsx)(i.E,{variant:"warning",className:"py-0 px-1.5 capitalize",children:f})]}),d&&(0,n.jsx)("div",{children:d})]})});return m?a?(0,n.jsx)(o.$,{asChild:!0,block:!0,className:"!justify-start",type:"text",size:"small",icon:c,children:(0,n.jsx)(r(),{href:m,target:"_blank",rel:"noreferrer",children:t})}):(0,n.jsx)(r(),{href:m,className:"block",target:h,children:g}):g}},34763:(e,t,s)=>{"use strict";s.d(t,{A:()=>y});var n=s(80263),a=s(60045),r=s(42872),l=s(24699),i=s(7005),o=s(53239),c=s(15224),d=s(75831),m=s(16703),h=s(22554),u=s(49583),x=s(38112),p=s(51509),f=s(30569),g=s(50033);let y=e=>{let{className:t,disabled:s=!1,size:y="tiny",showError:j=!0,selectedSchemaName:v,supportSelectAll:b=!1,excludedSchemas:N=[],onSelectSchema:w,onSelectCreateSchema:k,portal:_=!0}=e,[S,A]=(0,o.useState)(!1),{can:E}=(0,d.hl)(a.aG.TENANT_SQL_ADMIN_WRITE,"schemas"),{data:C}=(0,m.YA)(),{data:M,isLoading:L,isSuccess:T,isError:I,error:P,refetch:z}=(0,c.w$)({projectRef:null==C?void 0:C.ref,connectionString:null==C?void 0:C.connectionString}),R=(M||[]).filter(e=>!N.includes(e.name)).sort((e,t)=>e.name.localeCompare(t.name));return(0,n.jsxs)("div",{className:t,"data-sentry-component":"SchemaSelector","data-sentry-source-file":"SchemaSelector.tsx",children:[L&&(0,n.jsx)(h.$,{type:"default",className:"w-full [&>span]:w-full",size:y,disabled:!0,children:(0,n.jsx)(u.E,{className:"w-full h-3 bg-foreground-muted"})},"schema-selector-skeleton"),j&&I&&(0,n.jsxs)(x.Fc,{variant:"warning",className:"!px-3 !py-3",children:[(0,n.jsx)(x.XL,{className:"text-xs text-amber-900",children:"Failed to load schemas"}),(0,n.jsxs)(x.TN,{className:"text-xs mb-2 break-words",children:["Error: ",null==P?void 0:P.message]}),(0,n.jsx)(h.$,{type:"default",size:"tiny",onClick:()=>z(),children:"Reload schemas"})]}),T&&(0,n.jsxs)(p.AM,{open:S,onOpenChange:A,modal:!1,children:[(0,n.jsx)(p.Wv,{asChild:!0,children:(0,n.jsx)(h.$,{size:y,disabled:s,type:"default","data-testid":"schema-selector",className:"w-full [&>span]:w-full !pr-1 space-x-1",iconRight:(0,n.jsx)(r.A,{className:"text-foreground-muted",strokeWidth:2,size:14}),children:v?(0,n.jsxs)("div",{className:"w-full flex gap-1",children:[(0,n.jsx)("p",{className:"text-foreground-lighter",children:"schema"}),(0,n.jsx)("p",{className:"text-foreground",children:"*"===v?"All schemas":v})]}):(0,n.jsx)("div",{className:"w-full flex gap-1",children:(0,n.jsx)("p",{className:"text-foreground-lighter",children:"Choose a schemaâ€¦"})})})}),(0,n.jsx)(p.hl,{className:"p-0 min-w-[200px] pointer-events-auto",side:"bottom",align:"start",portal:_,sameWidthAsTrigger:!0,children:(0,n.jsxs)(f.uB,{children:[(0,n.jsx)(f.G7,{placeholder:"Find schema..."}),(0,n.jsxs)(f.oI,{children:[(0,n.jsx)(f.xL,{children:"No schemas found"}),(0,n.jsx)(f.L$,{children:(0,n.jsxs)(g.FK,{className:(R||[]).length>7?"h-[210px]":"",children:[b&&(0,n.jsxs)(f.h_,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{w("*"),A(!1)},onClick:()=>{w("*"),A(!1)},children:[(0,n.jsx)("span",{children:"All schemas"}),"*"===v&&(0,n.jsx)(l.A,{className:"text-brand",strokeWidth:2,size:16})]},"select-all"),null==R?void 0:R.map(e=>(0,n.jsxs)(f.h_,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{w(e.name),A(!1)},onClick:()=>{w(e.name),A(!1)},children:[(0,n.jsx)("span",{children:e.name}),v===e.name&&(0,n.jsx)(l.A,{className:"text-brand",strokeWidth:2,size:16})]},e.id))]})}),void 0!==k&&E&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f.fx,{}),(0,n.jsx)(f.L$,{children:(0,n.jsxs)(f.h_,{className:"cursor-pointer flex items-center gap-x-2 w-full",onSelect:()=>{k(),A(!1)},onClick:()=>{k(),A(!1)},children:[(0,n.jsx)(i.A,{size:12}),"Create a new schema"]})})]})]})]})})]})]})}},41807:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var n=s(80263);s(53239);let a=function(e){let{children:t,target:s="_blank",href:a,className:r,onClick:l,style:i}=e;return(0,n.jsx)("a",{onClick:l,href:a,target:s,rel:"noopener noreferrer",style:i,"data-sentry-component":"Link","data-sentry-source-file":"Link.tsx",children:t})}},43631:(e,t,s)=>{"use strict";s.d(t,{z:()=>d});var n=s(23879),a=s(56947),r=s(70938),l=s(16703),i=s(74144),o=s(55784);async function c(e,t,s){let{projectRef:a,connectionString:l}=e;if(!a)throw Error("projectRef is required");let i=new Headers(s);l&&i.set("x-connection-encrypted",l);let{data:o,error:c}=await (0,r.Jt)("/platform/pg-meta/{ref}/extensions",{params:{header:{"x-connection-encrypted":l,"x-pg-application-name":n.r},path:{ref:a}},headers:i,signal:t});return c&&(0,r.H4)(c),o}let d=function(e){let{projectRef:t,connectionString:s}=e,{enabled:n=!0,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:d}=(0,l.YA)(),m=(null==d?void 0:d.status)===i.BU.ACTIVE_HEALTHY;return(0,a.I)(o.I.list(t),e=>{let{signal:n}=e;return c({projectRef:t,connectionString:s},n)},{enabled:n&&void 0!==t&&m,...r})}},45638:(e,t,s)=>{"use strict";s.d(t,{A:()=>c});var n=s(80263),a=s(63121),r=s(84558),l=s(93749),i=s.n(l),o=s(22554);let c=e=>{let{title:t="",size:s="medium",children:l,ctaButtonLabel:c="",infoButtonLabel:d="",infoButtonUrl:m="",onClickCta:h=()=>{},loading:u=!1,disabled:x=!1,disabledMessage:p="",ctaUrl:f}=e,g=c&&h||m&&d;return(0,n.jsx)("div",{className:"flex h-full w-full items-center justify-center","data-sentry-component":"ProductEmptyState","data-sentry-source-file":"ProductEmptyState.tsx",children:(0,n.jsx)("div",{className:"flex space-x-4 rounded border bg-surface-100 p-6 shadow-md",children:(0,n.jsx)("div",{className:"flex flex-col",children:(0,n.jsxs)("div",{className:"".concat("medium"===s?"w-80":"w-[400px]"," space-y-4"),children:[(0,n.jsx)("h5",{className:"text-foreground",children:t}),(0,n.jsx)("div",{className:"flex flex-col space-y-2 text-foreground-light",children:l}),g&&(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[c&&f?(0,n.jsx)(o.$,{asChild:!0,type:"primary",children:(0,n.jsx)(i(),{href:f,children:c})}):c&&h?(0,n.jsx)(r.G,{type:"primary",onClick:h,loading:u,disabled:u||x,tooltip:{content:{side:"bottom",text:x&&p.length>0?p:void 0}},children:c}):null,m&&d?(0,n.jsx)(o.$,{type:"default",icon:(0,n.jsx)(a.A,{strokeWidth:1.5}),children:(0,n.jsx)("a",{target:"_blank",rel:"noreferrer",href:m,children:d})}):null]})]})})})})}},53428:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});let n=(0,s(81915).A)("Table2",[["path",{d:"M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18",key:"gugj83"}]])},60905:(e,t,s)=>{"use strict";s.d(t,{l:()=>i});var n=s(80263),a=s(98615),r=s(34531),l=s(15419);let i=e=>{let{page:t,menu:s}=e;return(0,n.jsx)("div",{className:"flex flex-col space-y-8","data-sentry-component":"ProductMenu","data-sentry-source-file":"ProductMenu.tsx",children:(0,n.jsx)(a.Ay,{type:"pills","data-sentry-element":"Menu","data-sentry-source-file":"ProductMenu.tsx",children:s.map((e,i)=>(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"my-6 space-y-8",children:(0,n.jsxs)("div",{className:"mx-3",children:[(0,n.jsx)(a.Ay.Group,{title:e.title?(0,n.jsxs)("div",{className:"flex flex-col space-y-2 uppercase font-mono",children:[(0,n.jsx)("span",{children:e.title}),e.isPreview&&(0,n.jsx)(r.E,{variant:"warning",children:"Not production ready"})]}):null}),(0,n.jsx)("div",{children:e.items.map(e=>{let s=e.pages?e.pages.includes(null!=t?t:""):t===e.key;return(0,n.jsx)(l.A,{url:e.url,name:e.name,icon:e.icon,rightIcon:e.rightIcon,isActive:s,isExternal:e.isExternal,target:e.isExternal?"_blank":"_self",label:e.label},e.key)})})]})}),i!==s.length-1&&(0,n.jsx)("div",{className:"h-px w-full bg-border-overlay"})]},e.key||e.title))})})}},62473:(e,t,s)=>{"use strict";s.d(t,{A:()=>f});var n=s(80263),a=s(67908),r=s(4487),l=s(60905),i=s(43631),o=s(32930),c=s(64084),d=s(16703),m=s(53405),h=s(18947),u=s(33444),x=s(15283);let p=()=>{let{data:e}=(0,d.YA)(),t=(0,a.useRouter)().pathname.split("/")[4],{data:s}=(0,i.z)({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString}),{data:m}=(0,o.Q)({projectRef:null==e?void 0:e.ref}),u=void 0!==(null!=s?s:[]).find(e=>"pg_net"===e.name),p=(null==m?void 0:m.selected_addons.find(e=>"pitr"===e.type))!==void 0,f=(0,r.p4)(),g=(0,h._P)("enablePgReplicate"),{databaseReplication:y,databaseRoles:j}=(0,c.x)(["database:replication","database:roles"]);return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(l.l,{page:t,menu:(0,x.k)(e,{pgNetExtensionExists:u,pitrEnabled:p,columnLevelPrivileges:f,enablePgReplicate:g,showPgReplicate:y,showRoles:j}),"data-sentry-element":"ProductMenu","data-sentry-source-file":"DatabaseLayout.tsx"})})},f=(0,m.r)(e=>{let{children:t}=e;return(0,n.jsx)(u.A,{product:"Database",productMenu:(0,n.jsx)(p,{}),isBlocking:!1,"data-sentry-element":"ProjectLayout","data-sentry-component":"DatabaseLayout","data-sentry-source-file":"DatabaseLayout.tsx",children:t})})},68921:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});let n=(0,s(81915).A)("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]])},68997:(e,t,s)=>{"use strict";s.d(t,{k:()=>i});var n=s(49629),a=s(53239),r=s(46491);let l=e=>(0,n.ZA)("schema",n.tU.withDefault(e).withOptions({clearOnDefault:!1})),i=()=>{let{ref:e}=(0,r.g)(),t=e&&e.length>0&&window.localStorage.getItem(r.rS.LAST_SELECTED_SCHEMA(e))||"public",[s,n]=l((0,a.useMemo)(()=>t,[e]));return(0,a.useEffect)(()=>{e&&e.length>0&&window.localStorage.setItem(r.rS.LAST_SELECTED_SCHEMA(e),s)},[s,e]),{selectedSchema:s,setSelectedSchema:n}}},71523:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/database/schemas",function(){return s(6140)}])},98615:(e,t,s)=>{"use strict";s.d(t,{Ay:()=>u});var n=s(80263),a=s(53239),r=s(92413),l=s(80127),i=s(41807);function o(e){let{children:t,className:s,tag:a="div",style:r}=e;return(0,n.jsx)("".concat(a),{style:r,"data-sentry-element":"CustomTag","data-sentry-component":"Typography","data-sentry-source-file":"Typography.tsx",children:t})}o.Title=function(e){let{className:t,level:s=1,children:a,style:r}=e;return(0,n.jsx)("h".concat(s),{style:r,"data-sentry-element":"CustomTag","data-sentry-component":"Title","data-sentry-source-file":"Title.tsx",children:a})},o.Text=function(e){let{className:t,children:s,style:a,type:r,disabled:l,mark:i,code:o,keyboard:c,underline:d,strikethrough:m,strong:h,small:u}=e;return o?(0,n.jsx)("code",{style:a,children:s}):i?(0,n.jsx)("mark",{style:a,children:s}):c?(0,n.jsx)("kbd",{style:a,children:s}):h?(0,n.jsx)("strong",{style:a,children:s}):(0,n.jsx)("span",{style:a,"data-sentry-component":"Text","data-sentry-source-file":"Text.tsx",children:s})},o.Link=i.A;let c=(0,a.createContext)({type:"text"}),d=e=>{let{type:t}=e;return(0,n.jsx)(c.Provider,{value:{type:t},"data-sentry-element":"MenuContext.Provider","data-sentry-component":"MenuContextProvider","data-sentry-source-file":"MenuContext.tsx",children:e.children})},m=()=>{let e=(0,a.useContext)(c);if(void 0===e)throw Error("MenuContext must be used within a MenuContextProvider.");return e};function h(e){let{children:t,className:s,ulClassName:a,style:r,type:l="text"}=e;return(0,n.jsx)("nav",{role:"menu","aria-label":"Sidebar","aria-orientation":"vertical","aria-labelledby":"options-menu",className:s,style:r,"data-sentry-component":"Menu","data-sentry-source-file":"Menu.tsx",children:(0,n.jsx)(d,{type:l,"data-sentry-element":"MenuContextProvider","data-sentry-source-file":"Menu.tsx",children:(0,n.jsx)("ul",{className:a,children:t})})})}h.Item=function(e){let{children:t,icon:s,active:a,rounded:i,onClick:o,doNotCloseOverlay:c=!1,showActiveBar:d=!1,style:h}=e,u=(0,r.A)("menu"),{type:x}=m(),p=[u.item.base];p.push(u.item.variants[x].base),a?p.push(u.item.variants[x].active):p.push(u.item.variants[x].normal);let f=[u.item.content.base];a?f.push(u.item.content.active):f.push(u.item.content.normal);let g=[u.item.icon.base];return a?g.push(u.item.icon.active):g.push(u.item.icon.normal),(0,n.jsxs)("li",{role:"menuitem",className:(0,l.cn)("outline-none",p),style:h,onClick:o,"aria-current":a?"page":void 0,"data-sentry-component":"Item","data-sentry-source-file":"Menu.tsx",children:[s&&(0,n.jsx)("div",{className:"".concat(g.join(" ")," min-w-fit"),children:s}),(0,n.jsx)("span",{className:f.join(" "),children:t})]})},h.Group=function(e){let{children:t,icon:s,title:a}=e,l=(0,r.A)("menu"),{type:i}=m();return(0,n.jsxs)("div",{className:[l.group.base,l.group.variants[i]].join(" "),"data-sentry-component":"Group","data-sentry-source-file":"Menu.tsx",children:[s&&(0,n.jsx)("span",{className:l.group.icon,children:s}),(0,n.jsx)("span",{className:l.group.content,children:a}),t]})},h.Misc=function(e){let{children:t}=e;return(0,n.jsx)("div",{"data-sentry-component":"Misc","data-sentry-source-file":"Menu.tsx",children:(0,n.jsx)(o.Text,{"data-sentry-element":"Typography.Text","data-sentry-source-file":"Menu.tsx",children:(0,n.jsx)("span",{children:t})})})};let u=h}},e=>{var t=t=>e(e.s=t);e.O(0,[89,2313,5233,673,7494,726,5476,4915,7074,4560,2735,8444,6110,3895,1168,7795,9587,5348,5175,4654,3258,3923,3013,9147,3144,1830,2840,3131,4352,304,6416,8311,1041,5983,3444,636,6593,8792],()=>t(71523)),_N_E=e.O()}]);